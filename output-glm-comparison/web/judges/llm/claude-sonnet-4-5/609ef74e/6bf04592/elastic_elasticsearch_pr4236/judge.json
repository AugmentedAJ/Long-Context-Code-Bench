{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 4236,
  "base_commit": "e66c2793aac69cf8d07199133cc3f76f4a801df9",
  "head_commit": "4774439436d44bb6d6cceb5878eb7acfbe89c49c",
  "judge_mode": "llm",
  "judge_model": "claude-sonnet-4-5",
  "scores": {
    "correctness": -0.3,
    "completeness": -0.4,
    "code_reuse": -0.2,
    "best_practices": -0.5,
    "unsolicited_docs": 0.0
  },
  "aggregate": -0.27999999999999997,
  "rationale": "The agent made several critical errors: (1) Modified the wrong method - changed `fromXContentStandalone` to use `currentToken()` instead of the ground truth fix which changes the call site in MetaDataCreateIndexService.java to use `fromXContent()` instead of `fromXContentStandalone()`. (2) Made unsolicited changes to pom.xml upgrading Java version from 1.6 to 1.8, which is completely unrelated to the task. (3) Added a test to SimpleIndexTemplateTests.java but the test is incorrect - it still calls `fromXContentStandalone` when the fix requires using `fromXContent`. (4) Completely missed creating the new IndexTemplateFileLoadingTests.java integration test file that exercises the actual bug scenario. (5) Missed the new template.json test resource file. The agent's approach of modifying the parsing logic itself is architecturally wrong - the ground truth shows the bug is in which parser method is being called, not in the parser implementation. The Java version upgrade in pom.xml is a major anti-pattern showing lack of focus on the actual issue.",
  "edit_run_id": "6bf04592",
  "judge_run_id": "609ef74e",
  "ground_truth_patch": "diff --git a/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java\nindex a7f1d841bc35..a394166439d3 100644\n--- a/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java\n+++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java\n@@ -482,7 +482,7 @@ public class MetaDataCreateIndexService extends AbstractComponent {\n                     try {\n                         byte[] templatesData = Streams.copyToByteArray(templatesFile);\n                         parser = XContentHelper.createParser(templatesData, 0, templatesData.length);\n-                        IndexTemplateMetaData template = IndexTemplateMetaData.Builder.fromXContentStandalone(parser);\n+                        IndexTemplateMetaData template = IndexTemplateMetaData.Builder.fromXContent(parser);\n                         if (Regex.simpleMatch(template.template(), request.index)) {\n                             templates.add(template);\n                         }\ndiff --git a/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java\nnew file mode 100644\nindex 000000000000..606d78d16666\n--- /dev/null\n+++ b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java\n@@ -0,0 +1,78 @@\n+/*\n+ * Licensed to ElasticSearch and Shay Banon under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. ElasticSearch licenses this\n+ * file to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.elasticsearch.indices.template;\n+\n+import com.google.common.base.Charsets;\n+import com.google.common.io.Files;\n+import org.elasticsearch.action.admin.cluster.state.ClusterStateResponse;\n+import org.elasticsearch.common.io.Streams;\n+import org.elasticsearch.common.settings.ImmutableSettings;\n+import org.elasticsearch.common.settings.Settings;\n+import org.elasticsearch.test.ElasticsearchIntegrationTest;\n+import org.elasticsearch.test.ElasticsearchIntegrationTest.ClusterScope;\n+import org.elasticsearch.test.ElasticsearchIntegrationTest.Scope;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+\n+import java.io.File;\n+\n+import static org.hamcrest.Matchers.is;\n+\n+/**\n+ *\n+ */\n+@ClusterScope(scope= Scope.SUITE, numNodes=1)\n+public class IndexTemplateFileLoadingTests extends ElasticsearchIntegrationTest {\n+\n+    @Rule\n+    public TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+    @Override\n+    protected Settings nodeSettings(int nodeOrdinal) {\n+        ImmutableSettings.Builder settingsBuilder = ImmutableSettings.settingsBuilder();\n+        settingsBuilder.put(super.nodeSettings(nodeOrdinal));\n+\n+        try {\n+            File directory = temporaryFolder.newFolder();\n+            settingsBuilder.put(\"path.conf\", directory.getPath());\n+\n+            File templatesDir = new File(directory + File.separator + \"templates\");\n+            templatesDir.mkdir();\n+\n+            File dst = new File(templatesDir, \"template.json\");\n+            String template = Streams.copyToStringFromClasspath(\"/org/elasticsearch/indices/template/template.json\");\n+            Files.write(template, dst, Charsets.UTF_8);\n+        } catch (Exception e) {\n+            throw new RuntimeException(e);\n+        }\n+\n+        return settingsBuilder.build();\n+    }\n+\n+    @Test\n+    public void testThatLoadingTemplateFromFileWorks() throws Exception {\n+        createIndex(\"foobar\");\n+        ensureYellow(); // ensuring yellow so the test fails faster if the template cannot be loaded\n+\n+        ClusterStateResponse stateResponse = client().admin().cluster().prepareState().setFilterIndices(\"foobar\").get();\n+        assertThat(stateResponse.getState().getMetaData().indices().get(\"foobar\").getNumberOfShards(), is(10));\n+        assertThat(stateResponse.getState().getMetaData().indices().get(\"foobar\").getNumberOfReplicas(), is(0));\n+    }\n+}\ndiff --git a/src/test/java/org/elasticsearch/indices/template/template.json b/src/test/java/org/elasticsearch/indices/template/template.json\nnew file mode 100644\nindex 000000000000..3b2ace1389b7\n--- /dev/null\n+++ b/src/test/java/org/elasticsearch/indices/template/template.json\n@@ -0,0 +1,7 @@\n+{\n+    \"template\" : \"foo*\",\n+    \"settings\" : {\n+        \"index.number_of_shards\": 10,\n+        \"index.number_of_replicas\": 0\n+   }\n+}\n\\ No newline at end of file"
}