{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 3974,
  "base_commit": "0e9c049da1231968a56a9abbd5178f07bc49b320",
  "head_commit": "e79f714b4b066f9238ff6313aad9a854c37a8c3d",
  "judge_mode": "llm",
  "judge_model": "claude-sonnet-4-5",
  "scores": {
    "correctness": -0.9,
    "completeness": -0.8,
    "code_reuse": -0.7,
    "best_practices": -0.6,
    "unsolicited_docs": 0.0
  },
  "aggregate": -0.6000000000000001,
  "rationale": "The agent's approach differs fundamentally from the ground truth in a way that likely breaks functionality. The ground truth creates two new classes: AbstractRestResponseActionListener (abstract base) and AcknowledgedRestResponseActionListener (concrete implementation extending the base), then instantiates the concrete class directly in both warmer actions. The agent instead references 'RestAcknowledgedResponse.listener()' as a static factory method, but this class/method does not exist in the codebase (no such file was created). This means the agent's code would fail to compile. The agent removed the correct imports but added imports to a non-existent class. While the agent correctly identified and removed the duplicate response handling code from both RestDeleteWarmerAction and RestPutWarmerAction, it replaced it with a reference to code that doesn't exist. The ground truth's solution is more robust with proper inheritance hierarchy and reusable components, while the agent's solution assumes infrastructure that wasn't created.",
  "edit_run_id": "6bf04592",
  "judge_run_id": "609ef74e",
  "ground_truth_patch": "diff --git a/src/main/java/org/elasticsearch/rest/AbstractRestResponseActionListener.java b/src/main/java/org/elasticsearch/rest/AbstractRestResponseActionListener.java\nnew file mode 100644\nindex 000000000000..5d065c5e1916\n--- /dev/null\n+++ b/src/main/java/org/elasticsearch/rest/AbstractRestResponseActionListener.java\n@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to ElasticSearch and Shay Banon under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. ElasticSearch licenses this\n+ * file to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.elasticsearch.rest;\n+\n+import org.elasticsearch.action.ActionListener;\n+import org.elasticsearch.action.ActionResponse;\n+import org.elasticsearch.common.logging.ESLogger;\n+\n+import java.io.IOException;\n+\n+/**\n+ */\n+public abstract class AbstractRestResponseActionListener<T extends ActionResponse> implements ActionListener<T> {\n+\n+    protected final RestChannel channel;\n+    protected final RestRequest request;\n+    protected final ESLogger logger;\n+\n+    public AbstractRestResponseActionListener(final RestRequest request, final RestChannel channel, final ESLogger logger) {\n+        this.request = request;\n+        this.channel = channel;\n+        this.logger = logger;\n+    }\n+\n+    @Override\n+    public abstract void onResponse(T t);\n+\n+    @Override\n+    public void onFailure(Throwable e) {\n+        try {\n+            channel.sendResponse(new XContentThrowableRestResponse(request, e));\n+        } catch (IOException e1) {\n+            logger.error(\"Failed to send failure response\", e1);\n+        }\n+    }\n+}\ndiff --git a/src/main/java/org/elasticsearch/rest/AcknowledgedRestResponseActionListener.java b/src/main/java/org/elasticsearch/rest/AcknowledgedRestResponseActionListener.java\nnew file mode 100644\nindex 000000000000..67e95257db5d\n--- /dev/null\n+++ b/src/main/java/org/elasticsearch/rest/AcknowledgedRestResponseActionListener.java\n@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to ElasticSearch and Shay Banon under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. ElasticSearch licenses this\n+ * file to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.elasticsearch.rest;\n+\n+import org.elasticsearch.action.support.master.AcknowledgedResponse;\n+import org.elasticsearch.common.logging.ESLogger;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.rest.action.support.RestXContentBuilder;\n+\n+import java.io.IOException;\n+\n+import static org.elasticsearch.rest.RestStatus.OK;\n+\n+/**\n+ */\n+public final class AcknowledgedRestResponseActionListener<T extends AcknowledgedResponse> extends AbstractRestResponseActionListener<T> {\n+\n+    public AcknowledgedRestResponseActionListener(RestRequest request, RestChannel channel, ESLogger logger) {\n+        super(request, channel, logger);\n+    }\n+\n+    @Override\n+    public void onResponse(T response) {\n+        try {\n+            XContentBuilder builder = RestXContentBuilder.restContentBuilder(request);\n+            builder.startObject()\n+                    .field(\"ok\", true)\n+                    .field(\"acknowledged\", response.isAcknowledged());\n+            builder.endObject();\n+            channel.sendResponse(new XContentRestResponse(request, OK, builder));\n+        } catch (IOException e) {\n+            onFailure(e);\n+        }\n+    }\n+}\ndiff --git a/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/delete/RestDeleteWarmerAction.java b/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/delete/RestDeleteWarmerAction.java\nindex 8682d950cee9..6b2fffd85419 100644\n--- a/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/delete/RestDeleteWarmerAction.java\n+++ b/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/delete/RestDeleteWarmerAction.java\n@@ -19,21 +19,14 @@\n \n package org.elasticsearch.rest.action.admin.indices.warmer.delete;\n \n-import org.elasticsearch.action.ActionListener;\n import org.elasticsearch.action.admin.indices.warmer.delete.DeleteWarmerRequest;\n-import org.elasticsearch.action.admin.indices.warmer.delete.DeleteWarmerResponse;\n import org.elasticsearch.client.Client;\n import org.elasticsearch.common.Strings;\n import org.elasticsearch.common.inject.Inject;\n import org.elasticsearch.common.settings.Settings;\n-import org.elasticsearch.common.xcontent.XContentBuilder;\n import org.elasticsearch.rest.*;\n-import org.elasticsearch.rest.action.support.RestXContentBuilder;\n-\n-import java.io.IOException;\n \n import static org.elasticsearch.rest.RestRequest.Method.DELETE;\n-import static org.elasticsearch.rest.RestStatus.OK;\n \n /**\n  */\n@@ -54,29 +47,6 @@ public class RestDeleteWarmerAction extends BaseRestHandler {\n         deleteWarmerRequest.listenerThreaded(false);\n         deleteWarmerRequest.timeout(request.paramAsTime(\"timeout\", deleteWarmerRequest.timeout()));\n         deleteWarmerRequest.masterNodeTimeout(request.paramAsTime(\"master_timeout\", deleteWarmerRequest.masterNodeTimeout()));\n-        client.admin().indices().deleteWarmer(deleteWarmerRequest, new ActionListener<DeleteWarmerResponse>() {\n-            @Override\n-            public void onResponse(DeleteWarmerResponse response) {\n-                try {\n-                    XContentBuilder builder = RestXContentBuilder.restContentBuilder(request);\n-                    builder.startObject()\n-                            .field(\"ok\", true)\n-                            .field(\"acknowledged\", response.isAcknowledged());\n-                    builder.endObject();\n-                    channel.sendResponse(new XContentRestResponse(request, OK, builder));\n-                } catch (IOException e) {\n-                    onFailure(e);\n-                }\n-            }\n-\n-            @Override\n-            public void onFailure(Throwable e) {\n-                try {\n-                    channel.sendResponse(new XContentThrowableRestResponse(request, e));\n-                } catch (IOException e1) {\n-                    logger.error(\"Failed to send failure response\", e1);\n-                }\n-            }\n-        });\n+        client.admin().indices().deleteWarmer(deleteWarmerRequest, new AcknowledgedRestResponseActionListener(request, channel, logger));\n     }\n }\ndiff --git a/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/put/RestPutWarmerAction.java b/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/put/RestPutWarmerAction.java\nindex 47ee0f08c842..ee5b37944797 100644\n--- a/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/put/RestPutWarmerAction.java\n+++ b/src/main/java/org/elasticsearch/rest/action/admin/indices/warmer/put/RestPutWarmerAction.java\n@@ -19,22 +19,15 @@\n \n package org.elasticsearch.rest.action.admin.indices.warmer.put;\n \n-import org.elasticsearch.action.ActionListener;\n import org.elasticsearch.action.admin.indices.warmer.put.PutWarmerRequest;\n-import org.elasticsearch.action.admin.indices.warmer.put.PutWarmerResponse;\n import org.elasticsearch.action.search.SearchRequest;\n import org.elasticsearch.client.Client;\n import org.elasticsearch.common.Strings;\n import org.elasticsearch.common.inject.Inject;\n import org.elasticsearch.common.settings.Settings;\n-import org.elasticsearch.common.xcontent.XContentBuilder;\n import org.elasticsearch.rest.*;\n-import org.elasticsearch.rest.action.support.RestXContentBuilder;\n-\n-import java.io.IOException;\n \n import static org.elasticsearch.rest.RestRequest.Method.PUT;\n-import static org.elasticsearch.rest.RestStatus.OK;\n \n /**\n  */\n@@ -57,29 +50,6 @@ public class RestPutWarmerAction extends BaseRestHandler {\n         putWarmerRequest.searchRequest(searchRequest);\n         putWarmerRequest.timeout(request.paramAsTime(\"timeout\", putWarmerRequest.timeout()));\n         putWarmerRequest.masterNodeTimeout(request.paramAsTime(\"master_timeout\", putWarmerRequest.masterNodeTimeout()));\n-        client.admin().indices().putWarmer(putWarmerRequest, new ActionListener<PutWarmerResponse>() {\n-            @Override\n-            public void onResponse(PutWarmerResponse response) {\n-                try {\n-                    XContentBuilder builder = RestXContentBuilder.restContentBuilder(request);\n-                    builder.startObject()\n-                            .field(\"ok\", true)\n-                            .field(\"acknowledged\", response.isAcknowledged());\n-                    builder.endObject();\n-                    channel.sendResponse(new XContentRestResponse(request, OK, builder));\n-                } catch (IOException e) {\n-                    onFailure(e);\n-                }\n-            }\n-\n-            @Override\n-            public void onFailure(Throwable e) {\n-                try {\n-                    channel.sendResponse(new XContentThrowableRestResponse(request, e));\n-                } catch (IOException e1) {\n-                    logger.error(\"Failed to send failure response\", e1);\n-                }\n-            }\n-        });\n+        client.admin().indices().putWarmer(putWarmerRequest,  new AcknowledgedRestResponseActionListener(request, channel, logger));\n     }\n }"
}