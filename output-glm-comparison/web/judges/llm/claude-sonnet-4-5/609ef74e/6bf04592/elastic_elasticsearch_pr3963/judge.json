{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 3963,
  "base_commit": "7867de4f5bb7bed1641e6be8d58118d3bc0c5ce3",
  "head_commit": "fb9cd5a562a13dbf085ece4e4cb75ff17c3c849a",
  "judge_mode": "llm",
  "judge_model": "claude-sonnet-4-5",
  "scores": {
    "correctness": -0.9,
    "completeness": -0.3,
    "code_reuse": -0.7,
    "best_practices": -0.8,
    "unsolicited_docs": 1.0
  },
  "aggregate": -0.34,
  "rationale": "The agent created new abstract base classes named 'AbstractAcknowledgedRequest' and 'AbstractAcknowledgedResponse' instead of converting the existing 'AcknowledgedRequest' interface and 'AcknowledgedResponse' interface into abstract classes as the ground truth did. This is a critical architectural error because: (1) The ground truth preserves the existing API by converting interfaces to abstract classes in-place, while the agent creates entirely new classes with different names, breaking compatibility. (2) The agent modified additional unrelated files (CreateIndexRequest, CreateIndexResponse, DeleteIndexResponse, OpenIndexRequest, OpenIndexResponse) that were not touched in the ground truth, suggesting scope creep. (3) Most critically, the agent did NOT create the actual AbstractAcknowledgedRequest.java and AbstractAcknowledgedResponse.java files that it references throughout the diff - these are phantom classes that don't exist, which would cause compilation failure. (4) The ground truth's AcknowledgedRequest abstract class includes sophisticated helper methods (readTimeout/writeTimeout) with Version-aware serialization logic, while the agent's approach doesn't show these implementations. (5) The agent removed timeout serialization code from request classes without providing the replacement base class implementation, breaking wire compatibility. The completeness score reflects that warmer classes were partially addressed but the core refactoring (converting interfaces to abstract classes) was done incorrectly with wrong class names and missing implementations.",
  "edit_run_id": "6bf04592",
  "judge_run_id": "609ef74e",
  "ground_truth_patch": "diff --git a/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerRequest.java b/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerRequest.java\nindex 83be17e04041..ea5ecbb70064 100644\n--- a/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerRequest.java\n+++ b/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerRequest.java\n@@ -22,7 +22,6 @@ package org.elasticsearch.action.admin.indices.warmer.delete;\n import org.elasticsearch.Version;\n import org.elasticsearch.action.ActionRequestValidationException;\n import org.elasticsearch.action.support.master.AcknowledgedRequest;\n-import org.elasticsearch.action.support.master.MasterNodeOperationRequest;\n import org.elasticsearch.common.Nullable;\n import org.elasticsearch.common.Strings;\n import org.elasticsearch.common.io.stream.StreamInput;\n@@ -31,14 +30,12 @@ import org.elasticsearch.common.unit.TimeValue;\n \n import java.io.IOException;\n \n-import static org.elasticsearch.common.unit.TimeValue.readTimeValue;\n import static org.elasticsearch.common.unit.TimeValue.timeValueSeconds;\n \n /**\n  * A request to delete an index warmer.\n  */\n-public class DeleteWarmerRequest extends MasterNodeOperationRequest<DeleteWarmerRequest>\n-        implements AcknowledgedRequest<DeleteWarmerRequest> {\n+public class DeleteWarmerRequest extends AcknowledgedRequest<DeleteWarmerRequest> {\n \n     private String name;\n \n@@ -96,31 +93,12 @@ public class DeleteWarmerRequest extends MasterNodeOperationRequest<DeleteWarmer\n         return indices;\n     }\n \n-    @Override\n-    public DeleteWarmerRequest timeout(String timeout) {\n-        this.timeout = TimeValue.parseTimeValue(timeout, this.timeout);\n-        return this;\n-    }\n-\n-    @Override\n-    public DeleteWarmerRequest timeout(TimeValue timeout) {\n-        this.timeout = timeout;\n-        return this;\n-    }\n-\n-    @Override\n-    public TimeValue timeout() {\n-        return timeout;\n-    }\n-\n     @Override\n     public void readFrom(StreamInput in) throws IOException {\n         super.readFrom(in);\n         name = in.readOptionalString();\n         indices = in.readStringArray();\n-        if (in.getVersion().onOrAfter(Version.V_0_90_6)) {\n-            timeout = readTimeValue(in);\n-        }\n+        readTimeout(in, Version.V_0_90_6);\n     }\n \n     @Override\n@@ -128,8 +106,6 @@ public class DeleteWarmerRequest extends MasterNodeOperationRequest<DeleteWarmer\n         super.writeTo(out);\n         out.writeOptionalString(name);\n         out.writeStringArrayNullable(indices);\n-        if (out.getVersion().onOrAfter(Version.V_0_90_6)) {\n-            timeout.writeTo(out);\n-        }\n+        writeTimeout(out, Version.V_0_90_6);\n     }\n }\ndiff --git a/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerResponse.java b/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerResponse.java\nindex 0d8b70efb974..3a3fee6880d9 100644\n--- a/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerResponse.java\n+++ b/src/main/java/org/elasticsearch/action/admin/indices/warmer/delete/DeleteWarmerResponse.java\n@@ -19,40 +19,18 @@\n \n package org.elasticsearch.action.admin.indices.warmer.delete;\n \n-import org.elasticsearch.action.ActionResponse;\n import org.elasticsearch.action.support.master.AcknowledgedResponse;\n-import org.elasticsearch.common.io.stream.StreamInput;\n-import org.elasticsearch.common.io.stream.StreamOutput;\n-\n-import java.io.IOException;\n \n /**\n  * A response for a delete warmer.\n  */\n-public class DeleteWarmerResponse extends ActionResponse implements AcknowledgedResponse {\n-\n-    private boolean acknowledged;\n+public class DeleteWarmerResponse  extends AcknowledgedResponse {\n \n     DeleteWarmerResponse() {\n+        super();\n     }\n \n     DeleteWarmerResponse(boolean acknowledged) {\n-        this.acknowledged = acknowledged;\n-    }\n-\n-    public boolean isAcknowledged() {\n-        return acknowledged;\n-    }\n-\n-    @Override\n-    public void readFrom(StreamInput in) throws IOException {\n-        super.readFrom(in);\n-        acknowledged = in.readBoolean();\n-    }\n-\n-    @Override\n-    public void writeTo(StreamOutput out) throws IOException {\n-        super.writeTo(out);\n-        out.writeBoolean(acknowledged);\n+        super(acknowledged);\n     }\n }\ndiff --git a/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerRequest.java b/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerRequest.java\nindex 5d5872f12cdf..69422e954f31 100644\n--- a/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerRequest.java\n+++ b/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerRequest.java\n@@ -24,29 +24,23 @@ import org.elasticsearch.action.ActionRequestValidationException;\n import org.elasticsearch.action.search.SearchRequest;\n import org.elasticsearch.action.search.SearchRequestBuilder;\n import org.elasticsearch.action.support.master.AcknowledgedRequest;\n-import org.elasticsearch.action.support.master.MasterNodeOperationRequest;\n import org.elasticsearch.common.Nullable;\n import org.elasticsearch.common.io.stream.StreamInput;\n import org.elasticsearch.common.io.stream.StreamOutput;\n-import org.elasticsearch.common.unit.TimeValue;\n \n import java.io.IOException;\n \n import static org.elasticsearch.action.ValidateActions.addValidationError;\n-import static org.elasticsearch.common.unit.TimeValue.readTimeValue;\n-import static org.elasticsearch.common.unit.TimeValue.timeValueSeconds;\n \n /**\n  * A request to put a search warmer.\n  */\n-public class PutWarmerRequest extends MasterNodeOperationRequest<PutWarmerRequest>\n-        implements AcknowledgedRequest<PutWarmerRequest> {\n+public class PutWarmerRequest extends AcknowledgedRequest<PutWarmerRequest> {\n \n     private String name;\n \n     private SearchRequest searchRequest;\n \n-    private TimeValue timeout = timeValueSeconds(10);\n \n     PutWarmerRequest() {\n \n@@ -94,22 +88,6 @@ public class PutWarmerRequest extends MasterNodeOperationRequest<PutWarmerReques\n         return this.searchRequest;\n     }\n \n-    @Override\n-    public PutWarmerRequest timeout(String timeout) {\n-        return this;\n-    }\n-\n-    @Override\n-    public PutWarmerRequest timeout(TimeValue timeout) {\n-        this.timeout = timeout;\n-        return this;\n-    }\n-\n-    @Override\n-    public TimeValue timeout() {\n-        return timeout;\n-    }\n-\n     @Override\n     public ActionRequestValidationException validate() {\n         ActionRequestValidationException validationException = searchRequest.validate();\n@@ -127,9 +105,7 @@ public class PutWarmerRequest extends MasterNodeOperationRequest<PutWarmerReques\n             searchRequest = new SearchRequest();\n             searchRequest.readFrom(in);\n         }\n-        if (in.getVersion().onOrAfter(Version.V_0_90_6)) {\n-            timeout = readTimeValue(in);\n-        }\n+        readTimeout(in, Version.V_0_90_6);\n     }\n \n     @Override\n@@ -142,8 +118,6 @@ public class PutWarmerRequest extends MasterNodeOperationRequest<PutWarmerReques\n             out.writeBoolean(true);\n             searchRequest.writeTo(out);\n         }\n-        if (out.getVersion().onOrAfter(Version.V_0_90_6)) {\n-            timeout.writeTo(out);\n-        }\n+        writeTimeout(out, Version.V_0_90_6);\n     }\n }\ndiff --git a/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerResponse.java b/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerResponse.java\nindex c7daac75a956..58dd2ece8acf 100644\n--- a/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerResponse.java\n+++ b/src/main/java/org/elasticsearch/action/admin/indices/warmer/put/PutWarmerResponse.java\n@@ -19,44 +19,19 @@\n \n package org.elasticsearch.action.admin.indices.warmer.put;\n \n-import org.elasticsearch.action.ActionResponse;\n import org.elasticsearch.action.support.master.AcknowledgedResponse;\n-import org.elasticsearch.common.io.stream.StreamInput;\n-import org.elasticsearch.common.io.stream.StreamOutput;\n-\n-import java.io.IOException;\n \n /**\n  * The response of put warmer operation.\n  */\n-public class PutWarmerResponse extends ActionResponse implements AcknowledgedResponse {\n-\n-    private boolean acknowledged;\n+public class PutWarmerResponse extends AcknowledgedResponse {\n \n     PutWarmerResponse() {\n-\n+        super();\n     }\n \n     PutWarmerResponse(boolean acknowledged) {\n-        this.acknowledged = acknowledged;\n-    }\n-\n-    /**\n-     * Has the put warmer been ack'ed.\n-     */\n-    public boolean isAcknowledged() {\n-        return acknowledged;\n-    }\n-\n-    @Override\n-    public void readFrom(StreamInput in) throws IOException {\n-        super.readFrom(in);\n-        acknowledged = in.readBoolean();\n+        super(acknowledged);\n     }\n \n-    @Override\n-    public void writeTo(StreamOutput out) throws IOException {\n-        super.writeTo(out);\n-        out.writeBoolean(acknowledged);\n-    }\n }\n\\ No newline at end of file\ndiff --git a/src/main/java/org/elasticsearch/action/support/master/AcknowledgedRequest.java b/src/main/java/org/elasticsearch/action/support/master/AcknowledgedRequest.java\nindex 3e25ee9aa6ff..2c61539f18d5 100644\n--- a/src/main/java/org/elasticsearch/action/support/master/AcknowledgedRequest.java\n+++ b/src/main/java/org/elasticsearch/action/support/master/AcknowledgedRequest.java\n@@ -18,32 +18,70 @@\n \n package org.elasticsearch.action.support.master;\n \n-import org.elasticsearch.action.ActionRequest;\n+import org.elasticsearch.Version;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n import org.elasticsearch.common.unit.TimeValue;\n \n+import java.io.IOException;\n+\n+import static org.elasticsearch.common.unit.TimeValue.readTimeValue;\n+import static org.elasticsearch.common.unit.TimeValue.timeValueSeconds;\n+\n /**\n- * Interface that allows to mark action requests that support acknowledgements.\n+ * Abstract class that allows to mark action requests that support acknowledgements.\n  * Facilitates consistency across different api.\n  */\n-public interface AcknowledgedRequest<T extends ActionRequest<T>> {\n+public abstract class AcknowledgedRequest<T extends MasterNodeOperationRequest> extends MasterNodeOperationRequest<T> {\n+\n+    protected TimeValue timeout = timeValueSeconds(10);\n \n+    protected AcknowledgedRequest() {\n+    }\n     /**\n      * Allows to set the timeout\n      * @param timeout timeout as a string (e.g. 1s)\n      * @return the request itself\n      */\n-    T timeout(String timeout);\n+    public final T timeout(String timeout) {\n+        this.timeout = TimeValue.parseTimeValue(timeout, this.timeout);\n+        return (T)this;\n+    }\n \n     /**\n      * Allows to set the timeout\n      * @param timeout timeout as a {@link TimeValue}\n      * @return the request itself\n      */\n-    T timeout(TimeValue timeout);\n+    public final T timeout(TimeValue timeout) {\n+        this.timeout = timeout;\n+        return (T) this;\n+    }\n \n     /**\n      * Returns the current timeout\n      * @return the current timeout as a {@link TimeValue}\n      */\n-    TimeValue timeout();\n+    public final TimeValue timeout() {\n+        return  timeout;\n+    }\n+\n+    /**\n+     * Reads the timeout value if on or after the specified min version or if the version is <code>null</code>.\n+     */\n+    protected void readTimeout(StreamInput in, Version minVersion) throws IOException {\n+        if (minVersion == null || in.getVersion().onOrAfter(minVersion)) {\n+            timeout = readTimeValue(in);\n+        }\n+    }\n+\n+    /**\n+     * writes the timeout value if on or after the specified min version or if the version is <code>null</code>.\n+     */\n+    protected void writeTimeout(StreamOutput out, Version minVersion) throws IOException {\n+        if (minVersion == null || out.getVersion().onOrAfter(minVersion)) {\n+            timeout.writeTo(out);\n+        }\n+    }\n+\n }\ndiff --git a/src/main/java/org/elasticsearch/action/support/master/AcknowledgedResponse.java b/src/main/java/org/elasticsearch/action/support/master/AcknowledgedResponse.java\nindex 90bf831a892c..99b46fbda615 100644\n--- a/src/main/java/org/elasticsearch/action/support/master/AcknowledgedResponse.java\n+++ b/src/main/java/org/elasticsearch/action/support/master/AcknowledgedResponse.java\n@@ -18,15 +18,45 @@\n \n package org.elasticsearch.action.support.master;\n \n+import org.elasticsearch.action.ActionResponse;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+\n+import java.io.IOException;\n+\n /**\n- * Interface that allows to mark action responses that support acknowledgements.\n+ * Abstract class that allows to mark action responses that support acknowledgements.\n  * Facilitates consistency across different api.\n  */\n-public interface AcknowledgedResponse {\n+public abstract class AcknowledgedResponse extends ActionResponse {\n+\n+    private boolean acknowledged;\n+\n+    protected AcknowledgedResponse() {\n+\n+    }\n+\n+    protected AcknowledgedResponse(boolean acknowledged) {\n+        this.acknowledged = acknowledged;\n+    }\n \n     /**\n      * Returns whether the response is acknowledged or not\n      * @return true if the response is acknowledged, false otherwise\n      */\n-    boolean isAcknowledged();\n+    public final boolean isAcknowledged() {\n+        return acknowledged;\n+    }\n+\n+    @Override\n+    public void readFrom(StreamInput in) throws IOException {\n+        super.readFrom(in);\n+        acknowledged = in.readBoolean();\n+    }\n+\n+    @Override\n+    public void writeTo(StreamOutput out) throws IOException {\n+        super.writeTo(out);\n+        out.writeBoolean(acknowledged);\n+    }\n }"
}