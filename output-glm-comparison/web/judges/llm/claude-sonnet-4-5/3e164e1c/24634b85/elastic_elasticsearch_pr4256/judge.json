{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 4256,
  "base_commit": "f1bf585089db2b3acb28edf619de4f387e69f923",
  "head_commit": "811b7d7d7837010a205baf59cc75d8df3b1ad69b",
  "judge_mode": "llm",
  "judge_model": "claude-sonnet-4-5",
  "scores": {
    "correctness": -0.7,
    "completeness": -0.5,
    "code_reuse": 0.0,
    "best_practices": -0.3,
    "unsolicited_docs": -0.8
  },
  "aggregate": -0.45999999999999996,
  "rationale": "The agent made critical errors in implementing the requested changes. In src/deb/control/postinst, it removed the 'update-rc.d' line entirely instead of just removing the automatic startup call, breaking the upgrade path. The ground truth correctly preserves 'update-rc.d' for upgrades while only removing it from fresh installations. In src/rpm/scripts/postinstall, the agent failed to remove the automatic service enablement commands ('/bin/systemctl enable elasticsearch.service' and '/sbin/chkconfig --add elasticsearch'), only commenting out 'startElasticsearch'. The ground truth removes both enablement AND startup. For documentation, the agent added extensive unsolicited changes to as-a-service.asciidoc (generic NOTE block at top) and created entirely new content in as-a-service-win.asciidoc (Windows documentation not in task scope). The ground truth made targeted changes to specific sections (debian, RPM/chkconfig, systemd) with inline documentation and manual startup commands. The agent's changes are functionally incomplete (services still auto-enable on fresh install for RPM) and include significant scope creep with Windows documentation.",
  "edit_run_id": "24634b85",
  "judge_run_id": "3e164e1c",
  "ground_truth_patch": "diff --git a/docs/reference/setup/as-a-service.asciidoc b/docs/reference/setup/as-a-service.asciidoc\nindex d8a935b95d4..f0e323385b8 100644\n--- a/docs/reference/setup/as-a-service.asciidoc\n+++ b/docs/reference/setup/as-a-service.asciidoc\n@@ -30,6 +30,14 @@ Each package features a configuration file, which allows you to set the followin\n \n The debian package ships with everything you need as it uses standard debian tools like update `update-rc.d` to define the runlevels it runs on. The init script is placed at `/etc/init.d/elasticsearch` is you would expect it. The configuration file is placed at `/etc/default/elasticsearch`.\n \n+The debian package does not start up the service by default. The reason for this is to prevent the instance to accidentally join a cluster, without being configured appropriately. After installing using `dpkg -i` you can use the following commands to ensure, that elasticsearch starts when the system is booted and then start up elasticsearch:\n+\n+[source,sh]\n+--------------------------------------------------\n+sudo update-rc.d elasticsearch defaults 95 10\n+sudo /etc/init.d/elasticsearch start\n+--------------------------------------------------\n+\n ===== Installing the oracle JDK\n \n The usual recommendation is to run the Oracle JDK with elasticsearch. However Ubuntu and Debian only ship the OpenJDK due to license issues. You can easily install the oracle installer package though. In case you are missing the `add-apt-repository` command under Debian GNU/Linux, make sure have at least Debian Wheezy and the package `python-software-properties` installed\n@@ -45,12 +53,28 @@ java -version\n The last command should verify a successful installation of the Oracle JDK.\n \n \n-==== RedHat/Centos/Fedora\n+==== RPM based distributions \n \n-RedHat based distributions are using `chkconfig` to enable and disable services. The init script is at `/etc/init.d/elasticsearch`, where as the configuration file is placed at `/etc/sysconfig/elasticsearch`.\n+===== Using chkconfig\n \n-==== SuSe\n+Some RPM based distributions are using `chkconfig` to enable and disable services. The init script is located at `/etc/init.d/elasticsearch`, where as the configuration file is placed at `/etc/sysconfig/elasticsearch`. Like the debian package the RPM package is not started by default after installation, you have to do this manually by entering the following commands\n \n-SuSe does not use the `chkconfig` tool to register services, but rather `systemd` and its command `/bin/systemctl` to start and stop services. The configuration file is also placed at `/etc/sysconfig/elasticsearch`.\n+[source,sh]\n+--------------------------------------------------\n+sudo /sbin/chkconfig --add elasticsearch\n+sudo service elasticsearch start\n+--------------------------------------------------\n+\n+\n+===== Using systemd\n+\n+Distributions like SuSe do not use the `chkconfig` tool to register services, but rather `systemd` and its command `/bin/systemctl` to start and stop services (at least in newer versions, otherwise use the `chkconfig` commands above). The configuration file is also placed at `/etc/sysconfig/elasticsearch`. After installing the RPM, you have to change the systemd configuration and then start up elasticsearch\n+\n+[source,sh]\n+--------------------------------------------------\n+sudo /bin/systemctl daemon-reload\n+sudo /bin/systemctl enable elasticsearch.service\n+sudo /bin/systemctl start elasticsearch.service\n+--------------------------------------------------\n \n Also note that changing the `MAX_MAP_COUNT` setting in `/etc/sysconfig/elasticsearch` does not have any effect, you will have to change it in `/usr/lib/sysctl.d/elasticsearch.conf` in order to have it applied at startup.\ndiff --git a/src/deb/control/postinst b/src/deb/control/postinst\nindex 1e14e8aa4aa..af5f0dfca52 100755\n--- a/src/deb/control/postinst\n+++ b/src/deb/control/postinst\n@@ -36,13 +36,15 @@ case \"$1\" in\n \tchmod 755 /etc/elasticsearch\n \tchmod 644 /etc/elasticsearch/*\n \t\n-\tupdate-rc.d elasticsearch defaults 95 10 >/dev/null\n \t# if $2 is set, this is an upgrade\n \tif ( [ -n $2 ] && [ \"$RESTART_ON_UPGRADE\" = \"true\" ] ) ; then\n \t\tstartElasticsearch\n-\t# this is a fresh installation, start anyway\n+\t# this is a fresh installation\n \telif [ -z $2 ] ; then\n-\t\tstartElasticsearch\n+        echo \"### NOT starting elasticsearch by default on bootup, please execute\"\n+        echo \" sudo update-rc.d elasticsearch defaults 95 10\"\n+        echo \"### In order to start elasticsearch, execute\"\n+        echo \" sudo /etc/init.d/elasticsearch start\"\n \tfi\n \t;;\n esac\ndiff --git a/src/rpm/scripts/postinstall b/src/rpm/scripts/postinstall\nindex aefbea30021..317f7fe4029 100644\n--- a/src/rpm/scripts/postinstall\n+++ b/src/rpm/scripts/postinstall\n@@ -29,13 +29,20 @@ stopElasticsearch() {\n if [ $1 -eq 1 ] ; then\n \n     if [ -x /bin/systemctl ] ; then\n-        /bin/systemctl daemon-reload >/dev/null 2>&1 || :\n-        /bin/systemctl enable elasticsearch.service\n+        echo \"### NOT starting on installation, please execute the following statements to configure elasticsearch to start automatically using systemd\"\n+        echo \" sudo /bin/systemctl daemon-reload\"\n+        echo \" sudo /bin/systemctl enable elasticsearch.service\"\n+        echo \"### You can start elasticsearch by executing\"\n+        echo \" sudo /bin/systemctl start elasticsearch.service\"\n+        \n+        \n     elif [ -x /sbin/chkconfig ] ; then\n-        /sbin/chkconfig --add elasticsearch\n+        echo \"### NOT starting on installation, please execute the following statements to configure elasticsearch to start automatically using chkconfig\"\n+        echo \" sudo /sbin/chkconfig --add elasticsearch\"\n+        echo \"### You can start elasticsearch by executing\"\n+        echo \" sudo service elasticsearch start\"\n     fi\n \n-\tstartElasticsearch\n elif [ $1 -ge 2 -a \"$RESTART_ON_UPGRADE\" == \"true\" ] ; then\n \tstopElasticsearch\n \tstartElasticsearch"
}