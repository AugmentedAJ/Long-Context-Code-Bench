{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134665,
  "base_commit": "2886ee1833eb8679be12a7191c8532c93328694d",
  "head_commit": "d074537adafd0c1b1c031d26d36ce0ffc35d69c0",
  "judge_mode": "llm",
  "judge_model": "claude-sonnet-4-5",
  "scores": {
    "correctness": 0.0,
    "completeness": -0.95,
    "code_reuse": 0.0,
    "best_practices": 0.0,
    "unsolicited_docs": 1.0
  },
  "aggregate": 0.010000000000000009,
  "rationale": "The agent correctly identified and fixed the flaky test issue by changing `smallestMessage` from an instance variable to a static variable in TextRollingUpgradeIT.java, which matches one small part of the ground truth. However, the ground truth contains extensive additional changes across 30+ files including removal of timeseries truncation settings, feature flag guards for logs_stream, transport version cleanup, muted-tests.yml updates, and Configuration class refactoring. The agent's diff is only 1 line changed in 1 file, while the ground truth changes hundreds of lines across the entire codebase. The task instruction 'fix the flaky TextRollingUpgradeIT test that loses smallestMessage between runs' was interpreted narrowly by the agent to mean only the immediate test file fix, but the ground truth reveals this was part of a much larger feature flag and configuration cleanup effort. The agent's change is correct for what it does (preventing instance variable reinitialization across test runs), but represents less than 1% of the total ground truth work.",
  "edit_run_id": "7ad89f22",
  "judge_run_id": "3e164e1c",
  "ground_truth_patch": "diff --git a/benchmarks/src/main/java/org/elasticsearch/benchmark/_nightly/esql/QueryPlanningBenchmark.java b/benchmarks/src/main/java/org/elasticsearch/benchmark/_nightly/esql/QueryPlanningBenchmark.java\nindex 5d1a8ba595f..8cbb2f7aff0 100644\n--- a/benchmarks/src/main/java/org/elasticsearch/benchmark/_nightly/esql/QueryPlanningBenchmark.java\n+++ b/benchmarks/src/main/java/org/elasticsearch/benchmark/_nightly/esql/QueryPlanningBenchmark.java\n@@ -86,9 +86,7 @@ public class QueryPlanningBenchmark {\n             false,\n             Map.of(),\n             System.nanoTime(),\n-            false,\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.get(Settings.EMPTY)\n+            false\n         );\n \n         var fields = 10_000;\ndiff --git a/benchmarks/src/main/java/org/elasticsearch/benchmark/compute/operator/EvalBenchmark.java b/benchmarks/src/main/java/org/elasticsearch/benchmark/compute/operator/EvalBenchmark.java\nindex 4eed678b297..25d263ca026 100644\n--- a/benchmarks/src/main/java/org/elasticsearch/benchmark/compute/operator/EvalBenchmark.java\n+++ b/benchmarks/src/main/java/org/elasticsearch/benchmark/compute/operator/EvalBenchmark.java\n@@ -365,9 +365,7 @@ public class EvalBenchmark {\n             false,\n             Map.of(),\n             0,\n-            false,\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            false\n         );\n     }\n \ndiff --git a/modules/ingest-otel/src/main/java/org/elasticsearch/ingest/otel/NormalizeForStreamPlugin.java b/modules/ingest-otel/src/main/java/org/elasticsearch/ingest/otel/NormalizeForStreamPlugin.java\nindex bd88603407e..1404d7c15e5 100644\n--- a/modules/ingest-otel/src/main/java/org/elasticsearch/ingest/otel/NormalizeForStreamPlugin.java\n+++ b/modules/ingest-otel/src/main/java/org/elasticsearch/ingest/otel/NormalizeForStreamPlugin.java\n@@ -9,6 +9,7 @@\n \n package org.elasticsearch.ingest.otel;\n \n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.ingest.Processor;\n import org.elasticsearch.plugins.IngestPlugin;\n import org.elasticsearch.plugins.Plugin;\n@@ -19,6 +20,10 @@ public class NormalizeForStreamPlugin extends Plugin implements IngestPlugin {\n \n     @Override\n     public Map<String, Processor.Factory> getProcessors(Processor.Parameters parameters) {\n-        return Map.of(NormalizeForStreamProcessor.TYPE, new NormalizeForStreamProcessor.Factory());\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            return Map.of(NormalizeForStreamProcessor.TYPE, new NormalizeForStreamProcessor.Factory());\n+        } else {\n+            return Map.of();\n+        }\n     }\n }\ndiff --git a/modules/streams/src/main/java/org/elasticsearch/rest/streams/StreamsPlugin.java b/modules/streams/src/main/java/org/elasticsearch/rest/streams/StreamsPlugin.java\nindex 3ba1bc1d751..4e3a531e20d 100644\n--- a/modules/streams/src/main/java/org/elasticsearch/rest/streams/StreamsPlugin.java\n+++ b/modules/streams/src/main/java/org/elasticsearch/rest/streams/StreamsPlugin.java\n@@ -9,6 +9,7 @@\n \n package org.elasticsearch.rest.streams;\n \n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.cluster.metadata.IndexNameExpressionResolver;\n import org.elasticsearch.cluster.node.DiscoveryNodes;\n import org.elasticsearch.common.io.stream.NamedWriteableRegistry;\n@@ -28,6 +29,7 @@ import org.elasticsearch.rest.streams.logs.StreamsStatusAction;\n import org.elasticsearch.rest.streams.logs.TransportLogsStreamsToggleActivation;\n import org.elasticsearch.rest.streams.logs.TransportStreamsStatusAction;\n \n+import java.util.Collections;\n import java.util.List;\n import java.util.function.Predicate;\n import java.util.function.Supplier;\n@@ -51,7 +53,10 @@ public class StreamsPlugin extends Plugin implements ActionPlugin {\n         Supplier<DiscoveryNodes> nodesInCluster,\n         Predicate<NodeFeature> clusterSupportsFeature\n     ) {\n-        return List.of(new RestSetLogStreamsEnabledAction(), new RestStreamsStatusAction());\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            return List.of(new RestSetLogStreamsEnabledAction(), new RestStreamsStatusAction());\n+        }\n+        return Collections.emptyList();\n     }\n \n     @Override\ndiff --git a/muted-tests.yml b/muted-tests.yml\nindex e09c8327efa..f6f13662a06 100644\n--- a/muted-tests.yml\n+++ b/muted-tests.yml\n@@ -519,15 +519,6 @@ tests:\n - class: org.elasticsearch.xpack.esql.ccq.MultiClusterSpecIT\n   method: test {csv-spec:fork.FiveFork}\n   issue: https://github.com/elastic/elasticsearch/issues/134560\n-- class: org.elasticsearch.upgrades.TextRollingUpgradeIT\n-  method: testIndexing {upgradedNodes=2}\n-  issue: https://github.com/elastic/elasticsearch/issues/134600\n-- class: org.elasticsearch.upgrades.TextRollingUpgradeIT\n-  method: testIndexing {upgradedNodes=3}\n-  issue: https://github.com/elastic/elasticsearch/issues/134601\n-- class: org.elasticsearch.upgrades.TextRollingUpgradeIT\n-  method: testIndexing {upgradedNodes=1}\n-  issue: https://github.com/elastic/elasticsearch/issues/134602\n - class: org.elasticsearch.snapshots.SnapshotShutdownIT\n   method: testSnapshotShutdownProgressTracker\n   issue: https://github.com/elastic/elasticsearch/issues/134620\ndiff --git a/server/src/main/java/org/elasticsearch/TransportVersions.java b/server/src/main/java/org/elasticsearch/TransportVersions.java\nindex 1dd38da37eb..31ff9e155da 100644\n--- a/server/src/main/java/org/elasticsearch/TransportVersions.java\n+++ b/server/src/main/java/org/elasticsearch/TransportVersions.java\n@@ -325,7 +325,6 @@ public class TransportVersions {\n     public static final TransportVersion ML_INFERENCE_ENDPOINT_CACHE = def(9_157_0_00);\n     public static final TransportVersion INDEX_SOURCE = def(9_158_0_00);\n     public static final TransportVersion MAX_HEAP_SIZE_PER_NODE_IN_CLUSTER_INFO = def(9_159_0_00);\n-    public static final TransportVersion TIMESERIES_DEFAULT_LIMIT = def(9_160_0_00);\n \n     /*\n      * STOP! READ THIS FIRST! No, really,\ndiff --git a/server/src/main/java/org/elasticsearch/cluster/metadata/DataStream.java b/server/src/main/java/org/elasticsearch/cluster/metadata/DataStream.java\nindex e1e0b95ac65..6c71abcf232 100644\n--- a/server/src/main/java/org/elasticsearch/cluster/metadata/DataStream.java\n+++ b/server/src/main/java/org/elasticsearch/cluster/metadata/DataStream.java\n@@ -35,6 +35,7 @@ import org.elasticsearch.common.io.stream.StreamOutput;\n import org.elasticsearch.common.settings.Settings;\n import org.elasticsearch.common.time.DateFormatter;\n import org.elasticsearch.common.time.DateFormatters;\n+import org.elasticsearch.common.util.FeatureFlag;\n import org.elasticsearch.common.xcontent.XContentHelper;\n import org.elasticsearch.core.FixForMultiProject;\n import org.elasticsearch.core.Nullable;\n@@ -89,6 +90,7 @@ public final class DataStream implements SimpleDiffable<DataStream>, ToXContentO\n     private static final TransportVersion MAPPINGS_IN_DATA_STREAMS = TransportVersion.fromName(\"mappings_in_data_streams\");\n \n     public static final NodeFeature DATA_STREAM_FAILURE_STORE_FEATURE = new NodeFeature(\"data_stream.failure_store\");\n+    public static final boolean LOGS_STREAM_FEATURE_FLAG = new FeatureFlag(\"logs_stream\").isEnabled();\n     public static final TransportVersion ADDED_FAILURE_STORE_TRANSPORT_VERSION = TransportVersions.V_8_12_0;\n     public static final TransportVersion ADDED_AUTO_SHARDING_EVENT_VERSION = TransportVersions.V_8_14_0;\n     public static final TransportVersion ADD_DATA_STREAM_OPTIONS_VERSION = TransportVersions.V_8_16_0;\ndiff --git a/server/src/main/java/org/elasticsearch/ingest/IngestFeatures.java b/server/src/main/java/org/elasticsearch/ingest/IngestFeatures.java\nindex 9063df9253b..38ec1c40114 100644\n--- a/server/src/main/java/org/elasticsearch/ingest/IngestFeatures.java\n+++ b/server/src/main/java/org/elasticsearch/ingest/IngestFeatures.java\n@@ -9,6 +9,7 @@\n \n package org.elasticsearch.ingest;\n \n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.features.FeatureSpecification;\n import org.elasticsearch.features.NodeFeature;\n \n@@ -20,7 +21,11 @@ public class IngestFeatures implements FeatureSpecification {\n \n     @Override\n     public Set<NodeFeature> getFeatures() {\n-        return Set.of(IngestService.FIELD_ACCESS_PATTERN);\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            return Set.of(IngestService.FIELD_ACCESS_PATTERN);\n+        } else {\n+            return Set.of();\n+        }\n     }\n \n     @Override\ndiff --git a/server/src/main/java/org/elasticsearch/ingest/IngestService.java b/server/src/main/java/org/elasticsearch/ingest/IngestService.java\nindex 2c0359e3670..2aa7090d706 100644\n--- a/server/src/main/java/org/elasticsearch/ingest/IngestService.java\n+++ b/server/src/main/java/org/elasticsearch/ingest/IngestService.java\n@@ -132,7 +132,12 @@ public class IngestService implements ClusterStateApplier, ReportingService<Inge\n      * @return true if the node feature can be supported in the local library code, false if it is not supported\n      */\n     public static boolean locallySupportedIngestFeature(NodeFeature nodeFeature) {\n-        return IngestService.FIELD_ACCESS_PATTERN.equals(nodeFeature);\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            // logs_stream feature flag guard\n+            return IngestService.FIELD_ACCESS_PATTERN.equals(nodeFeature);\n+        }\n+        // Default to unsupported if not contained here\n+        return false;\n     }\n \n     private final MasterServiceTaskQueue<PipelineClusterStateUpdateTask> taskQueue;\ndiff --git a/server/src/main/java/org/elasticsearch/rest/action/ingest/RestPutPipelineAction.java b/server/src/main/java/org/elasticsearch/rest/action/ingest/RestPutPipelineAction.java\nindex 3e91de7513a..90e50842ef5 100644\n--- a/server/src/main/java/org/elasticsearch/rest/action/ingest/RestPutPipelineAction.java\n+++ b/server/src/main/java/org/elasticsearch/rest/action/ingest/RestPutPipelineAction.java\n@@ -13,6 +13,7 @@ import org.elasticsearch.action.ActionListener;\n import org.elasticsearch.action.ingest.PutPipelineRequest;\n import org.elasticsearch.action.ingest.PutPipelineTransportAction;\n import org.elasticsearch.client.internal.node.NodeClient;\n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.common.bytes.ReleasableBytesReference;\n import org.elasticsearch.core.Tuple;\n import org.elasticsearch.rest.BaseRestHandler;\n@@ -78,6 +79,10 @@ public class RestPutPipelineAction extends BaseRestHandler {\n     @Override\n     public Set<String> supportedCapabilities() {\n         // pipeline_tracking info: `{created,modified}_date` system properties defined within pipeline definition.\n-        return Set.of(\"pipeline_tracking_info\", \"field_access_pattern.flexible\");\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            return Set.of(\"pipeline_tracking_info\", \"field_access_pattern.flexible\");\n+        } else {\n+            return Set.of(\"pipeline_tracking_info\");\n+        }\n     }\n }\ndiff --git a/server/src/test/java/org/elasticsearch/action/ingest/SimulatePipelineRequestParsingTests.java b/server/src/test/java/org/elasticsearch/action/ingest/SimulatePipelineRequestParsingTests.java\nindex 6460aff934b..b9a7607563b 100644\n--- a/server/src/test/java/org/elasticsearch/action/ingest/SimulatePipelineRequestParsingTests.java\n+++ b/server/src/test/java/org/elasticsearch/action/ingest/SimulatePipelineRequestParsingTests.java\n@@ -10,6 +10,7 @@\n package org.elasticsearch.action.ingest;\n \n import org.elasticsearch.ElasticsearchParseException;\n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.core.RestApiVersion;\n import org.elasticsearch.index.VersionType;\n import org.elasticsearch.ingest.CompoundProcessor;\n@@ -196,7 +197,7 @@ public class SimulatePipelineRequestParsingTests extends ESTestCase {\n             false,\n             ingestService,\n             RestApiVersion.current(),\n-            (nodeFeature) -> true\n+            (nodeFeature) -> DataStream.LOGS_STREAM_FEATURE_FLAG\n         );\n         assertThat(actualRequest.verbose(), equalTo(false));\n         assertThat(actualRequest.documents().size(), equalTo(numDocs));\n@@ -275,7 +276,7 @@ public class SimulatePipelineRequestParsingTests extends ESTestCase {\n                 false,\n                 ingestService,\n                 RestApiVersion.current(),\n-                (nodeFeature) -> true\n+                (nodeFeature) -> DataStream.LOGS_STREAM_FEATURE_FLAG\n             )\n         );\n         assertThat(e1.getMessage(), equalTo(\"must specify at least one document in [docs]\"));\n@@ -293,7 +294,7 @@ public class SimulatePipelineRequestParsingTests extends ESTestCase {\n                 false,\n                 ingestService,\n                 RestApiVersion.current(),\n-                (nodeFeature) -> true\n+                (nodeFeature) -> DataStream.LOGS_STREAM_FEATURE_FLAG\n             )\n         );\n         assertThat(e2.getMessage(), equalTo(\"malformed [docs] section, should include an inner object\"));\n@@ -309,7 +310,7 @@ public class SimulatePipelineRequestParsingTests extends ESTestCase {\n                 false,\n                 ingestService,\n                 RestApiVersion.current(),\n-                (nodeFeature) -> true\n+                (nodeFeature) -> DataStream.LOGS_STREAM_FEATURE_FLAG\n             )\n         );\n         assertThat(e3.getMessage(), containsString(\"required property is missing\"));\n@@ -390,7 +391,7 @@ public class SimulatePipelineRequestParsingTests extends ESTestCase {\n             false,\n             ingestService,\n             RestApiVersion.V_8,\n-            (nodeFeature) -> true\n+            (nodeFeature) -> DataStream.LOGS_STREAM_FEATURE_FLAG\n         );\n         assertThat(actualRequest.verbose(), equalTo(false));\n         assertThat(actualRequest.documents().size(), equalTo(numDocs));\ndiff --git a/server/src/test/java/org/elasticsearch/ingest/IngestDocumentTests.java b/server/src/test/java/org/elasticsearch/ingest/IngestDocumentTests.java\nindex b5d1940c09d..4d09ed8cae9 100644\n--- a/server/src/test/java/org/elasticsearch/ingest/IngestDocumentTests.java\n+++ b/server/src/test/java/org/elasticsearch/ingest/IngestDocumentTests.java\n@@ -9,11 +9,13 @@\n \n package org.elasticsearch.ingest;\n \n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.common.bytes.BytesArray;\n import org.elasticsearch.common.xcontent.XContentHelper;\n import org.elasticsearch.test.ESTestCase;\n import org.elasticsearch.xcontent.XContentType;\n import org.hamcrest.Matchers;\n+import org.junit.Assume;\n import org.junit.Before;\n import org.mockito.ArgumentCaptor;\n \n@@ -2106,6 +2108,8 @@ public class IngestDocumentTests extends ESTestCase {\n      * restore the previous pipeline's access pattern.\n      */\n     public void testNestedAccessPatternPropagation() {\n+        Assume.assumeTrue(DataStream.LOGS_STREAM_FEATURE_FLAG);\n+\n         Map<String, Object> source = new HashMap<>(Map.of(\"foo\", 1));\n         IngestDocument document = new IngestDocument(\"index\", \"id\", 1, null, null, source);\n \ndiff --git a/server/src/test/java/org/elasticsearch/ingest/PipelineFactoryTests.java b/server/src/test/java/org/elasticsearch/ingest/PipelineFactoryTests.java\nindex f267cef7595..3bfcd48b5f1 100644\n--- a/server/src/test/java/org/elasticsearch/ingest/PipelineFactoryTests.java\n+++ b/server/src/test/java/org/elasticsearch/ingest/PipelineFactoryTests.java\n@@ -10,6 +10,7 @@\n package org.elasticsearch.ingest;\n \n import org.elasticsearch.ElasticsearchParseException;\n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.cluster.metadata.ProjectId;\n import org.elasticsearch.core.Tuple;\n import org.elasticsearch.script.ScriptService;\n@@ -23,6 +24,7 @@ import static org.hamcrest.Matchers.empty;\n import static org.hamcrest.Matchers.equalTo;\n import static org.hamcrest.Matchers.is;\n import static org.hamcrest.Matchers.nullValue;\n+import static org.junit.Assume.assumeTrue;\n import static org.mockito.Mockito.mock;\n \n public class PipelineFactoryTests extends ESTestCase {\n@@ -47,10 +49,19 @@ public class PipelineFactoryTests extends ESTestCase {\n         pipelineConfig.put(Pipeline.DEPRECATED_KEY, deprecated);\n         pipelineConfig.put(Pipeline.PROCESSORS_KEY, List.of(Map.of(\"test\", processorConfig0), Map.of(\"test\", processorConfig1)));\n         IngestPipelineFieldAccessPattern expectedAccessPattern = IngestPipelineFieldAccessPattern.CLASSIC;\n-        expectedAccessPattern = randomFrom(IngestPipelineFieldAccessPattern.values());\n-        pipelineConfig.put(Pipeline.FIELD_ACCESS_PATTERN, expectedAccessPattern.getKey());\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            expectedAccessPattern = randomFrom(IngestPipelineFieldAccessPattern.values());\n+            pipelineConfig.put(Pipeline.FIELD_ACCESS_PATTERN, expectedAccessPattern.getKey());\n+        }\n         Map<String, Processor.Factory> processorRegistry = Map.of(\"test\", new TestProcessor.Factory());\n-        Pipeline pipeline = Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true);\n+        Pipeline pipeline = Pipeline.create(\n+            \"_id\",\n+            pipelineConfig,\n+            processorRegistry,\n+            scriptService,\n+            null,\n+            nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+        );\n         assertThat(pipeline.getId(), equalTo(\"_id\"));\n         assertThat(pipeline.getDescription(), equalTo(\"_description\"));\n         assertThat(pipeline.getVersion(), equalTo(version));\n@@ -71,7 +82,7 @@ public class PipelineFactoryTests extends ESTestCase {\n             pipelineConfig.put(Pipeline.META_KEY, metadata);\n         }\n         try {\n-            Pipeline.create(\"_id\", pipelineConfig, Map.of(), scriptService, null, nodeFeature -> true);\n+            Pipeline.create(\"_id\", pipelineConfig, Map.of(), scriptService, null, nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG);\n             fail(\"should fail, missing required [processors] field\");\n         } catch (ElasticsearchParseException e) {\n             assertThat(e.getMessage(), equalTo(\"[processors] required property is missing\"));\n@@ -86,7 +97,14 @@ public class PipelineFactoryTests extends ESTestCase {\n             pipelineConfig.put(Pipeline.META_KEY, metadata);\n         }\n         pipelineConfig.put(Pipeline.PROCESSORS_KEY, List.of());\n-        Pipeline pipeline = Pipeline.create(\"_id\", pipelineConfig, null, scriptService, null, nodeFeature -> true);\n+        Pipeline pipeline = Pipeline.create(\n+            \"_id\",\n+            pipelineConfig,\n+            null,\n+            scriptService,\n+            null,\n+            nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+        );\n         assertThat(pipeline.getId(), equalTo(\"_id\"));\n         assertThat(pipeline.getDescription(), equalTo(\"_description\"));\n         assertThat(pipeline.getVersion(), equalTo(version));\n@@ -104,7 +122,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         pipelineConfig.put(Pipeline.PROCESSORS_KEY, List.of(Map.of(\"test\", processorConfig)));\n         pipelineConfig.put(Pipeline.ON_FAILURE_KEY, List.of(Map.of(\"test\", processorConfig)));\n         Map<String, Processor.Factory> processorRegistry = Map.of(\"test\", new TestProcessor.Factory());\n-        Pipeline pipeline = Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true);\n+        Pipeline pipeline = Pipeline.create(\n+            \"_id\",\n+            pipelineConfig,\n+            processorRegistry,\n+            scriptService,\n+            null,\n+            nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+        );\n         assertThat(pipeline.getId(), equalTo(\"_id\"));\n         assertThat(pipeline.getDescription(), equalTo(\"_description\"));\n         assertThat(pipeline.getVersion(), equalTo(version));\n@@ -127,7 +152,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         Map<String, Processor.Factory> processorRegistry = Map.of(\"test\", new TestProcessor.Factory());\n         Exception e = expectThrows(\n             ElasticsearchParseException.class,\n-            () -> Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true)\n+            () -> Pipeline.create(\n+                \"_id\",\n+                pipelineConfig,\n+                processorRegistry,\n+                scriptService,\n+                null,\n+                nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+            )\n         );\n         assertThat(e.getMessage(), equalTo(\"pipeline [_id] cannot have an empty on_failure option defined\"));\n     }\n@@ -145,7 +177,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         Map<String, Processor.Factory> processorRegistry = Map.of(\"test\", new TestProcessor.Factory());\n         Exception e = expectThrows(\n             ElasticsearchParseException.class,\n-            () -> Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true)\n+            () -> Pipeline.create(\n+                \"_id\",\n+                pipelineConfig,\n+                processorRegistry,\n+                scriptService,\n+                null,\n+                nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+            )\n         );\n         assertThat(e.getMessage(), equalTo(\"[on_failure] processors list cannot be empty\"));\n     }\n@@ -163,7 +202,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         }\n         pipelineConfig.put(Pipeline.PROCESSORS_KEY, List.of(Map.of(\"test\", processorConfig)));\n \n-        Pipeline pipeline = Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true);\n+        Pipeline pipeline = Pipeline.create(\n+            \"_id\",\n+            pipelineConfig,\n+            processorRegistry,\n+            scriptService,\n+            null,\n+            nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+        );\n         assertThat(pipeline.getId(), equalTo(\"_id\"));\n         assertThat(pipeline.getDescription(), equalTo(\"_description\"));\n         assertThat(pipeline.getVersion(), equalTo(version));\n@@ -176,12 +222,15 @@ public class PipelineFactoryTests extends ESTestCase {\n     }\n \n     public void testCreateUnsupportedFieldAccessPattern() throws Exception {\n+        assumeTrue(\"Test is only valid if the logs stream feature flag is enabled\", DataStream.LOGS_STREAM_FEATURE_FLAG);\n         Map<String, Object> processorConfig = new HashMap<>();\n         processorConfig.put(ConfigurationUtils.TAG_KEY, \"test-processor\");\n         Map<String, Object> pipelineConfig = new HashMap<>();\n         pipelineConfig.put(Pipeline.DESCRIPTION_KEY, \"_description\");\n         pipelineConfig.put(Pipeline.VERSION_KEY, versionString);\n-        pipelineConfig.put(Pipeline.FIELD_ACCESS_PATTERN, \"random\");\n+        if (DataStream.LOGS_STREAM_FEATURE_FLAG) {\n+            pipelineConfig.put(Pipeline.FIELD_ACCESS_PATTERN, \"random\");\n+        }\n         if (metadata != null) {\n             pipelineConfig.put(Pipeline.META_KEY, metadata);\n         }\n@@ -190,7 +239,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         Exception e = expectThrows(\n             ElasticsearchParseException.class,\n             // All node features disabled\n-            () -> Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true)\n+            () -> Pipeline.create(\n+                \"_id\",\n+                pipelineConfig,\n+                processorRegistry,\n+                scriptService,\n+                null,\n+                nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+            )\n         );\n         assertThat(e.getMessage(), equalTo(\"pipeline [_id] doesn't support value of [random] for parameter [field_access_pattern]\"));\n     }\n@@ -231,7 +287,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         Map<String, Processor.Factory> processorRegistry = Map.of(\"test\", new TestProcessor.Factory());\n         Exception e = expectThrows(\n             ElasticsearchParseException.class,\n-            () -> Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true)\n+            () -> Pipeline.create(\n+                \"_id\",\n+                pipelineConfig,\n+                processorRegistry,\n+                scriptService,\n+                null,\n+                nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+            )\n         );\n         assertThat(e.getMessage(), equalTo(\"processor [test] doesn't support one or more provided configuration parameters [unused]\"));\n     }\n@@ -248,7 +311,14 @@ public class PipelineFactoryTests extends ESTestCase {\n         }\n         pipelineConfig.put(Pipeline.PROCESSORS_KEY, List.of(Map.of(\"test\", processorConfig)));\n         Map<String, Processor.Factory> processorRegistry = Map.of(\"test\", new TestProcessor.Factory());\n-        Pipeline pipeline = Pipeline.create(\"_id\", pipelineConfig, processorRegistry, scriptService, null, nodeFeature -> true);\n+        Pipeline pipeline = Pipeline.create(\n+            \"_id\",\n+            pipelineConfig,\n+            processorRegistry,\n+            scriptService,\n+            null,\n+            nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+        );\n         assertThat(pipeline.getId(), equalTo(\"_id\"));\n         assertThat(pipeline.getDescription(), equalTo(\"_description\"));\n         assertThat(pipeline.getVersion(), equalTo(version));\ndiff --git a/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/common/validation/SourceDestValidatorTests.java b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/common/validation/SourceDestValidatorTests.java\nindex 8ba3fe338ca..960e3e0a645 100644\n--- a/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/common/validation/SourceDestValidatorTests.java\n+++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/common/validation/SourceDestValidatorTests.java\n@@ -19,6 +19,7 @@ import org.elasticsearch.client.internal.RemoteClusterClient;\n import org.elasticsearch.cluster.ClusterName;\n import org.elasticsearch.cluster.ClusterState;\n import org.elasticsearch.cluster.metadata.AliasMetadata;\n+import org.elasticsearch.cluster.metadata.DataStream;\n import org.elasticsearch.cluster.metadata.IndexMetadata;\n import org.elasticsearch.cluster.metadata.IndexNameExpressionResolver;\n import org.elasticsearch.cluster.metadata.Metadata;\n@@ -600,7 +601,14 @@ public class SourceDestValidatorTests extends ESTestCase {\n         );\n         Map<String, Processor.Factory> processorRegistry = Collections.singletonMap(\"test\", new TestProcessor.Factory());\n         var projectId = randomProjectIdOrDefault();\n-        Pipeline pipeline = Pipeline.create(\"missing-pipeline\", pipelineConfig, processorRegistry, null, projectId, nodeFeature -> true);\n+        Pipeline pipeline = Pipeline.create(\n+            \"missing-pipeline\",\n+            pipelineConfig,\n+            processorRegistry,\n+            null,\n+            projectId,\n+            nodeFeature -> DataStream.LOGS_STREAM_FEATURE_FLAG\n+        );\n         when(ingestService.getPipeline(\"missing-pipeline\")).thenReturn(pipeline);\n \n         assertValidation(\ndiff --git a/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/ConfigurationTestUtils.java b/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/ConfigurationTestUtils.java\nindex ce59002fda0..c7f51692e33 100644\n--- a/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/ConfigurationTestUtils.java\n+++ b/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/ConfigurationTestUtils.java\n@@ -58,8 +58,6 @@ public class ConfigurationTestUtils {\n         var clusterName = randomAlphaOfLengthBetween(3, 10);\n         var truncation = randomNonNegativeInt();\n         var defaultTruncation = randomNonNegativeInt();\n-        var tsTruncation = truncation + randomNonNegativeInt();\n-        var defaultTsTruncation = defaultTruncation + randomNonNegativeInt();\n         boolean profile = randomBoolean();\n \n         return new Configuration(\n@@ -74,9 +72,7 @@ public class ConfigurationTestUtils {\n             profile,\n             tables,\n             System.nanoTime(),\n-            false,\n-            tsTruncation,\n-            defaultTsTruncation\n+            false\n         );\n     }\n \ndiff --git a/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/EsqlTestUtils.java b/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/EsqlTestUtils.java\nindex d6cbc95f9ef..ff47fc4121b 100644\n--- a/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/EsqlTestUtils.java\n+++ b/x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/EsqlTestUtils.java\n@@ -460,9 +460,7 @@ public final class EsqlTestUtils {\n             false,\n             TABLES,\n             System.nanoTime(),\n-            false,\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            false\n         );\n     }\n \ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/analysis/Analyzer.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/analysis/Analyzer.java\nindex cdb01991c64..e2df6995230 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/analysis/Analyzer.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/analysis/Analyzer.java\n@@ -114,7 +114,6 @@ import org.elasticsearch.xpack.esql.plan.logical.Lookup;\n import org.elasticsearch.xpack.esql.plan.logical.MvExpand;\n import org.elasticsearch.xpack.esql.plan.logical.Project;\n import org.elasticsearch.xpack.esql.plan.logical.Rename;\n-import org.elasticsearch.xpack.esql.plan.logical.TimeSeriesAggregate;\n import org.elasticsearch.xpack.esql.plan.logical.UnresolvedRelation;\n import org.elasticsearch.xpack.esql.plan.logical.fuse.Fuse;\n import org.elasticsearch.xpack.esql.plan.logical.fuse.FuseScoreEval;\n@@ -1373,22 +1372,15 @@ public class Analyzer extends ParameterizedRuleExecutor<LogicalPlan, AnalyzerCon\n         @Override\n         public LogicalPlan apply(LogicalPlan logicalPlan, AnalyzerContext context) {\n             List<LogicalPlan> limits = logicalPlan.collectFirstChildren(Limit.class::isInstance);\n-            // We check whether the query contains a TimeSeriesAggregate to determine if we should apply\n-            // the default limit for TS queries or for non-TS queries.\n-            boolean isTsAggregate = logicalPlan.collectFirstChildren(lp -> lp instanceof TimeSeriesAggregate)\n-                .stream()\n-                .toList()\n-                .isEmpty() == false;\n             int limit;\n             if (limits.isEmpty()) {\n-                limit = context.configuration().resultTruncationDefaultSize(isTsAggregate); // user provided no limit: cap to a\n-                // default\n-                if (isTsAggregate == false) {\n-                    HeaderWarning.addWarning(\"No limit defined, adding default limit of [{}]\", limit);\n-                }\n+                HeaderWarning.addWarning(\n+                    \"No limit defined, adding default limit of [{}]\",\n+                    context.configuration().resultTruncationDefaultSize()\n+                );\n+                limit = context.configuration().resultTruncationDefaultSize(); // user provided no limit: cap to a default\n             } else {\n-                limit = context.configuration().resultTruncationMaxSize(isTsAggregate); // user provided a limit: cap result\n-                                                                                        // entries to the max\n+                limit = context.configuration().resultTruncationMaxSize(); // user provided a limit: cap result entries to the max\n             }\n             var source = logicalPlan.source();\n             return new Limit(source, new Literal(source, limit, DataType.INTEGER), logicalPlan);\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/EsqlPlugin.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/EsqlPlugin.java\nindex 543179195c2..be019af8e03 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/EsqlPlugin.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/EsqlPlugin.java\n@@ -113,24 +113,6 @@ public class EsqlPlugin extends Plugin implements ActionPlugin, ExtensiblePlugin\n         Setting.Property.Dynamic\n     );\n \n-    public static final Setting<Integer> QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE = Setting.intSetting(\n-        \"esql.query.timeseries_result_truncation_default_size\",\n-        1_000_000,\n-        1,\n-        10_000_000,\n-        Setting.Property.NodeScope,\n-        Setting.Property.Dynamic\n-    );\n-\n-    public static final Setting<Integer> QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE = Setting.intSetting(\n-        \"esql.query.timeseries_result_truncation_max_size\",\n-        10_000_000,\n-        1,\n-        1_000_000_000,\n-        Setting.Property.NodeScope,\n-        Setting.Property.Dynamic\n-    );\n-\n     public static final Setting<Boolean> QUERY_ALLOW_PARTIAL_RESULTS = Setting.boolSetting(\n         \"esql.query.allow_partial_results\",\n         true,\n@@ -268,8 +250,6 @@ public class EsqlPlugin extends Plugin implements ActionPlugin, ExtensiblePlugin\n         return List.of(\n             QUERY_RESULT_TRUNCATION_DEFAULT_SIZE,\n             QUERY_RESULT_TRUNCATION_MAX_SIZE,\n-            QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE,\n-            QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE,\n             QUERY_ALLOW_PARTIAL_RESULTS,\n             ESQL_QUERYLOG_THRESHOLD_TRACE_SETTING,\n             ESQL_QUERYLOG_THRESHOLD_DEBUG_SETTING,\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/TransportEsqlQueryAction.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/TransportEsqlQueryAction.java\nindex 00e2c63c9d7..43fd7e8dc80 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/TransportEsqlQueryAction.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/TransportEsqlQueryAction.java\n@@ -86,10 +86,6 @@ public class TransportEsqlQueryAction extends HandledTransportAction<EsqlQueryRe\n     private final UsageService usageService;\n     private final TransportActionServices services;\n     private volatile boolean defaultAllowPartialResults;\n-    private volatile int resultTruncationMaxSize;\n-    private volatile int resultTruncationDefaultSize;\n-    private volatile int timeseriesResultTruncationMaxSize;\n-    private volatile int timeseriesResultTruncationDefaultSize;\n \n     @Inject\n     @SuppressWarnings(\"this-escape\")\n@@ -185,24 +181,7 @@ public class TransportEsqlQueryAction extends HandledTransportAction<EsqlQueryRe\n         defaultAllowPartialResults = EsqlPlugin.QUERY_ALLOW_PARTIAL_RESULTS.get(clusterService.getSettings());\n         clusterService.getClusterSettings()\n             .addSettingsUpdateConsumer(EsqlPlugin.QUERY_ALLOW_PARTIAL_RESULTS, v -> defaultAllowPartialResults = v);\n-        resultTruncationMaxSize = EsqlPlugin.QUERY_RESULT_TRUNCATION_MAX_SIZE.get(clusterService.getSettings());\n-        resultTruncationDefaultSize = EsqlPlugin.QUERY_RESULT_TRUNCATION_DEFAULT_SIZE.get(clusterService.getSettings());\n-        timeseriesResultTruncationMaxSize = EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.get(clusterService.getSettings());\n-        timeseriesResultTruncationDefaultSize = EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.get(\n-            clusterService.getSettings()\n-        );\n-        clusterService.getClusterSettings().addSettingsUpdateConsumer(EsqlPlugin.QUERY_RESULT_TRUNCATION_MAX_SIZE, v -> {\n-            resultTruncationMaxSize = v;\n-        });\n-        clusterService.getClusterSettings().addSettingsUpdateConsumer(EsqlPlugin.QUERY_RESULT_TRUNCATION_DEFAULT_SIZE, v -> {\n-            resultTruncationDefaultSize = v;\n-        });\n-        clusterService.getClusterSettings().addSettingsUpdateConsumer(EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE, v -> {\n-            timeseriesResultTruncationMaxSize = v;\n-        });\n-        clusterService.getClusterSettings().addSettingsUpdateConsumer(EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE, v -> {\n-            timeseriesResultTruncationDefaultSize = v;\n-        });\n+\n     }\n \n     @Override\n@@ -250,15 +229,13 @@ public class TransportEsqlQueryAction extends HandledTransportAction<EsqlQueryRe\n             null,\n             clusterService.getClusterName().value(),\n             request.pragmas(),\n-            resultTruncationMaxSize,\n-            resultTruncationDefaultSize,\n+            clusterService.getClusterSettings().get(EsqlPlugin.QUERY_RESULT_TRUNCATION_MAX_SIZE),\n+            clusterService.getClusterSettings().get(EsqlPlugin.QUERY_RESULT_TRUNCATION_DEFAULT_SIZE),\n             request.query(),\n             request.profile(),\n             request.tables(),\n             System.nanoTime(),\n-            request.allowPartialResults(),\n-            timeseriesResultTruncationMaxSize,\n-            timeseriesResultTruncationDefaultSize\n+            request.allowPartialResults()\n         );\n         String sessionId = sessionID(task);\n         // async-query uses EsqlQueryTask, so pull the EsqlExecutionInfo out of the task\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/session/Configuration.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/session/Configuration.java\nindex 9140bf94943..183dccf48d5 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/session/Configuration.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/session/Configuration.java\n@@ -44,10 +44,8 @@ public class Configuration implements Writeable {\n \n     private final QueryPragmas pragmas;\n \n-    private final int resultTruncationMaxSizeRegular;\n-    private final int resultTruncationDefaultSizeRegular;\n-    private final int resultTruncationMaxSizeTimeseries;\n-    private final int resultTruncationDefaultSizeTimeseries;\n+    private final int resultTruncationMaxSize;\n+    private final int resultTruncationDefaultSize;\n \n     private final Locale locale;\n \n@@ -65,15 +63,13 @@ public class Configuration implements Writeable {\n         String username,\n         String clusterName,\n         QueryPragmas pragmas,\n-        int resultTruncationMaxSizeRegular,\n-        int resultTruncationDefaultSizeRegular,\n+        int resultTruncationMaxSize,\n+        int resultTruncationDefaultSize,\n         String query,\n         boolean profile,\n         Map<String, Map<String, Column>> tables,\n         long queryStartTimeNanos,\n-        boolean allowPartialResults,\n-        int resultTruncationMaxSizeTimeseries,\n-        int resultTruncationDefaultSizeTimeseries\n+        boolean allowPartialResults\n     ) {\n         this.zoneId = zi.normalized();\n         this.now = ZonedDateTime.now(Clock.tick(Clock.system(zoneId), Duration.ofNanos(1)));\n@@ -81,10 +77,8 @@ public class Configuration implements Writeable {\n         this.clusterName = clusterName;\n         this.locale = locale;\n         this.pragmas = pragmas;\n-        this.resultTruncationMaxSizeRegular = resultTruncationMaxSizeRegular;\n-        this.resultTruncationDefaultSizeRegular = resultTruncationDefaultSizeRegular;\n-        this.resultTruncationMaxSizeTimeseries = resultTruncationMaxSizeTimeseries;\n-        this.resultTruncationDefaultSizeTimeseries = resultTruncationDefaultSizeTimeseries;\n+        this.resultTruncationMaxSize = resultTruncationMaxSize;\n+        this.resultTruncationDefaultSize = resultTruncationDefaultSize;\n         this.query = query;\n         this.profile = profile;\n         this.tables = tables;\n@@ -100,8 +94,8 @@ public class Configuration implements Writeable {\n         this.clusterName = in.readOptionalString();\n         locale = Locale.forLanguageTag(in.readString());\n         this.pragmas = new QueryPragmas(in);\n-        this.resultTruncationMaxSizeRegular = in.readVInt();\n-        this.resultTruncationDefaultSizeRegular = in.readVInt();\n+        this.resultTruncationMaxSize = in.readVInt();\n+        this.resultTruncationDefaultSize = in.readVInt();\n         this.query = readQuery(in);\n         if (in.getTransportVersion().onOrAfter(TransportVersions.V_8_12_0)) {\n             this.profile = in.readBoolean();\n@@ -124,13 +118,6 @@ public class Configuration implements Writeable {\n         } else {\n             this.allowPartialResults = false;\n         }\n-        if (in.getTransportVersion().onOrAfter(TransportVersions.TIMESERIES_DEFAULT_LIMIT)) {\n-            this.resultTruncationMaxSizeTimeseries = in.readVInt();\n-            this.resultTruncationDefaultSizeTimeseries = in.readVInt();\n-        } else {\n-            this.resultTruncationMaxSizeTimeseries = this.resultTruncationMaxSizeRegular;\n-            this.resultTruncationDefaultSizeTimeseries = this.resultTruncationDefaultSizeRegular;\n-        }\n     }\n \n     @Override\n@@ -143,8 +130,8 @@ public class Configuration implements Writeable {\n         out.writeOptionalString(clusterName); // TODO this one is never null so maybe not optional\n         out.writeString(locale.toLanguageTag());\n         pragmas.writeTo(out);\n-        out.writeVInt(resultTruncationMaxSizeRegular);\n-        out.writeVInt(resultTruncationDefaultSizeRegular);\n+        out.writeVInt(resultTruncationMaxSize);\n+        out.writeVInt(resultTruncationDefaultSize);\n         writeQuery(out, query);\n         if (out.getTransportVersion().onOrAfter(TransportVersions.V_8_12_0)) {\n             out.writeBoolean(profile);\n@@ -159,10 +146,6 @@ public class Configuration implements Writeable {\n             || out.getTransportVersion().isPatchFrom(TransportVersions.ESQL_SUPPORT_PARTIAL_RESULTS_BACKPORT_8_19)) {\n             out.writeBoolean(allowPartialResults);\n         }\n-        if (out.getTransportVersion().onOrAfter(TransportVersions.TIMESERIES_DEFAULT_LIMIT)) {\n-            out.writeVInt(resultTruncationMaxSizeTimeseries);\n-            out.writeVInt(resultTruncationDefaultSizeTimeseries);\n-        }\n     }\n \n     public ZoneId zoneId() {\n@@ -185,18 +168,12 @@ public class Configuration implements Writeable {\n         return pragmas;\n     }\n \n-    public int resultTruncationMaxSize(boolean isTimeseries) {\n-        if (isTimeseries) {\n-            return resultTruncationMaxSizeTimeseries;\n-        }\n-        return resultTruncationMaxSizeRegular;\n+    public int resultTruncationMaxSize() {\n+        return resultTruncationMaxSize;\n     }\n \n-    public int resultTruncationDefaultSize(boolean isTimeseries) {\n-        if (isTimeseries) {\n-            return resultTruncationDefaultSizeTimeseries;\n-        }\n-        return resultTruncationDefaultSizeRegular;\n+    public int resultTruncationDefaultSize() {\n+        return resultTruncationDefaultSize;\n     }\n \n     public Locale locale() {\n@@ -243,15 +220,13 @@ public class Configuration implements Writeable {\n             username,\n             clusterName,\n             pragmas,\n-            resultTruncationMaxSizeRegular,\n-            resultTruncationDefaultSizeRegular,\n+            resultTruncationMaxSize,\n+            resultTruncationDefaultSize,\n             query,\n             profile,\n             Map.of(),\n             queryStartTimeNanos,\n-            allowPartialResults,\n-            resultTruncationMaxSizeTimeseries,\n-            resultTruncationDefaultSizeTimeseries\n+            allowPartialResults\n         );\n     }\n \n@@ -302,8 +277,8 @@ public class Configuration implements Writeable {\n             && Objects.equals(now, that.now)\n             && Objects.equals(username, that.username)\n             && Objects.equals(clusterName, that.clusterName)\n-            && resultTruncationMaxSizeRegular == that.resultTruncationMaxSizeRegular\n-            && resultTruncationDefaultSizeRegular == that.resultTruncationDefaultSizeRegular\n+            && resultTruncationMaxSize == that.resultTruncationMaxSize\n+            && resultTruncationDefaultSize == that.resultTruncationDefaultSize\n             && Objects.equals(pragmas, that.pragmas)\n             && Objects.equals(locale, that.locale)\n             && Objects.equals(that.query, query)\n@@ -320,15 +295,13 @@ public class Configuration implements Writeable {\n             username,\n             clusterName,\n             pragmas,\n-            resultTruncationMaxSizeRegular,\n-            resultTruncationDefaultSizeRegular,\n+            resultTruncationMaxSize,\n+            resultTruncationDefaultSize,\n             locale,\n             query,\n             profile,\n             tables,\n-            allowPartialResults,\n-            resultTruncationMaxSizeTimeseries,\n-            resultTruncationDefaultSizeTimeseries\n+            allowPartialResults\n         );\n     }\n \n@@ -338,17 +311,9 @@ public class Configuration implements Writeable {\n             + \"pragmas=\"\n             + pragmas\n             + \", resultTruncationMaxSize=\"\n-            + \"[regular=\"\n-            + resultTruncationMaxSize(false)\n-            + \",timeseries=\"\n-            + resultTruncationMaxSize(true)\n-            + \"]\"\n+            + resultTruncationMaxSize\n             + \", resultTruncationDefaultSize=\"\n-            + \"[regular=\"\n-            + resultTruncationDefaultSize(false)\n-            + \",timeseries=\"\n-            + resultTruncationDefaultSize(true)\n-            + \"]\"\n+            + resultTruncationDefaultSize\n             + \", locale=\"\n             + locale\n             + \", query='\"\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/analysis/AnalyzerTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/analysis/AnalyzerTests.java\nindex 8179be2efaa..417eb0f1a78 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/analysis/AnalyzerTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/analysis/AnalyzerTests.java\n@@ -15,7 +15,6 @@ import org.elasticsearch.action.fieldcaps.IndexFieldCapabilitiesBuilder;\n import org.elasticsearch.common.hash.MessageDigests;\n import org.elasticsearch.common.lucene.BytesRefs;\n import org.elasticsearch.common.settings.Settings;\n-import org.elasticsearch.core.Tuple;\n import org.elasticsearch.index.IndexMode;\n import org.elasticsearch.index.analysis.IndexAnalyzers;\n import org.elasticsearch.logging.LogManager;\n@@ -170,9 +169,6 @@ public class AnalyzerTests extends ESTestCase {\n \n     private static final int MAX_LIMIT = EsqlPlugin.QUERY_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY);\n     private static final int DEFAULT_LIMIT = EsqlPlugin.QUERY_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY);\n-    private static final int DEFAULT_TIMESERIES_LIMIT = EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(\n-        Settings.EMPTY\n-    );\n \n     public void testIndexResolution() {\n         EsIndex idx = new EsIndex(\"idx\", Map.of());\n@@ -2585,28 +2581,6 @@ public class AnalyzerTests extends ESTestCase {\n         assertThat(literal.value(), equalTo(List.of(1, 2, 3)));\n     }\n \n-    public void testTimeseriesDefaultLimitIs1B() {\n-        assumeTrue(\"timeseries requires snapshot builds\", EsqlCapabilities.Cap.METRICS_COMMAND.isEnabled());\n-        Analyzer analyzer = analyzer(tsdbIndexResolution());\n-        // Tuples of (query, isTimeseries)\n-        for (var queryExp : List.of(\n-            Tuple.tuple(\"TS test | STATS avg(rate(network.bytes_in))\", true),\n-            Tuple.tuple(\"TS test\", false),\n-            Tuple.tuple(\"TS test | STATS avg(rate(network.bytes_in)) BY tbucket=bucket(@timestamp, 1 minute)| sort tbucket\", true),\n-            Tuple.tuple(\"FROM test | STATS avg(to_long(network.bytes_in))\", false)\n-        )) {\n-            var query = queryExp.v1();\n-            var expectedLimit = queryExp.v2() ? DEFAULT_TIMESERIES_LIMIT : DEFAULT_LIMIT;\n-            var plan = analyze(query, analyzer);\n-            var limit = as(plan, Limit.class);\n-            try {\n-                assertThat(as(limit.limit(), Literal.class).value(), equalTo(expectedLimit));\n-            } catch (AssertionError e) {\n-                throw new AssertionError(\"Failed for query: \" + query, e);\n-            }\n-        }\n-    }\n-\n     public void testRateRequiresCounterTypes() {\n         assumeTrue(\"rate requires snapshot builds\", EsqlCapabilities.Cap.METRICS_COMMAND.isEnabled());\n         Analyzer analyzer = analyzer(tsdbIndexResolution());\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/AbstractConfigurationFunctionTestCase.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/AbstractConfigurationFunctionTestCase.java\nindex 9daf0c9b30c..d695be2ce0e 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/AbstractConfigurationFunctionTestCase.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/AbstractConfigurationFunctionTestCase.java\n@@ -55,9 +55,7 @@ public abstract class AbstractConfigurationFunctionTestCase extends AbstractScal\n             randomBoolean(),\n             Map.of(),\n             System.nanoTime(),\n-            randomBoolean(),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            randomBoolean()\n         );\n     }\n }\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DayNameTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DayNameTests.java\nindex 4f002f0a878..9d6630d0d9d 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DayNameTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/DayNameTests.java\n@@ -139,9 +139,7 @@ public class DayNameTests extends AbstractConfigurationFunctionTestCase {\n             false,\n             Map.of(),\n             System.nanoTime(),\n-            randomBoolean(),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            randomBoolean()\n         );\n     }\n }\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/MonthNameTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/MonthNameTests.java\nindex 62bf6dd5448..0b29c1d3053 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/MonthNameTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/date/MonthNameTests.java\n@@ -141,9 +141,7 @@ public class MonthNameTests extends AbstractConfigurationFunctionTestCase {\n             false,\n             Map.of(),\n             System.nanoTime(),\n-            randomBoolean(),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            randomBoolean()\n         );\n     }\n }\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToLowerTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToLowerTests.java\nindex 8838ea3c127..78d29ab7168 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToLowerTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToLowerTests.java\n@@ -71,9 +71,7 @@ public class ToLowerTests extends AbstractConfigurationFunctionTestCase {\n             false,\n             Map.of(),\n             System.nanoTime(),\n-            randomBoolean(),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            randomBoolean()\n         );\n     }\n \ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToUpperTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToUpperTests.java\nindex e48c9b351aa..4ee5147c358 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToUpperTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ToUpperTests.java\n@@ -71,9 +71,7 @@ public class ToUpperTests extends AbstractConfigurationFunctionTestCase {\n             false,\n             Map.of(),\n             System.nanoTime(),\n-            randomBoolean(),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(Settings.EMPTY),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(Settings.EMPTY)\n+            randomBoolean()\n         );\n     }\n \ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/EvalMapperTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/EvalMapperTests.java\nindex ca270d239d0..21bbedd0313 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/EvalMapperTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/EvalMapperTests.java\n@@ -79,9 +79,7 @@ public class EvalMapperTests extends ESTestCase {\n         false,\n         Map.of(),\n         System.nanoTime(),\n-        false,\n-        10000000,\n-        100000\n+        false\n     );\n \n     @ParametersFactory(argumentFormatting = \"%1$s\")\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/LocalExecutionPlannerTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/LocalExecutionPlannerTests.java\nindex 30d05ad09fc..83446d0f5fa 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/LocalExecutionPlannerTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/planner/LocalExecutionPlannerTests.java\n@@ -319,9 +319,7 @@ public class LocalExecutionPlannerTests extends MapperServiceTestCase {\n             false,\n             Map.of(),\n             System.nanoTime(),\n-            randomBoolean(),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_MAX_SIZE.getDefault(null),\n-            EsqlPlugin.QUERY_TIMESERIES_RESULT_TRUNCATION_DEFAULT_SIZE.getDefault(null)\n+            randomBoolean()\n         );\n     }\n \ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/session/ConfigurationSerializationTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/session/ConfigurationSerializationTests.java\nindex a14307c08e5..fd6e159c4e3 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/session/ConfigurationSerializationTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/session/ConfigurationSerializationTests.java\n@@ -48,8 +48,8 @@ public class ConfigurationSerializationTests extends AbstractWireSerializingTest\n         String username = in.username();\n         String clusterName = in.clusterName();\n         QueryPragmas pragmas = in.pragmas();\n-        int resultTruncationMaxSize = in.resultTruncationMaxSize(false);\n-        int resultTruncationDefaultSize = in.resultTruncationDefaultSize(false);\n+        int resultTruncationMaxSize = in.resultTruncationMaxSize();\n+        int resultTruncationDefaultSize = in.resultTruncationDefaultSize();\n         String query = in.query();\n         boolean profile = in.profile();\n         Map<String, Map<String, Column>> tables = in.tables();\n@@ -102,9 +102,7 @@ public class ConfigurationSerializationTests extends AbstractWireSerializingTest\n             profile,\n             tables,\n             System.nanoTime(),\n-            randomBoolean(),\n-            in.resultTruncationMaxSize(true),\n-            in.resultTruncationDefaultSize(true)\n+            randomBoolean()\n         );\n \n     }\ndiff --git a/x-pack/plugin/logsdb/qa/rolling-upgrade/src/javaRestTest/java/org/elasticsearch/upgrades/TextRollingUpgradeIT.java b/x-pack/plugin/logsdb/qa/rolling-upgrade/src/javaRestTest/java/org/elasticsearch/upgrades/TextRollingUpgradeIT.java\nindex b99c1a69fab..0f0995d4550 100644\n--- a/x-pack/plugin/logsdb/qa/rolling-upgrade/src/javaRestTest/java/org/elasticsearch/upgrades/TextRollingUpgradeIT.java\n+++ b/x-pack/plugin/logsdb/qa/rolling-upgrade/src/javaRestTest/java/org/elasticsearch/upgrades/TextRollingUpgradeIT.java\n@@ -81,7 +81,7 @@ public class TextRollingUpgradeIT extends AbstractRollingUpgradeWithSecurityTest\n         }\"\"\";\n \n     // when sorted, this message will appear at the top and hence can be used to validate query results\n-    private String smallestMessage;\n+    private static String smallestMessage;\n \n     public TextRollingUpgradeIT(@Name(\"upgradedNodes\") int upgradedNodes) {\n         super(upgradedNodes);"
}