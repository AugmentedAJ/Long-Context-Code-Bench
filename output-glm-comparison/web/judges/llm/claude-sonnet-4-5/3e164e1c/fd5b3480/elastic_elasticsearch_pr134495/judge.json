{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134495,
  "base_commit": "36181aa6f726d08d5c9c779f2d6e99b732de0ccc",
  "head_commit": "40e1e6b08cb3b21513b0c818e6c826642212e4a9",
  "judge_mode": "llm",
  "judge_model": "claude-sonnet-4-5",
  "scores": {
    "correctness": 0.8,
    "completeness": -0.3,
    "code_reuse": 0.7,
    "best_practices": 0.6,
    "unsolicited_docs": 1.0
  },
  "aggregate": 0.5599999999999999,
  "rationale": "The agent correctly consolidated repetitive assertion code into helper methods in AbstractCrossClusterTestCase and applied them across multiple test files (CrossClusterQueryIT, CrossClusterQueryUnavailableRemotesIT, CrossClusterAsyncQueryIT, CrossClusterAsyncQueryStopIT). The helper methods (assertExecutionInfoBasics, assertSuccessfulCluster, assertSkippedCluster, assertPartialCluster) are well-designed and reduce duplication effectively. However, the agent completely missed changes to two critical files: AbstractEnrichBasedCrossClusterTestCase.java and CrossClusterEnrichUnavailableClustersIT.java, which contain extensive assertion duplication that was consolidated in the ground truth. Additionally, the agent missed unrelated changes in the ground truth (TransportVersionReferencesPlugin.java and TransportVersionResourcesPlugin.java removing PrecommitTaskPlugin imports), though these appear to be unrelated to the CCS metadata test consolidation task. The helper methods differ slightly from ground truth: the agent uses assertClusterInfoSuccess/assertClusterInfoSkipped while ground truth uses assertClusterInfoSuccess/assertClusterInfoSkipped with slightly different signatures, and the agent introduces @Nullable annotations and more sophisticated overloading. The agent's approach is slightly more flexible but misses significant test files that needed refactoring.",
  "edit_run_id": "fd5b3480",
  "judge_run_id": "3e164e1c",
  "ground_truth_patch": "diff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReferencesPlugin.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReferencesPlugin.java\nindex b999c105f37..ca6189e22e3 100644\n--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReferencesPlugin.java\n+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReferencesPlugin.java\n@@ -10,8 +10,6 @@\n package org.elasticsearch.gradle.internal.transport;\n \n import org.elasticsearch.gradle.internal.ProjectSubscribeServicePlugin;\n-import org.elasticsearch.gradle.internal.conventions.precommit.PrecommitPlugin;\n-import org.elasticsearch.gradle.internal.conventions.precommit.PrecommitTaskPlugin;\n import org.elasticsearch.gradle.util.GradleUtils;\n import org.gradle.api.Plugin;\n import org.gradle.api.Project;\n@@ -25,7 +23,6 @@ public class TransportVersionReferencesPlugin implements Plugin<Project> {\n     @Override\n     public void apply(Project project) {\n         project.getPluginManager().apply(LifecycleBasePlugin.class);\n-        project.getPluginManager().apply(PrecommitTaskPlugin.class);\n \n         project.getPlugins()\n             .apply(ProjectSubscribeServicePlugin.class)\n@@ -53,6 +50,6 @@ public class TransportVersionReferencesPlugin implements Plugin<Project> {\n                 t.setDescription(\"Validates that all TransportVersion references used in the project have an associated definition file\");\n                 t.getReferencesFile().set(collectTask.get().getOutputFile());\n             });\n-        project.getTasks().named(PrecommitPlugin.PRECOMMIT_TASK_NAME).configure(t -> t.dependsOn(validateTask));\n+        project.getTasks().named(LifecycleBasePlugin.CHECK_TASK_NAME).configure(t -> t.dependsOn(validateTask));\n     }\n }\ndiff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionResourcesPlugin.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionResourcesPlugin.java\nindex 26ce3ea6a79..bca2dbaca2f 100644\n--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionResourcesPlugin.java\n+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionResourcesPlugin.java\n@@ -12,8 +12,6 @@ package org.elasticsearch.gradle.internal.transport;\n import org.elasticsearch.gradle.Version;\n import org.elasticsearch.gradle.internal.ProjectSubscribeServicePlugin;\n import org.elasticsearch.gradle.internal.conventions.VersionPropertiesPlugin;\n-import org.elasticsearch.gradle.internal.conventions.precommit.PrecommitPlugin;\n-import org.elasticsearch.gradle.internal.conventions.precommit.PrecommitTaskPlugin;\n import org.gradle.api.Plugin;\n import org.gradle.api.Project;\n import org.gradle.api.file.Directory;\n@@ -32,7 +30,6 @@ public class TransportVersionResourcesPlugin implements Plugin<Project> {\n     public void apply(Project project) {\n         project.getPluginManager().apply(LifecycleBasePlugin.class);\n         project.getPluginManager().apply(VersionPropertiesPlugin.class);\n-        project.getPluginManager().apply(PrecommitTaskPlugin.class);\n         var psService = project.getPlugins().apply(ProjectSubscribeServicePlugin.class).getService();\n \n         Properties versions = (Properties) project.getExtensions().getByName(VersionPropertiesPlugin.VERSIONS_EXT);\n@@ -70,7 +67,7 @@ public class TransportVersionResourcesPlugin implements Plugin<Project> {\n                 t.getShouldValidateDensity().convention(true);\n                 t.getShouldValidatePrimaryIdNotPatch().convention(true);\n             });\n-        project.getTasks().named(PrecommitPlugin.PRECOMMIT_TASK_NAME).configure(t -> t.dependsOn(validateTask));\n+        project.getTasks().named(LifecycleBasePlugin.CHECK_TASK_NAME).configure(t -> t.dependsOn(validateTask));\n \n         var generateManifestTask = project.getTasks()\n             .register(\"generateTransportVersionManifest\", GenerateTransportVersionManifestTask.class, t -> {\ndiff --git a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractCrossClusterTestCase.java b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractCrossClusterTestCase.java\nindex a724483ecee..97b89eec429 100644\n--- a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractCrossClusterTestCase.java\n+++ b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractCrossClusterTestCase.java\n@@ -141,6 +141,15 @@ public abstract class AbstractCrossClusterTestCase extends AbstractMultiClusters\n         assertThat(cluster.getFailures().size(), equalTo(0));\n     }\n \n+    protected void assertClusterInfoSkipped(EsqlExecutionInfo.Cluster cluster) {\n+        assertThat(cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n+        assertThat(cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n+        assertThat(cluster.getTotalShards(), equalTo(0));\n+        assertThat(cluster.getSuccessfulShards(), equalTo(0));\n+        assertThat(cluster.getSkippedShards(), equalTo(0));\n+        assertThat(cluster.getFailedShards(), equalTo(0));\n+    }\n+\n     protected static void assertClusterMetadataInResponse(EsqlQueryResponse resp, boolean responseExpectMeta, int numClusters) {\n         try {\n             final Map<String, Object> esqlResponseAsMap = XContentTestUtils.convertToMap(resp);\ndiff --git a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractEnrichBasedCrossClusterTestCase.java b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractEnrichBasedCrossClusterTestCase.java\nindex 7aa775d03f4..e3f630639c1 100644\n--- a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractEnrichBasedCrossClusterTestCase.java\n+++ b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/AbstractEnrichBasedCrossClusterTestCase.java\n@@ -50,6 +50,8 @@ import java.util.concurrent.TimeUnit;\n \n import static org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked;\n import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.equalTo;\n+import static org.hamcrest.Matchers.greaterThanOrEqualTo;\n \n public abstract class AbstractEnrichBasedCrossClusterTestCase extends AbstractMultiClustersTestCase {\n \n@@ -287,4 +289,23 @@ public abstract class AbstractEnrichBasedCrossClusterTestCase extends AbstractMu\n             return CrossClusterQueriesWithInvalidLicenseIT.LocalStateEnrich.EnrichTransportXPackInfoAction.class;\n         }\n     }\n+\n+    protected void assertClusterInfoSuccess(EsqlExecutionInfo.Cluster cluster, int numShards) {\n+        assertThat(cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n+        assertThat(cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n+        assertThat(cluster.getTotalShards(), equalTo(numShards));\n+        assertThat(cluster.getSuccessfulShards(), equalTo(numShards));\n+        assertThat(cluster.getSkippedShards(), equalTo(0));\n+        assertThat(cluster.getFailedShards(), equalTo(0));\n+        assertThat(cluster.getFailures().size(), equalTo(0));\n+    }\n+\n+    protected void assertClusterInfoSkipped(EsqlExecutionInfo.Cluster cluster) {\n+        assertThat(cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n+        assertThat(cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n+        assertThat(cluster.getTotalShards(), equalTo(0));\n+        assertThat(cluster.getSuccessfulShards(), equalTo(0));\n+        assertThat(cluster.getSkippedShards(), equalTo(0));\n+        assertThat(cluster.getFailedShards(), equalTo(0));\n+    }\n }\ndiff --git a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterEnrichUnavailableClustersIT.java b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterEnrichUnavailableClustersIT.java\nindex 6e6ae2968fc..b5b2a8a54d0 100644\n--- a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterEnrichUnavailableClustersIT.java\n+++ b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterEnrichUnavailableClustersIT.java\n@@ -78,18 +78,10 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2)));\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster1.getTotalShards(), equalTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster1);\n \n                     EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                    assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(cluster2.getTotalShards(), greaterThanOrEqualTo(0));\n-                    assertThat(cluster2.getSuccessfulShards(), equalTo(cluster2.getSuccessfulShards()));\n-                    assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster2.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(cluster2, cluster2.getSuccessfulShards());\n                 }\n             }\n \n@@ -116,18 +108,10 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2)));\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster1.getTotalShards(), equalTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster1);\n \n                     EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                    assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster2.getTotalShards(), equalTo(0));\n-                    assertThat(cluster2.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster2.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster2);\n                 }\n             }\n         } finally {\n@@ -160,18 +144,10 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2)));\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster1.getTotalShards(), equalTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster1);\n \n                     EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                    assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(cluster2.getTotalShards(), greaterThanOrEqualTo(0));\n-                    assertThat(cluster2.getSuccessfulShards(), equalTo(cluster2.getSuccessfulShards()));\n-                    assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster2.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(cluster2, cluster2.getSuccessfulShards());\n                 }\n             }\n \n@@ -218,25 +194,13 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertCCSExecutionInfoDetails(executionInfo);\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(cluster1.getTotalShards(), greaterThanOrEqualTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(cluster1.getSuccessfulShards()));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(cluster1, cluster1.getSuccessfulShards());\n \n                     EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                    assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster2.getTotalShards(), equalTo(0));\n-                    assertThat(cluster2.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster2.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster2);\n \n                     EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(RemoteClusterAware.LOCAL_CLUSTER_GROUP_KEY);\n-                    assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(localCluster.getTotalShards(), greaterThan(0));\n-                    assertThat(localCluster.getSuccessfulShards(), equalTo(localCluster.getTotalShards()));\n-                    assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                    assertThat(localCluster.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(localCluster, localCluster.getSuccessfulShards());\n                 }\n             }\n \n@@ -264,26 +228,13 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                         assertCCSExecutionInfoDetails(executionInfo);\n \n                         EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                        assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                        assertThat(cluster1.getTotalShards(), equalTo(0));\n-                        assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                        assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                        assertThat(cluster1.getFailedShards(), equalTo(0));\n-                        assertThat(cluster1.getTook().millis(), greaterThanOrEqualTo(0L));\n+                        assertClusterInfoSkipped(cluster1);\n \n                         EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                        assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                        assertThat(cluster2.getTotalShards(), equalTo(0));\n-                        assertThat(cluster2.getSuccessfulShards(), equalTo(0));\n-                        assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                        assertThat(cluster2.getFailedShards(), equalTo(0));\n+                        assertClusterInfoSkipped(cluster2);\n \n                         EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(RemoteClusterAware.LOCAL_CLUSTER_GROUP_KEY);\n-                        assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                        assertThat(localCluster.getTotalShards(), greaterThan(0));\n-                        assertThat(localCluster.getSuccessfulShards(), equalTo(localCluster.getTotalShards()));\n-                        assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                        assertThat(localCluster.getFailedShards(), equalTo(0));\n+                        assertClusterInfoSuccess(localCluster, localCluster.getSuccessfulShards());\n                     }\n                 }\n             }\n@@ -326,18 +277,10 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertCCSExecutionInfoDetails(executionInfo);\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster1.getTotalShards(), equalTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster1);\n \n                     EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(RemoteClusterAware.LOCAL_CLUSTER_GROUP_KEY);\n-                    assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(localCluster.getTotalShards(), greaterThan(0));\n-                    assertThat(localCluster.getSuccessfulShards(), equalTo(localCluster.getTotalShards()));\n-                    assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                    assertThat(localCluster.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(localCluster, localCluster.getSuccessfulShards());\n                 }\n             }\n         } finally {\n@@ -382,11 +325,7 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertCCSExecutionInfoDetails(executionInfo);\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster1.getTotalShards(), equalTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSkipped(cluster1);\n                 }\n             }\n         } finally {\n@@ -427,26 +366,13 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                     assertCCSExecutionInfoDetails(executionInfo);\n \n                     EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                    assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                    assertThat(cluster1.getTotalShards(), equalTo(0));\n-                    assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                    assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster1.getFailedShards(), equalTo(0));\n-                    assertThat(cluster1.getTook().millis(), greaterThanOrEqualTo(0L));\n+                    assertClusterInfoSkipped(cluster1);\n \n                     EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                    assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(cluster2.getTotalShards(), greaterThan(0));\n-                    assertThat(cluster2.getSuccessfulShards(), equalTo(cluster2.getSuccessfulShards()));\n-                    assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                    assertThat(cluster2.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(cluster2, cluster2.getSuccessfulShards());\n \n                     EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(RemoteClusterAware.LOCAL_CLUSTER_GROUP_KEY);\n-                    assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                    assertThat(localCluster.getTotalShards(), greaterThan(0));\n-                    assertThat(localCluster.getSuccessfulShards(), equalTo(localCluster.getTotalShards()));\n-                    assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                    assertThat(localCluster.getFailedShards(), equalTo(0));\n+                    assertClusterInfoSuccess(localCluster, localCluster.getSuccessfulShards());\n                 }\n             }\n \n@@ -478,26 +404,13 @@ public class CrossClusterEnrichUnavailableClustersIT extends AbstractEnrichBased\n                         assertCCSExecutionInfoDetails(executionInfo);\n \n                         EsqlExecutionInfo.Cluster cluster1 = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                        assertThat(cluster1.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                        assertThat(cluster1.getTotalShards(), equalTo(0));\n-                        assertThat(cluster1.getSuccessfulShards(), equalTo(0));\n-                        assertThat(cluster1.getSkippedShards(), equalTo(0));\n-                        assertThat(cluster1.getFailedShards(), equalTo(0));\n-                        assertThat(cluster1.getTook().millis(), greaterThanOrEqualTo(0L));\n+                        assertClusterInfoSkipped(cluster1);\n \n                         EsqlExecutionInfo.Cluster cluster2 = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                        assertThat(cluster2.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                        assertThat(cluster2.getTotalShards(), equalTo(0));\n-                        assertThat(cluster2.getSuccessfulShards(), equalTo(0));\n-                        assertThat(cluster2.getSkippedShards(), equalTo(0));\n-                        assertThat(cluster2.getFailedShards(), equalTo(0));\n+                        assertClusterInfoSkipped(cluster2);\n \n                         EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(RemoteClusterAware.LOCAL_CLUSTER_GROUP_KEY);\n-                        assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                        assertThat(localCluster.getTotalShards(), greaterThan(0));\n-                        assertThat(localCluster.getSuccessfulShards(), equalTo(localCluster.getTotalShards()));\n-                        assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                        assertThat(localCluster.getFailedShards(), equalTo(0));\n+                        assertClusterInfoSuccess(localCluster, localCluster.getSuccessfulShards());\n                     }\n                 }\n             }\ndiff --git a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryIT.java b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryIT.java\nindex b4a5c82f74b..43d9e957124 100644\n--- a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryIT.java\n+++ b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryIT.java\n@@ -63,6 +63,12 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n         return Map.of(REMOTE_CLUSTER_1, randomBoolean(), REMOTE_CLUSTER_2, randomBoolean());\n     }\n \n+    protected void assertClusterInfoSuccess(EsqlExecutionInfo.Cluster clusterInfo, int numShards, long overallTookMillis) {\n+        assertThat(clusterInfo.getIndexExpression(), equalTo(\"logs-*\"));\n+        assertThat(clusterInfo.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n+        super.assertClusterInfoSuccess(clusterInfo, numShards);\n+    }\n+\n     public void testSuccessfulPathways() throws Exception {\n         Map<String, Object> testClusterInfo = setupTwoClusters();\n         int localNumShards = (Integer) testClusterInfo.get(\"local.num_shards\");\n@@ -86,24 +92,10 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n             assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, LOCAL_CLUSTER)));\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-            assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(remoteCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(remoteCluster, remoteNumShards, overallTookMillis);\n \n             EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-            assertThat(localCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-            assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(localCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-            assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSkippedShards(), equalTo(0));\n-            assertThat(localCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n \n             // ensure that the _clusters metadata is present only if requested\n             assertClusterMetadataInResponse(resp, responseExpectMeta);\n@@ -125,24 +117,10 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n             assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, LOCAL_CLUSTER)));\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-            assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(remoteCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(remoteCluster, remoteNumShards, overallTookMillis);\n \n             EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-            assertThat(localCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-            assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(localCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-            assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSkippedShards(), equalTo(0));\n-            assertThat(localCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n \n             // ensure that the _clusters metadata is present only if requested\n             assertClusterMetadataInResponse(resp, responseExpectMeta);\n@@ -159,7 +137,8 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n             assertThat(e.getDetailedMessage(), containsString(\"no such index [nomatch]\"));\n \n             // MP TODO: am I able to fix this from the field-caps call? Yes, if we detect concrete vs. wildcard expressions in user query\n-            // TODO bug - this does not throw; uncomment this test once https://github.com/elastic/elasticsearch/issues/114495 is fixed\n+            // TODO bug - this does not throw; uncomment this test once this is fixed:\n+            // AwaitsFix https://github.com/elastic/elasticsearch/issues/114495\n             // String limit0 = q + \" | LIMIT 0\";\n             // VerificationException ve = expectThrows(VerificationException.class, () -> runQuery(limit0, false));\n             // assertThat(ve.getDetailedMessage(), containsString(\"No matching indices for [nomatch]\"));\n@@ -556,21 +535,11 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n             assertThat(remoteCluster.getIndexExpression(), equalTo(\"no_such_index*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(0));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(0));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(remoteCluster, 0);\n \n             EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n             assertThat(localCluster.getIndexExpression(), equalTo(\"logs-*,no_such_index*\"));\n-            assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSkippedShards(), equalTo(0));\n-            assertThat(localCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(localCluster, localNumShards);\n         } finally {\n             clearSkipUnavailable();\n         }\n@@ -600,7 +569,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n         }\n \n         // ensure cross-cluster searches have overall took time and correct per-cluster details in EsqlExecutionInfo\n-        try (EsqlQueryResponse resp = runQuery(\"FROM logs*,cluster-a:* | LIMIT 0\", requestIncludeMeta)) {\n+        try (EsqlQueryResponse resp = runQuery(\"FROM logs-*,cluster-a:* | LIMIT 0\", requestIncludeMeta)) {\n             EsqlExecutionInfo executionInfo = resp.getExecutionInfo();\n             assertNotNull(executionInfo);\n             assertThat(executionInfo.isCrossClusterSearch(), is(true));\n@@ -612,23 +581,11 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n             assertThat(remoteCluster.getIndexExpression(), equalTo(\"*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n             assertThat(remoteCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(0));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(0));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(remoteCluster, 0);\n \n             EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-            assertThat(localCluster.getIndexExpression(), equalTo(\"logs*\"));\n-            assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(localCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(0));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(0));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(localCluster, 0, overallTookMillis);\n         }\n     }\n \n@@ -643,7 +600,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n \n         try (\n             EsqlQueryResponse resp = runQuery(\n-                Strings.format(\"FROM logs*,%s:logs* METADATA _index | stats sum(v) by _index | sort _index\", REMOTE_CLUSTER_1),\n+                Strings.format(\"FROM logs-*,%s:logs-* METADATA _index | stats sum(v) by _index | sort _index\", REMOTE_CLUSTER_1),\n                 requestIncludeMeta\n             )\n         ) {\n@@ -655,26 +612,15 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n             assertNotNull(executionInfo);\n             assertThat(executionInfo.isCrossClusterSearch(), is(true));\n             assertThat(executionInfo.includeCCSMetadata(), equalTo(responseExpectMeta));\n-            assertThat(executionInfo.overallTook().millis(), greaterThanOrEqualTo(0L));\n+            long overallTookMillis = executionInfo.overallTook().millis();\n+            assertThat(overallTookMillis, greaterThanOrEqualTo(0L));\n             assertThat(executionInfo.isPartial(), equalTo(false));\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-            assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(remoteCluster, remoteNumShards, overallTookMillis);\n \n             EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-            assertThat(localCluster.getIndexExpression(), equalTo(\"logs*\"));\n-            assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSkippedShards(), equalTo(0));\n-            assertThat(localCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n         }\n     }\n \n@@ -726,7 +672,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n         final int remoteOnlyProfiles;\n         {\n             EsqlQueryRequest request = EsqlQueryRequest.syncEsqlQueryRequest();\n-            request.query(\"FROM c*:logs* | stats sum(v)\");\n+            request.query(\"FROM c*:logs-* | stats sum(v)\");\n             request.pragmas(pragmas);\n             request.profile(true);\n             try (EsqlQueryResponse resp = runQuery(request)) {\n@@ -744,13 +690,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n                 assertThat(executionInfo.overallTook().millis(), greaterThanOrEqualTo(0L));\n \n                 EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs*\"));\n-                assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remoteCluster.getTotalShards(), equalTo(remoteNumShards));\n-                assertThat(remoteCluster.getSuccessfulShards(), equalTo(remoteNumShards));\n-                assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-                assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSuccess(remoteCluster, remoteNumShards, executionInfo.overallTook().millis());\n \n                 EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n                 assertNull(localCluster);\n@@ -759,7 +699,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n         final int allProfiles;\n         {\n             EsqlQueryRequest request = EsqlQueryRequest.syncEsqlQueryRequest();\n-            request.query(\"FROM logs*,c*:logs* | stats total = sum(v)\");\n+            request.query(\"FROM logs-*,c*:logs-* | stats total = sum(v)\");\n             request.pragmas(pragmas);\n             request.profile(true);\n             try (EsqlQueryResponse resp = runQuery(request)) {\n@@ -774,25 +714,14 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n                 assertNotNull(executionInfo);\n                 assertThat(executionInfo.isCrossClusterSearch(), is(true));\n                 assertThat(executionInfo.includeCCSMetadata(), is(false));\n-                assertThat(executionInfo.overallTook().millis(), greaterThanOrEqualTo(0L));\n+                long overallTookMillis = executionInfo.overallTook().millis();\n+                assertThat(overallTookMillis, greaterThanOrEqualTo(0L));\n \n                 EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs*\"));\n-                assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remoteCluster.getTotalShards(), equalTo(remoteNumShards));\n-                assertThat(remoteCluster.getSuccessfulShards(), equalTo(remoteNumShards));\n-                assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-                assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSuccess(remoteCluster, remoteNumShards, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-                assertThat(localCluster.getIndexExpression(), equalTo(\"logs*\"));\n-                assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-                assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-                assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                assertThat(localCluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n             }\n         }\n         assertThat(allProfiles, equalTo(localOnlyProfiles + remoteOnlyProfiles - 1));\n@@ -804,7 +733,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n         int remoteNumShards = (Integer) testClusterInfo.get(\"remote1.num_shards\");\n \n         EsqlQueryRequest request = EsqlQueryRequest.syncEsqlQueryRequest();\n-        request.query(\"FROM logs*,c*:logs* | EVAL ip = to_ip(id) | STATS total = sum(v) by ip | LIMIT 10\");\n+        request.query(\"FROM logs-*,c*:logs-* | EVAL ip = to_ip(id) | STATS total = sum(v) by ip | LIMIT 10\");\n         InternalTestCluster cluster = cluster(LOCAL_CLUSTER);\n         String node = randomFrom(cluster.getNodeNames());\n         CountDownLatch latch = new CountDownLatch(1);\n@@ -824,25 +753,14 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n             assertNotNull(executionInfo);\n             assertThat(executionInfo.isCrossClusterSearch(), is(true));\n             assertThat(executionInfo.includeCCSMetadata(), is(false));\n-            assertThat(executionInfo.overallTook().millis(), greaterThanOrEqualTo(0L));\n+            long overallTookMillis = executionInfo.overallTook().millis();\n+            assertThat(overallTookMillis, greaterThanOrEqualTo(0L));\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-            assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(remoteNumShards));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(remoteCluster, remoteNumShards, overallTookMillis);\n \n             EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-            assertThat(localCluster.getIndexExpression(), equalTo(\"logs*\"));\n-            assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-            assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-            assertThat(localCluster.getSkippedShards(), equalTo(0));\n-            assertThat(localCluster.getFailedShards(), equalTo(0));\n+            assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n \n             latch.countDown();\n         }, e -> {\n@@ -867,13 +785,7 @@ public class CrossClusterQueryIT extends AbstractCrossClusterTestCase {\n \n             EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n             assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs-2*\"));\n-            assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-            assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-            assertThat(remoteCluster.getTotalShards(), equalTo(0));\n-            assertThat(remoteCluster.getSuccessfulShards(), equalTo(0));\n-            assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailedShards(), equalTo(0));\n-            assertThat(remoteCluster.getFailures(), hasSize(1));\n+            assertClusterInfoSkipped(remoteCluster);\n             assertThat(remoteCluster.getFailures().getFirst().reason(), containsString(\"Accessing failing field\"));\n         }\n     }\ndiff --git a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryUnavailableRemotesIT.java b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryUnavailableRemotesIT.java\nindex 667ac234610..00f91654c86 100644\n--- a/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryUnavailableRemotesIT.java\n+++ b/x-pack/plugin/esql/src/internalClusterTest/java/org/elasticsearch/xpack/esql/action/CrossClusterQueryUnavailableRemotesIT.java\n@@ -30,6 +30,18 @@ public class CrossClusterQueryUnavailableRemotesIT extends AbstractCrossClusterT\n         return false;\n     }\n \n+    protected void assertClusterInfoSkipped(EsqlExecutionInfo.Cluster clusterInfo, long overallTookMillis) {\n+        assertThat(clusterInfo.getIndexExpression(), equalTo(\"logs-*\"));\n+        assertThat(clusterInfo.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n+        super.assertClusterInfoSkipped(clusterInfo);\n+    }\n+\n+    protected void assertClusterInfoSuccess(EsqlExecutionInfo.Cluster clusterInfo, int numShards, long overallTookMillis) {\n+        assertThat(clusterInfo.getIndexExpression(), equalTo(\"logs-*\"));\n+        assertThat(clusterInfo.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n+        super.assertClusterInfoSuccess(clusterInfo, numShards);\n+    }\n+\n     public void testCCSAgainstDisconnectedRemoteWithSkipUnavailableTrue() throws Exception {\n         int numClusters = 3;\n         Map<String, Object> testClusterInfo = setupClusters(numClusters);\n@@ -62,34 +74,13 @@ public class CrossClusterQueryUnavailableRemotesIT extends AbstractCrossClusterT\n                 assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2, LOCAL_CLUSTER)));\n \n                 EsqlExecutionInfo.Cluster remote1Cluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remote1Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote1Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote1Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote1Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote1Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote1Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remote1Cluster, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster remote2Cluster = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                assertThat(remote2Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote2Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                assertThat(remote2Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote2Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote2Cluster.getTotalShards(), equalTo(remote2NumShards));\n-                assertThat(remote2Cluster.getSuccessfulShards(), equalTo(remote2NumShards));\n-                assertThat(remote2Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote2Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSuccess(remote2Cluster, remote2NumShards, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-                assertThat(localCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(localCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-                assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-                assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                assertThat(localCluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n \n                 // ensure that the _clusters metadata is present only if requested\n                 assertClusterMetadataInResponse(resp, responseExpectMeta, numClusters);\n@@ -115,24 +106,12 @@ public class CrossClusterQueryUnavailableRemotesIT extends AbstractCrossClusterT\n                 assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2, LOCAL_CLUSTER)));\n \n                 EsqlExecutionInfo.Cluster remote1Cluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remote1Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote1Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote1Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote1Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote1Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote1Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remote1Cluster, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster remote2Cluster = executionInfo.getCluster(REMOTE_CLUSTER_2);\n+                assertClusterInfoSkipped(remote1Cluster);\n                 assertThat(remote2Cluster.getIndexExpression(), equalTo(\"nomatch*\"));\n-                assertThat(remote2Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote2Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n                 assertThat(remote2Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote2Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote2Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote2Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote2Cluster.getFailedShards(), equalTo(0));\n \n                 EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n                 assertThat(localCluster.getIndexExpression(), equalTo(\"nomatch*\"));\n@@ -168,34 +147,13 @@ public class CrossClusterQueryUnavailableRemotesIT extends AbstractCrossClusterT\n                 assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2, LOCAL_CLUSTER)));\n \n                 EsqlExecutionInfo.Cluster remote1Cluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remote1Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote1Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote1Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote1Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote1Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote1Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remote1Cluster, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster remote2Cluster = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                assertThat(remote2Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote2Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote2Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote2Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote2Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote2Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote2Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote2Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remote2Cluster, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster localCluster = executionInfo.getCluster(LOCAL_CLUSTER);\n-                assertThat(localCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(localCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SUCCESSFUL));\n-                assertThat(localCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(localCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(localCluster.getTotalShards(), equalTo(localNumShards));\n-                assertThat(localCluster.getSuccessfulShards(), equalTo(localNumShards));\n-                assertThat(localCluster.getSkippedShards(), equalTo(0));\n-                assertThat(localCluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSuccess(localCluster, localNumShards, overallTookMillis);\n \n                 // ensure that the _clusters metadata is present only if requested\n                 assertClusterMetadataInResponse(resp, responseExpectMeta, numClusters);\n@@ -241,14 +199,7 @@ public class CrossClusterQueryUnavailableRemotesIT extends AbstractCrossClusterT\n                 assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1)));\n \n                 EsqlExecutionInfo.Cluster remoteCluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remoteCluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remoteCluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remoteCluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remoteCluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remoteCluster.getTotalShards(), equalTo(0));\n-                assertThat(remoteCluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remoteCluster.getSkippedShards(), equalTo(0));\n-                assertThat(remoteCluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remoteCluster, overallTookMillis);\n \n                 // ensure that the _clusters metadata is present only if requested\n                 assertClusterMetadataInResponse(resp, responseExpectMeta, 1);\n@@ -284,24 +235,10 @@ public class CrossClusterQueryUnavailableRemotesIT extends AbstractCrossClusterT\n                 assertThat(executionInfo.clusterAliases(), equalTo(Set.of(REMOTE_CLUSTER_1, REMOTE_CLUSTER_2)));\n \n                 EsqlExecutionInfo.Cluster remote1Cluster = executionInfo.getCluster(REMOTE_CLUSTER_1);\n-                assertThat(remote1Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote1Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote1Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote1Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote1Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote1Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote1Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remote1Cluster, overallTookMillis);\n \n                 EsqlExecutionInfo.Cluster remote2Cluster = executionInfo.getCluster(REMOTE_CLUSTER_2);\n-                assertThat(remote2Cluster.getIndexExpression(), equalTo(\"logs-*\"));\n-                assertThat(remote2Cluster.getStatus(), equalTo(EsqlExecutionInfo.Cluster.Status.SKIPPED));\n-                assertThat(remote2Cluster.getTook().millis(), greaterThanOrEqualTo(0L));\n-                assertThat(remote2Cluster.getTook().millis(), lessThanOrEqualTo(overallTookMillis));\n-                assertThat(remote2Cluster.getTotalShards(), equalTo(0));\n-                assertThat(remote2Cluster.getSuccessfulShards(), equalTo(0));\n-                assertThat(remote2Cluster.getSkippedShards(), equalTo(0));\n-                assertThat(remote2Cluster.getFailedShards(), equalTo(0));\n+                assertClusterInfoSkipped(remote2Cluster, overallTookMillis);\n \n                 // ensure that the _clusters metadata is present only if requested\n                 assertClusterMetadataInResponse(resp, responseExpectMeta, 2);"
}