{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 4583,
  "base_commit": "c12427d047b7cf9fd1ac9acc611bc2985ad12c40",
  "runner": "codex",
  "model": "gpt-5.1-codex",
  "timeout_s": 10800,
  "status": "success",
  "elapsed_ms": 128337,
  "patch_unified": "diff --git a/src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java b/src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java\nindex 5dfeeba..d2dc019 100644\n--- a/src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java\n+++ b/src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java\n@@ -275,17 +275,20 @@ public class AllFieldMapper extends AbstractFieldMapper<Void> implements Interna\n         if (includeDefaults || fieldType.stored() != Defaults.FIELD_TYPE.stored()) {\n             builder.field(\"store\", fieldType.stored());\n         }\n-        if (includeDefaults || fieldType.storeTermVectors() != Defaults.FIELD_TYPE.storeTermVectors()) {\n-            builder.field(\"store_term_vector\", fieldType.storeTermVectors());\n+        boolean storeTermVectors = fieldType.storeTermVectors();\n+        if (includeDefaults || storeTermVectors != Defaults.FIELD_TYPE.storeTermVectors()) {\n+            builder.field(\"store_term_vectors\", storeTermVectors);\n         }\n-        if (includeDefaults || fieldType.storeTermVectorOffsets() != Defaults.FIELD_TYPE.storeTermVectorOffsets()) {\n-            builder.field(\"store_term_vector_offsets\", fieldType.storeTermVectorOffsets());\n-        }\n-        if (includeDefaults || fieldType.storeTermVectorPositions() != Defaults.FIELD_TYPE.storeTermVectorPositions()) {\n-            builder.field(\"store_term_vector_positions\", fieldType.storeTermVectorPositions());\n-        }\n-        if (includeDefaults || fieldType.storeTermVectorPayloads() != Defaults.FIELD_TYPE.storeTermVectorPayloads()) {\n-            builder.field(\"store_term_vector_payloads\", fieldType.storeTermVectorPayloads());\n+        if (storeTermVectors) {\n+            if (includeDefaults || fieldType.storeTermVectorOffsets() != Defaults.FIELD_TYPE.storeTermVectorOffsets()) {\n+                builder.field(\"store_term_vector_offsets\", fieldType.storeTermVectorOffsets());\n+            }\n+            if (includeDefaults || fieldType.storeTermVectorPositions() != Defaults.FIELD_TYPE.storeTermVectorPositions()) {\n+                builder.field(\"store_term_vector_positions\", fieldType.storeTermVectorPositions());\n+            }\n+            if (includeDefaults || fieldType.storeTermVectorPayloads() != Defaults.FIELD_TYPE.storeTermVectorPayloads()) {\n+                builder.field(\"store_term_vector_payloads\", fieldType.storeTermVectorPayloads());\n+            }\n         }\n         if (includeDefaults || fieldType.omitNorms() != Defaults.FIELD_TYPE.omitNorms()) {\n             builder.field(\"omit_norms\", fieldType.omitNorms());",
  "logs_path": "codex/gpt-5.1-codex/fd5b3480/elastic_elasticsearch_pr4583/logs.jsonl",
  "errors": [],
  "edit_run_id": "fd5b3480",
  "test_label": "v1-agent-comparison"
}