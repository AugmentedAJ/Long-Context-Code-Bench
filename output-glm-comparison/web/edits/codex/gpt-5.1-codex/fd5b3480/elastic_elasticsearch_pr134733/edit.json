{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134733,
  "base_commit": "d662314b371d340e211d70e3b61cbe8b0bd42330",
  "runner": "codex",
  "model": "gpt-5.1-codex",
  "timeout_s": 10800,
  "status": "success",
  "elapsed_ms": 368036,
  "patch_unified": "diff --git a/build-tools-internal/src/integTest/groovy/org/elasticsearch/gradle/internal/transport/TransportVersionValidationFuncTest.groovy b/build-tools-internal/src/integTest/groovy/org/elasticsearch/gradle/internal/transport/TransportVersionValidationFuncTest.groovy\nindex 36be4c4d..5e10e553 100644\n--- a/build-tools-internal/src/integTest/groovy/org/elasticsearch/gradle/internal/transport/TransportVersionValidationFuncTest.groovy\n+++ b/build-tools-internal/src/integTest/groovy/org/elasticsearch/gradle/internal/transport/TransportVersionValidationFuncTest.groovy\n@@ -252,4 +252,29 @@ class TransportVersionValidationFuncTest extends AbstractTransportVersionFuncTes\n             \"[myserver/src/main/resources/transport/definitions/referable/initial_10.0.0.csv] \" +\n             \"has the highest transport version id [10000000] but is not present in any upper bounds files\")\n     }\n+\n+    def \"definition files support comments\"() {\n+        given:\n+        def definitionFile = file(\"myserver/src/main/resources/transport/definitions/referable/existing_92.csv\")\n+        definitionFile.text = \"\"\"# comment about definitions\n+8123000,8012001 # inline note\n+# trailing comment line\n+\"\"\".stripIndent()\n+        when:\n+        def result = gradleRunner(\":myserver:validateTransportVersionResources\").build()\n+        then:\n+        result.task(\":myserver:validateTransportVersionResources\").outcome == TaskOutcome.SUCCESS\n+    }\n+\n+    def \"upper bound files support comments\"() {\n+        given:\n+        def upperBoundFile = file(\"myserver/src/main/resources/transport/upper_bounds/9.2.csv\")\n+        upperBoundFile.text = \"\"\"# comment about upper bound\n+existing_92,8123000 # inline note\n+\"\"\".stripIndent()\n+        when:\n+        def result = gradleRunner(\":myserver:validateTransportVersionResources\").build()\n+        then:\n+        result.task(\":myserver:validateTransportVersionResources\").outcome == TaskOutcome.SUCCESS\n+    }\n }\ndiff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java\nindex 65f4caeb..51700071 100644\n--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java\n+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java\n@@ -21,15 +21,30 @@ record TransportVersionDefinition(String name, List<TransportVersionId> ids) {\n         List<TransportVersionId> ids = new ArrayList<>();\n \n         if (contents.isEmpty() == false) {\n-            for (String rawId : contents.split(\",\")) {\n-                try {\n-                    ids.add(TransportVersionId.fromString(rawId));\n-                } catch (NumberFormatException e) {\n-                    throw new IllegalStateException(\"Failed to parse id \" + rawId + \" in \" + file, e);\n+            for (String line : contents.split(\"\\\\R\")) {\n+                String sanitizedLine = stripComment(line).trim();\n+                if (sanitizedLine.isEmpty()) {\n+                    continue;\n+                }\n+                for (String rawId : sanitizedLine.split(\",\")) {\n+                    String trimmedId = rawId.trim();\n+                    if (trimmedId.isEmpty()) {\n+                        continue;\n+                    }\n+                    try {\n+                        ids.add(TransportVersionId.fromString(trimmedId));\n+                    } catch (NumberFormatException e) {\n+                        throw new IllegalStateException(\"Failed to parse id \" + trimmedId + \" in \" + file, e);\n+                    }\n                 }\n             }\n         }\n \n         return new TransportVersionDefinition(name, ids);\n     }\n+\n+    private static String stripComment(String line) {\n+        int commentIndex = line.indexOf('#');\n+        return commentIndex >= 0 ? line.substring(0, commentIndex) : line;\n+    }\n }\ndiff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java\nindex d3b91464..176a5d13 100644\n--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java\n+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java\n@@ -10,6 +10,7 @@\n package org.elasticsearch.gradle.internal.transport;\n \n import java.nio.file.Path;\n+import java.util.List;\n \n /**\n  * An object to represent the loaded version of a transport version upper bound.\n@@ -23,11 +24,26 @@ record TransportVersionUpperBound(String name, String definitionName, TransportV\n         int slashIndex = filename.lastIndexOf('/');\n         String branch = filename.substring(slashIndex == -1 ? 0 : (slashIndex + 1), filename.length() - 4);\n \n-        String[] parts = contents.split(\",\");\n+        List<String> valueLines = contents.lines()\n+            .map(TransportVersionUpperBound::stripComment)\n+            .map(String::trim)\n+            .filter(line -> line.isEmpty() == false)\n+            .toList();\n+\n+        if (valueLines.size() != 1) {\n+            throw new IllegalStateException(\"Invalid transport version upper bound file [\" + file + \"]: \" + contents);\n+        }\n+\n+        String[] parts = valueLines.get(0).split(\",\");\n         if (parts.length != 2) {\n             throw new IllegalStateException(\"Invalid transport version upper bound file [\" + file + \"]: \" + contents);\n         }\n \n         return new TransportVersionUpperBound(branch, parts[0], TransportVersionId.fromString(parts[1]));\n     }\n+\n+    private static String stripComment(String line) {\n+        int commentIndex = line.indexOf('#');\n+        return commentIndex >= 0 ? line.substring(0, commentIndex) : line;\n+    }\n }",
  "logs_path": "codex/gpt-5.1-codex/93548e0a/elastic_elasticsearch_pr134733/logs.jsonl",
  "errors": [],
  "edit_run_id": "fd5b3480",
  "test_label": "v1-agent-comparison"
}