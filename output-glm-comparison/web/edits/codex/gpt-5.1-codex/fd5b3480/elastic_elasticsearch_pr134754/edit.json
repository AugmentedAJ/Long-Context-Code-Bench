{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134754,
  "base_commit": "d70e2bd0d84d610b8ad101288141196261ad7628",
  "runner": "codex",
  "model": "gpt-5.1-codex",
  "timeout_s": 10800,
  "status": "success",
  "elapsed_ms": 47853,
  "patch_unified": "diff --git a/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java b/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java\nindex 3bc2fde3..20380b8b 100644\n--- a/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java\n+++ b/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java\n@@ -67,7 +67,7 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n             String asyncId = searchAsyncAndStoreId(asyncSearchRequest, \"n-2_id\");\n             ensureGreen(asyncSearchIndex);\n \n-            assertAsyncSearchHitCount(asyncId, numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(asyncId, numDocs));\n             assertBusy(() -> assertDocCountNoWarnings(client(), asyncSearchIndex, 1));\n             assertThat(indexVersion(asyncSearchIndex, true), equalTo(VERSION_MINUS_2));\n             return;\n@@ -76,7 +76,7 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n         if (isFullyUpgradedTo(VERSION_MINUS_1)) {\n             // check .async-search index is readable\n             assertThat(indexVersion(asyncSearchIndex, true), equalTo(VERSION_MINUS_2));\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs));\n \n             // migrate system indices\n             Request migrateRequest = new Request(\"POST\", \"/_migration/system_features\");\n@@ -99,11 +99,11 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n             }, 30, TimeUnit.SECONDS);\n \n             // check search results from n-2 search are still readable\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs));\n \n             // perform new async search and check its readable\n             String asyncId = searchAsyncAndStoreId(asyncSearchRequest, \"n-1_id\");\n-            assertAsyncSearchHitCount(asyncId, numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(asyncId, numDocs));\n             assertBusy(() -> assertDocCountNoWarnings(client(), asyncSearchIndex, 2));\n \n             // in order to move to current version we need write block for n-2 index\n@@ -112,12 +112,12 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n \n         if (isFullyUpgradedTo(VERSION_CURRENT)) {\n             assertThat(indexVersion(index, true), equalTo(VERSION_MINUS_2));\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs);\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-1_id\"), numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs));\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-1_id\"), numDocs));\n \n             // check system index is still writeable\n             String asyncId = searchAsyncAndStoreId(asyncSearchRequest, \"n_id\");\n-            assertAsyncSearchHitCount(asyncId, numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(asyncId, numDocs));\n             assertBusy(() -> assertDocCountNoWarnings(client(), asyncSearchIndex, 3));\n         }\n \n@@ -134,7 +134,12 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n     private static void assertAsyncSearchHitCount(String asyncId, int numDocs) throws IOException {\n         var asyncGet = new Request(\"GET\", \"/_async_search/\" + asyncId);\n         ObjectPath resp = ObjectPath.createFromResponse(client().performRequest(asyncGet));\n-        assertEquals(Integer.valueOf(numDocs), resp.evaluate(\"response.hits.total.value\"));\n+        Object actualHits = resp.evaluate(\"response.hits.total.value\");\n+        assertEquals(\n+            \"Async search [\" + asyncId + \"] expected [\" + numDocs + \"] hits but was [\" + actualHits + \"]\",\n+            Integer.valueOf(numDocs),\n+            actualHits\n+        );\n     }\n \n     /**",
  "logs_path": "codex/gpt-5.1-codex/1c2e04d5/elastic_elasticsearch_pr134754/logs.jsonl",
  "errors": [],
  "edit_run_id": "fd5b3480",
  "test_label": "v1-agent-comparison"
}