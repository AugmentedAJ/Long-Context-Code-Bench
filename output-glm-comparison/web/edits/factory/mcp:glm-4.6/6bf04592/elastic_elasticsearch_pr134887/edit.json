{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134887,
  "base_commit": "987e7af02b69cd4bb25755aa47e91a6a4bbebf1d",
  "runner": "factory",
  "model": "mcp:glm-4.6",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 481357,
  "patch_unified": "diff --git a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java\nindex 1d9fd9cb..ea9a90e3 100644\n--- a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java\n+++ b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java\n@@ -301,9 +301,17 @@ public class MatchOnlyTextFieldMapper extends FieldMapper {\n                 String name = storedFieldNameForSyntheticSource();\n                 return storedFieldFetcher(name);\n             }\n+            // Extract only sourcePaths from searchExecutionContext to avoid memory leaks\n+            // This prevents the lambda from capturing the entire SearchExecutionContext\n+            final Set<String> sourcePaths = searchExecutionContext.sourcePath(name());\n+            // The lookup() might create a SourceProvider that holds a reference to the context\n+            // We capture it here to avoid doing it in the inner lambda\n+            final SourceProvider sourceProvider = searchExecutionContext.lookup();\n+            \n             return context -> {\n-                ValueFetcher valueFetcher = valueFetcher(searchExecutionContext, null);\n-                SourceProvider sourceProvider = searchExecutionContext.lookup();\n+                // Create fetchers using only the pre-extracted sourcePaths\n+                // This avoids holding a reference to the SearchExecutionContext\n+                ValueFetcher valueFetcher = SourceValueFetcher.toString(sourcePaths);\n                 valueFetcher.setNextReader(context);\n                 return docID -> {\n                     try {",
  "logs_path": "factory/mcp:glm-4.6/6bf04592/elastic_elasticsearch_pr134887/logs.jsonl",
  "errors": [],
  "edit_run_id": "6bf04592",
  "test_label": "v1-mcp"
}