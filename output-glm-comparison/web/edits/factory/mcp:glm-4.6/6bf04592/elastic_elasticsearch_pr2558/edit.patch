diff --git a/pom.xml b/pom.xml
index a3053ca..884719f 100644
--- a/pom.xml
+++ b/pom.xml
@@ -297,8 +297,8 @@
                 <artifactId>maven-compiler-plugin</artifactId>
                 <version>2.3.2</version>
                 <configuration>
-                    <source>1.6</source>
-                    <target>1.6</target>
+                    <source>1.7</source>
+                    <target>1.7</target>
                 </configuration>
             </plugin>
             <plugin>
diff --git a/src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/ShardsAllocatorModule.java b/src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/ShardsAllocatorModule.java
index a3d8da2..3834918 100644
--- a/src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/ShardsAllocatorModule.java
+++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/ShardsAllocatorModule.java
@@ -27,6 +27,8 @@ import org.elasticsearch.gateway.none.NoneGatewayAllocator;
  */
 public class ShardsAllocatorModule extends AbstractModule {
 
+    public static final String SHARDS_ALLOCATOR_TYPE_SETTING = "cluster.routing.allocation.type";
+
     private Settings settings;
 
     private Class<? extends ShardsAllocator> shardsAllocator;
@@ -48,6 +50,29 @@ public class ShardsAllocatorModule extends AbstractModule {
     @Override
     protected void configure() {
         bind(GatewayAllocator.class).to(gatewayAllocator).asEagerSingleton();
-        bind(ShardsAllocator.class).to(shardsAllocator == null ? BalancedShardsAllocator.class : shardsAllocator).asEagerSingleton();
+        
+        // If a specific allocator was set via setShardsAllocator, use it
+        // Otherwise, check settings for the allocator type
+        // Default to BalancedShardsAllocator if not specified
+        Class<? extends ShardsAllocator> allocatorClass = shardsAllocator;
+        if (allocatorClass == null) {
+            String allocatorType = settings.get(SHARDS_ALLOCATOR_TYPE_SETTING, "balanced");
+            if ("even_shard_count".equalsIgnoreCase(allocatorType)) {
+                allocatorClass = EvenShardsCountAllocator.class;
+            } else if ("balanced".equalsIgnoreCase(allocatorType)) {
+                allocatorClass = BalancedShardsAllocator.class;
+            } else {
+                // Try to load the class by name
+                try {
+                    allocatorClass = (Class<? extends ShardsAllocator>) Class.forName(allocatorType);
+                } catch (ClassNotFoundException e) {
+                    throw new IllegalArgumentException("Unknown shards allocator type [" + allocatorType + "]", e);
+                } catch (ClassCastException e) {
+                    throw new IllegalArgumentException("Shards allocator type [" + allocatorType + "] is not a valid ShardsAllocator implementation", e);
+                }
+            }
+        }
+        
+        bind(ShardsAllocator.class).to(allocatorClass).asEagerSingleton();
     }
 }