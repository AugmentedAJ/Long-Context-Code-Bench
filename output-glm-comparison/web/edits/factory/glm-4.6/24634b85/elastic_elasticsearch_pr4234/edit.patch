diff --git a/src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java b/src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java
index 3b5376a..c33883c 100644
--- a/src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java
+++ b/src/main/java/org/elasticsearch/cluster/routing/operation/plain/PlainOperationRouting.java
@@ -204,7 +204,12 @@ public class PlainOperationRouting extends AbstractComponent implements Operatio
                 }
             }
             if (preference.startsWith("_prefer_node:")) {
-                return indexShard.preferNodeActiveInitializingShardsIt(preference.substring("_prefer_node:".length()));
+                String nodeId = preference.substring("_prefer_node:".length());
+                // Validate that the node exists in the cluster
+                if (nodes.get(nodeId) == null) {
+                    throw new ElasticSearchIllegalArgumentException("no node found for [_prefer_node] preference, with id [" + nodeId + "]");
+                }
+                return indexShard.preferNodeActiveInitializingShardsIt(nodeId);
             }
             if ("_local".equals(preference)) {
                 return indexShard.preferNodeActiveInitializingShardsIt(localNodeId);
@@ -219,7 +224,12 @@ public class PlainOperationRouting extends AbstractComponent implements Operatio
                 return indexShard.onlyNodeActiveInitializingShardsIt(localNodeId);
             }
             if (preference.startsWith("_only_node:")) {
-                return indexShard.onlyNodeActiveInitializingShardsIt(preference.substring("_only_node:".length()));
+                String nodeId = preference.substring("_only_node:".length());
+                // Validate that the node exists in the cluster
+                if (nodes.get(nodeId) == null) {
+                    throw new ElasticSearchIllegalArgumentException("no node found for [_only_node] preference, with id [" + nodeId + "]");
+                }
+                return indexShard.onlyNodeActiveInitializingShardsIt(nodeId);
             }
         }
         // if not, then use it as the index