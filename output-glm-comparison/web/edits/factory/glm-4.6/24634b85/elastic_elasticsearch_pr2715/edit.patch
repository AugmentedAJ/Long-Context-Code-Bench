diff --git a/src/main/java/org/elasticsearch/index/mapper/internal/IdFieldMapper.java b/src/main/java/org/elasticsearch/index/mapper/internal/IdFieldMapper.java
index 3391561..422b50d 100644
--- a/src/main/java/org/elasticsearch/index/mapper/internal/IdFieldMapper.java
+++ b/src/main/java/org/elasticsearch/index/mapper/internal/IdFieldMapper.java
@@ -295,24 +295,36 @@ public class IdFieldMapper extends AbstractFieldMapper<String> implements Intern
     @Override
     protected Field parseCreateField(ParseContext context) throws IOException {
         XContentParser parser = context.parser();
-        if (parser.currentName() != null && parser.currentName().equals(Defaults.NAME) && parser.currentToken().isValue()) {
-            // we are in the parse Phase
-            String id = parser.text();
-            if (context.id() != null && !context.id().equals(id)) {
-                throw new MapperParsingException("Provided id [" + context.id() + "] does not match the content one [" + id + "]");
+        if (parser.currentName() != null && parser.currentName().equals(Defaults.NAME)) {
+            XContentParser.Token token = parser.currentToken();
+            
+            // Check if the id token is an array or object
+            if (token == XContentParser.Token.START_ARRAY) {
+                throw new MapperParsingException("Id field cannot be an array, found [" + token + "]");
             }
-            context.id(id);
-            if (!fieldType.indexed() && !fieldType.stored()) {
-                return null;
+            if (token == XContentParser.Token.START_OBJECT) {
+                throw new MapperParsingException("Id field cannot be an object, found [" + token + "]");
             }
-            return new Field(names.indexName(), context.id(), fieldType);
-        } else {
-            // we are in the pre/post parse phase
-            if (!fieldType.indexed() && !fieldType.stored()) {
-                return null;
+            
+            if (token.isValue()) {
+                // we are in the parse Phase
+                String id = parser.text();
+                if (context.id() != null && !context.id().equals(id)) {
+                    throw new MapperParsingException("Provided id [" + context.id() + "] does not match the content one [" + id + "]");
+                }
+                context.id(id);
+                if (!fieldType.indexed() && !fieldType.stored()) {
+                    return null;
+                }
+                return new Field(names.indexName(), context.id(), fieldType);
             }
-            return new Field(names.indexName(), context.id(), fieldType);
         }
+        
+        // we are in the pre/post parse phase
+        if (!fieldType.indexed() && !fieldType.stored()) {
+            return null;
+        }
+        return new Field(names.indexName(), context.id(), fieldType);
     }
 
     @Override
diff --git a/src/test/java/org/elasticsearch/test/unit/index/mapper/id/IdMappingTests.java b/src/test/java/org/elasticsearch/test/unit/index/mapper/id/IdMappingTests.java
index 34e1846..a7ef8ec 100644
--- a/src/test/java/org/elasticsearch/test/unit/index/mapper/id/IdMappingTests.java
+++ b/src/test/java/org/elasticsearch/test/unit/index/mapper/id/IdMappingTests.java
@@ -115,4 +115,42 @@ public class IdMappingTests {
 
         assertThat(serialized_id_mapping, equalTo(expected_id_mapping));
     }
+
+    @Test
+    public void testIdAsArrayShouldThrowException() throws Exception {
+        String mapping = XContentFactory.jsonBuilder().startObject().startObject("type")
+                .endObject().endObject().string();
+        DocumentMapper docMapper = MapperTests.newParser().parse(mapping);
+
+        try {
+            docMapper.parse("type", null, XContentFactory.jsonBuilder()
+                    .startObject()
+                    .field("_id", new String[]{"1", "2"})
+                    .endObject()
+                    .bytes());
+            assert false : "Expected MapperParsingException for array id";
+        } catch (MapperParsingException e) {
+            assertThat(e.getMessage(), containsString("Id field cannot be an array"));
+        }
+    }
+
+    @Test
+    public void testIdAsObjectShouldThrowException() throws Exception {
+        String mapping = XContentFactory.jsonBuilder().startObject().startObject("type")
+                .endObject().endObject().string();
+        DocumentMapper docMapper = MapperTests.newParser().parse(mapping);
+
+        try {
+            docMapper.parse("type", null, XContentFactory.jsonBuilder()
+                    .startObject()
+                    .startObject("_id")
+                    .field("nested", "value")
+                    .endObject()
+                    .endObject()
+                    .bytes());
+            assert false : "Expected MapperParsingException for object id";
+        } catch (MapperParsingException e) {
+            assertThat(e.getMessage(), containsString("Id field cannot be an object"));
+        }
+    }
 }