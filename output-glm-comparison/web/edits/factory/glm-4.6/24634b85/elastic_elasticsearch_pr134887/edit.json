{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134887,
  "base_commit": "987e7af02b69cd4bb25755aa47e91a6a4bbebf1d",
  "runner": "factory",
  "model": "glm-4.6",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 265270,
  "patch_unified": "diff --git a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java\nindex 1d9fd9cb..3a70d27d 100644\n--- a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java\n+++ b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/MatchOnlyTextFieldMapper.java\n@@ -301,9 +301,11 @@ public class MatchOnlyTextFieldMapper extends FieldMapper {\n                 String name = storedFieldNameForSyntheticSource();\n                 return storedFieldFetcher(name);\n             }\n+            // Extract needed objects from SearchExecutionContext to avoid memory leak\n+            ValueFetcher valueFetcher = valueFetcher(searchExecutionContext, null);\n+            // Create a SourceProvider using the context's createSourceProvider method to avoid capturing the context itself\n+            SourceProvider sourceProvider = searchExecutionContext.createSourceProvider(null);\n             return context -> {\n-                ValueFetcher valueFetcher = valueFetcher(searchExecutionContext, null);\n-                SourceProvider sourceProvider = searchExecutionContext.lookup();\n                 valueFetcher.setNextReader(context);\n                 return docID -> {\n                     try {\ndiff --git a/x-pack/plugin/logsdb/src/main/java/org/elasticsearch/xpack/logsdb/patternedtext/PatternedTextFieldType.java b/x-pack/plugin/logsdb/src/main/java/org/elasticsearch/xpack/logsdb/patternedtext/PatternedTextFieldType.java\nindex 35f10475..94bd921d 100644\n--- a/x-pack/plugin/logsdb/src/main/java/org/elasticsearch/xpack/logsdb/patternedtext/PatternedTextFieldType.java\n+++ b/x-pack/plugin/logsdb/src/main/java/org/elasticsearch/xpack/logsdb/patternedtext/PatternedTextFieldType.java\n@@ -118,9 +118,11 @@ public class PatternedTextFieldType extends StringFieldType {\n     private IOFunction<LeafReaderContext, CheckedIntFunction<List<Object>, IOException>> getValueFetcherProvider(\n         SearchExecutionContext searchExecutionContext\n     ) {\n+        // Extract needed objects from SearchExecutionContext to avoid memory leak\n+        ValueFetcher valueFetcher = valueFetcher(searchExecutionContext, null);\n+        // Create a SourceProvider using the context's createSourceProvider method to avoid capturing the context itself\n+        SourceProvider sourceProvider = searchExecutionContext.createSourceProvider(null);\n         return context -> {\n-            ValueFetcher valueFetcher = valueFetcher(searchExecutionContext, null);\n-            SourceProvider sourceProvider = searchExecutionContext.lookup();\n             valueFetcher.setNextReader(context);\n             return docID -> {\n                 try {",
  "logs_path": "factory/glm-4.6/24634b85/elastic_elasticsearch_pr134887/logs.jsonl",
  "errors": [],
  "edit_run_id": "24634b85",
  "test_label": null
}