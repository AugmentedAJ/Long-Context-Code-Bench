diff --git a/server/src/main/java/org/elasticsearch/search/aggregations/bucket/filter/QueryToFilterAdapter.java b/server/src/main/java/org/elasticsearch/search/aggregations/bucket/filter/QueryToFilterAdapter.java
index 9c6f7ddd..dacb88fa 100644
--- a/server/src/main/java/org/elasticsearch/search/aggregations/bucket/filter/QueryToFilterAdapter.java
+++ b/server/src/main/java/org/elasticsearch/search/aggregations/bucket/filter/QueryToFilterAdapter.java
@@ -51,15 +51,10 @@ public class QueryToFilterAdapter {
         // Wrapping with a ConstantScoreQuery enables a few more rewrite
         // rules as of Lucene 9.2
         query = searcher.rewrite(new ConstantScoreQuery(query));
-        if (query instanceof ConstantScoreQuery) {
-            /*
-             * Unwrap constant score because it gets in the way of us
-             * understanding what the queries are trying to do and we
-             * don't use the score at all anyway. Effectively we always
-             * run in constant score mode.
-             */
-            query = ((ConstantScoreQuery) query).getQuery();
-        }
+        query = switch (query) {
+            case ConstantScoreQuery constantScoreQuery -> constantScoreQuery.getQuery();
+            default -> query;
+        };
         return new QueryToFilterAdapter(searcher, key, query);
     }
 
@@ -132,8 +127,9 @@ public class QueryToFilterAdapter {
         extraQuery = searcher().rewrite(new ConstantScoreQuery(extraQuery));
         Query unwrappedExtraQuery = unwrap(extraQuery);
         Query unwrappedQuery = unwrap(query);
-        if (unwrappedQuery instanceof PointRangeQuery && unwrappedExtraQuery instanceof PointRangeQuery) {
-            Query merged = MergedPointRangeQuery.merge((PointRangeQuery) unwrappedQuery, (PointRangeQuery) unwrappedExtraQuery);
+        
+        if (unwrappedQuery instanceof PointRangeQuery queryRange && unwrappedExtraQuery instanceof PointRangeQuery extraRange) {
+            Query merged = MergedPointRangeQuery.merge(queryRange, extraRange);
             if (merged != null) {
                 // Should we rewrap here?
                 return new QueryToFilterAdapter(searcher(), key(), merged);
@@ -143,9 +139,10 @@ public class QueryToFilterAdapter {
         builder.add(query, BooleanClause.Occur.FILTER);
         builder.add(extraQuery, BooleanClause.Occur.FILTER);
         Query rewrittenUnion = searcher().rewrite(new ConstantScoreQuery(builder.build()));
-        if (rewrittenUnion instanceof ConstantScoreQuery) {
-            rewrittenUnion = ((ConstantScoreQuery) rewrittenUnion).getQuery();
-        }
+        rewrittenUnion = switch (rewrittenUnion) {
+            case ConstantScoreQuery constantScoreQuery -> constantScoreQuery.getQuery();
+            default -> rewrittenUnion;
+        };
         // This union is inefficient if Lucene cannot merge clauses of the boolean query through a rewrite.
         final boolean inefficientUnion = rewrittenUnion instanceof BooleanQuery;
         return new QueryToFilterAdapter(searcher(), key(), rewrittenUnion) {
@@ -156,21 +153,12 @@ public class QueryToFilterAdapter {
     }
 
     private static Query unwrap(Query query) {
-        while (true) {
-            if (query instanceof ConstantScoreQuery) {
-                query = ((ConstantScoreQuery) query).getQuery();
-                continue;
-            }
-            if (query instanceof IndexSortSortedNumericDocValuesRangeQuery) {
-                query = ((IndexSortSortedNumericDocValuesRangeQuery) query).getFallbackQuery();
-                continue;
-            }
-            if (query instanceof IndexOrDocValuesQuery) {
-                query = ((IndexOrDocValuesQuery) query).getIndexQuery();
-                continue;
-            }
-            return query;
-        }
+        return switch (query) {
+            case ConstantScoreQuery constantScoreQuery -> unwrap(constantScoreQuery.getQuery());
+            case IndexSortSortedNumericDocValuesRangeQuery rangeQuery -> unwrap(rangeQuery.getFallbackQuery());
+            case IndexOrDocValuesQuery docValuesQuery -> unwrap(docValuesQuery.getIndexQuery());
+            default -> query;
+        };
     }
 
     /**
@@ -265,11 +253,6 @@ public class QueryToFilterAdapter {
      * @return true if all filters match no docs, otherwise false
      */
     static boolean matchesNoDocs(List<QueryToFilterAdapter> filters) {
-        for (QueryToFilterAdapter filter : filters) {
-            if (filter.query() instanceof MatchNoDocsQuery == false) {
-                return false;
-            }
-        }
-        return true;
+        return filters.stream().allMatch(filter -> filter.query() instanceof MatchNoDocsQuery);
     }
 }