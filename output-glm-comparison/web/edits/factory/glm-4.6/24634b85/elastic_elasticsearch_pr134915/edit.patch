diff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/LogicalPlanOptimizerTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/LogicalPlanOptimizerTests.java
index 1a181fe8..c438c7f1 100644
--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/LogicalPlanOptimizerTests.java
+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/LogicalPlanOptimizerTests.java
@@ -5729,9 +5729,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             FROM test
             | INLINESTATS c = COUNT(salary) by emp_no % 2
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
         var limit = as(plan, Limit.class); // TODO: this needs to go
         var inline = as(limit.child(), InlineJoin.class);
@@ -5771,9 +5769,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP x, emp_no
             | LIMIT 1
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, Project.class);
@@ -5804,9 +5800,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | SORT emp_no
             | LIMIT 5
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, EsqlProject.class);
@@ -5847,9 +5841,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP x, emp_no
             | LIMIT 1
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, Project.class);
@@ -5876,9 +5868,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP x, a, emp_no
             | LIMIT 1
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, Project.class);
@@ -5905,9 +5895,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP x, a, emp_no
             | LIMIT 1
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, Project.class);
@@ -5956,9 +5944,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP emp_no, salaryK, count, min
             | LIMIT 5
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var employeesFields = List.of(
@@ -6025,9 +6011,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP emp_no
             | LIMIT 5
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, EsqlProject.class);
@@ -6066,9 +6050,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP emp_no
             | LIMIT 5
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, Project.class);
@@ -6107,9 +6089,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP avg, decades
             """;
 
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, Project.class);
@@ -6150,9 +6130,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP avg, decades, avgavg
             """;
 
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, EsqlProject.class);
@@ -6200,9 +6178,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | LIMIT 5
             """;
         assumeTrue("Requires LOOKUP JOIN", EsqlCapabilities.Cap.JOIN_LOOKUP_V12.isEnabled());
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
 
         var plan = planAirports(query);
         var project = as(plan, Project.class);
@@ -6240,9 +6216,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | KEEP avg, emp_no, first_name
             | LIMIT 10
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var esqlProject = as(plan, EsqlProject.class);
@@ -6275,9 +6249,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | INLINESTATS sum = SUM(salaryK) BY gender
             | KEEP emp_no
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var esqlProject = as(plan, EsqlProject.class);
@@ -6313,9 +6285,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | LIMIT 2
             | KEEP a
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var project = as(plan, EsqlProject.class);
@@ -6351,9 +6321,7 @@ public class LogicalPlanOptimizerTests extends AbstractLogicalPlanOptimizerTests
             | LIMIT 1
             | STATS v = VALUES(max_lang)
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = optimizedPlan(query);
 
         var limit = asLimit(plan, 10000, false);
diff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/rules/logical/ReplaceStatsFilteredAggWithEvalTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/rules/logical/ReplaceStatsFilteredAggWithEvalTests.java
index 92d5cd6f..21259835 100644
--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/rules/logical/ReplaceStatsFilteredAggWithEvalTests.java
+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/optimizer/rules/logical/ReplaceStatsFilteredAggWithEvalTests.java
@@ -32,7 +32,9 @@ import static org.elasticsearch.test.MapMatcher.assertMap;
 import static org.elasticsearch.xpack.esql.EsqlTestUtils.as;
 import static org.elasticsearch.xpack.esql.core.type.DataType.INTEGER;
 import static org.elasticsearch.xpack.esql.core.type.DataType.LONG;
+import org.elasticsearch.xpack.esql.action.EsqlCapabilities;
 import static org.elasticsearch.xpack.esql.optimizer.LogicalPlanOptimizerTests.releaseBuildForInlinestats;
+import static org.junit.Assume.assumeTrue;
 import static org.hamcrest.Matchers.contains;
 import static org.hamcrest.Matchers.containsString;
 import static org.hamcrest.Matchers.is;
@@ -396,9 +398,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
             FROM test
             | INLINESTATS sum(salary) where false
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var project = as(plan, Project.class);
         assertMap(
@@ -439,9 +439,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
             FROM test
             | INLINESTATS sum(salary) + 1 where false
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var project = as(plan, Project.class);
         assertMap(
@@ -488,9 +486,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
                     sum(salary) + 2
               BY emp_no
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var limit = as(plan, Limit.class);
         var ij = as(limit.child(), InlineJoin.class);
@@ -544,9 +540,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
                     sum(salary) + 2 where null,
                     sum(salary) + 4 where not true
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var limit = as(plan, Limit.class);
         var ij = as(limit.child(), InlineJoin.class);
@@ -595,9 +589,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
             | KEEP emp_no, salary
             | INLINESTATS count(salary) where not true
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var project = as(plan, EsqlProject.class);
         assertThat(Expressions.names(project.projections()), contains("emp_no", "salary", "count(salary) where not true"));
@@ -627,9 +619,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
             | KEEP emp_no, salary, gender
             | INLINESTATS m1 = count(salary) WHERE not false
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var limit = as(plan, Limit.class);
         var ij = as(limit.child(), InlineJoin.class);
@@ -660,9 +650,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
             | KEEP salary
             | INLINESTATS count(salary) where false
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var project = as(plan, EsqlProject.class);
         assertThat(Expressions.names(project.projections()), contains("salary", "count(salary) where false"));
@@ -690,9 +678,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
             | KEEP salary
             | INLINESTATS count_distinct(salary + 2) + 3 where false
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var project = as(plan, EsqlProject.class);
         assertThat(Expressions.names(project.projections()), contains("salary", "count_distinct(salary + 2) + 3 where false"));
@@ -727,9 +713,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
                     min_a = min(salary) WHERE to_string(null) == "abc"
               BY emp_no
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var limit = as(plan, Limit.class);
         var ij = as(limit.child(), InlineJoin.class);
@@ -778,9 +762,7 @@ public class ReplaceStatsFilteredAggWithEvalTests extends AbstractLogicalPlanOpt
                 | INLINESTATS count = count(*) WHERE false
                 | INLINESTATS cc = count_distinct(emp_no) WHERE false
             """;
-        if (releaseBuildForInlinestats(query)) {
-            return;
-        }
+        assumeTrue("INLINESTATS V11 required", EsqlCapabilities.Cap.INLINESTATS_V11.isEnabled());
         var plan = plan(query);
         var project = as(plan, EsqlProject.class);
         assertThat(Expressions.names(project.projections()), contains("emp_no", "count", "cc"));