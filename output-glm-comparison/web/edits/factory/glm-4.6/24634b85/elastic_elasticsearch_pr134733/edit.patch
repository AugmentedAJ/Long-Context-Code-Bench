diff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java
index 65f4caeb..b84bc96e 100644
--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java
+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionDefinition.java
@@ -21,9 +21,15 @@ record TransportVersionDefinition(String name, List<TransportVersionId> ids) {
         List<TransportVersionId> ids = new ArrayList<>();
 
         if (contents.isEmpty() == false) {
+            contents = contents.replaceAll("(?m)^#.*$", "");  // Remove comment lines starting with #
+            contents = contents.replaceAll("\\n+", ",");     // Convert newlines to commas
+            contents = contents.replaceAll(",+", ",");       // Remove duplicate commas from removed comment lines
+            contents = contents.replaceAll("^,|,$", "");     // Remove leading/trailing commas
+            
             for (String rawId : contents.split(",")) {
+                if (rawId.trim().isEmpty()) continue;  // Skip empty tokens from comment removal
                 try {
-                    ids.add(TransportVersionId.fromString(rawId));
+                    ids.add(TransportVersionId.fromString(rawId.trim()));
                 } catch (NumberFormatException e) {
                     throw new IllegalStateException("Failed to parse id " + rawId + " in " + file, e);
                 }
diff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReference.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReference.java
index eabdf837..91513195 100644
--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReference.java
+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionReference.java
@@ -32,11 +32,16 @@ record TransportVersionReference(String name, String location) {
         assert file.toString().endsWith(".csv") : file + " does not end in .csv";
         List<TransportVersionReference> results = new ArrayList<>();
         for (String line : Files.readAllLines(file, StandardCharsets.UTF_8)) {
+            line = line.trim();
+            // Skip comment lines starting with # and empty lines
+            if (line.isEmpty() || line.startsWith("#")) {
+                continue;
+            }
             String[] parts = line.split(",", 2);
             if (parts.length != 2) {
                 throw new IOException("Invalid transport version data file [" + file + "]: " + line);
             }
-            results.add(new TransportVersionReference(parts[0], parts[1]));
+            results.add(new TransportVersionReference(parts[0].trim(), parts[1].trim()));
         }
         return results;
     }
diff --git a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java
index d3b91464..b5e14709 100644
--- a/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java
+++ b/build-tools-internal/src/main/java/org/elasticsearch/gradle/internal/transport/TransportVersionUpperBound.java
@@ -23,11 +23,14 @@ record TransportVersionUpperBound(String name, String definitionName, TransportV
         int slashIndex = filename.lastIndexOf('/');
         String branch = filename.substring(slashIndex == -1 ? 0 : (slashIndex + 1), filename.length() - 4);
 
+        contents = contents.replaceAll("(?m)^#.*$", "");  // Remove comment lines starting with #
+        contents = contents.trim();  // Remove leading/trailing whitespace
+        
         String[] parts = contents.split(",");
         if (parts.length != 2) {
             throw new IllegalStateException("Invalid transport version upper bound file [" + file + "]: " + contents);
         }
 
-        return new TransportVersionUpperBound(branch, parts[0], TransportVersionId.fromString(parts[1]));
+        return new TransportVersionUpperBound(branch, parts[0].trim(), TransportVersionId.fromString(parts[1].trim()));
     }
 }