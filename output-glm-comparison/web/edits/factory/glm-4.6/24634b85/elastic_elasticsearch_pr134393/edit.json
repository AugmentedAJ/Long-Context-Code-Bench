{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134393,
  "base_commit": "7d0ee1a56dbe93fafb200da390fbdc491dae81dd",
  "runner": "factory",
  "model": "glm-4.6",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 163944,
  "patch_unified": "diff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java\nindex dddb41e9..a1aed65b 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java\n@@ -329,28 +329,34 @@ public class ComputeService {\n                 listener.onFailure(new IllegalStateException(error));\n                 return;\n             }\n-            var computeContext = new ComputeContext(\n-                newChildSession(sessionId),\n-                profileDescription(profileQualifier, \"single\"),\n-                LOCAL_CLUSTER,\n-                flags,\n-                List.of(),\n-                configuration,\n-                foldContext,\n-                null,\n-                exchangeSinkSupplier\n-            );\n-            updateShardCountForCoordinatorOnlyQuery(execInfo);\n-            try (\n-                var computeListener = new ComputeListener(\n-                    transportService.getThreadPool(),\n-                    cancelQueryOnFailure,\n-                    listener.map(completionInfo -> {\n-                        updateExecutionInfoAfterCoordinatorOnlyQuery(execInfo);\n-                        return new Result(physicalPlan.output(), collectedPages, completionInfo, execInfo);\n-                    })\n-                )\n-            ) {\n+        /*\n+         * Grab the output attributes here, so we can pass them to\n+         * the listener without holding on to a reference to the\n+         * entire plan.\n+         */\n+        List<Attribute> outputAttributes = physicalPlan.output();\n+        var computeContext = new ComputeContext(\n+            newChildSession(sessionId),\n+            profileDescription(profileQualifier, \"single\"),\n+            LOCAL_CLUSTER,\n+            flags,\n+            List.of(),\n+            configuration,\n+            foldContext,\n+            null,\n+            exchangeSinkSupplier\n+        );\n+        updateShardCountForCoordinatorOnlyQuery(execInfo);\n+        try (\n+            var computeListener = new ComputeListener(\n+                transportService.getThreadPool(),\n+                cancelQueryOnFailure,\n+                listener.map(completionInfo -> {\n+                    updateExecutionInfoAfterCoordinatorOnlyQuery(execInfo);\n+                    return new Result(outputAttributes, collectedPages, completionInfo, execInfo);\n+                })\n+            )\n+        ) {\n                 runCompute(rootTask, computeContext, coordinatorPlan, computeListener.acquireCompute());\n                 return;\n             }",
  "logs_path": "factory/glm-4.6/24634b85/elastic_elasticsearch_pr134393/logs.jsonl",
  "errors": [],
  "edit_run_id": "24634b85",
  "test_label": null
}