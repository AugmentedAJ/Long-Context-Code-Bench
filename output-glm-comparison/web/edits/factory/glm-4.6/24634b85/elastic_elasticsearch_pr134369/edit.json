{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134369,
  "base_commit": "20d6049c7f1068af75dd34270f7b74cf1f76991c",
  "runner": "factory",
  "model": "glm-4.6",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 152188,
  "patch_unified": "diff --git a/server/src/main/java/org/elasticsearch/snapshots/RestoreService.java b/server/src/main/java/org/elasticsearch/snapshots/RestoreService.java\nindex 1be7411b..9cb259e5 100644\n--- a/server/src/main/java/org/elasticsearch/snapshots/RestoreService.java\n+++ b/server/src/main/java/org/elasticsearch/snapshots/RestoreService.java\n@@ -258,7 +258,7 @@ public final class RestoreService implements ClusterStateApplier {\n         final RestoreSnapshotRequest request,\n         final ActionListener<RestoreCompletionResponse> listener\n     ) {\n-        restoreSnapshot(projectId, request, listener, (clusterState, builder) -> {});\n+        restoreSnapshot(projectId, request, listener, (clusterState, projectBuilder) -> {});\n     }\n \n     /**\n@@ -267,14 +267,14 @@ public final class RestoreService implements ClusterStateApplier {\n      * @param projectId project for the restore\n      * @param request  restore request\n      * @param listener restore listener\n-     * @param updater  handler that allows callers to make modifications to {@link Metadata}\n+     * @param updater  handler that allows callers to make modifications to {@link ProjectMetadata}\n      *                 in the same cluster state update as the restore operation\n      */\n     public void restoreSnapshot(\n         final ProjectId projectId,\n         final RestoreSnapshotRequest request,\n         final ActionListener<RestoreCompletionResponse> listener,\n-        final BiConsumer<ClusterState, Metadata.Builder> updater\n+        final BiConsumer<ClusterState, ProjectMetadata.Builder> updater\n     ) {\n         assert Repository.assertSnapshotMetaThread();\n \n@@ -368,7 +368,7 @@ public final class RestoreService implements ClusterStateApplier {\n      * @param repository     the repository to restore from\n      * @param request        restore request\n      * @param repositoryData current repository data for the repository to restore from\n-     * @param updater        handler that allows callers to make modifications to {@link Metadata} in the same cluster state update as the\n+     * @param updater        handler that allows callers to make modifications to {@link ProjectMetadata} in the same cluster state update as the\n      *                       restore operation\n      * @param listener       listener to resolve once restore has been started\n      * @throws IOException   on failure to load metadata from the repository\n@@ -378,7 +378,7 @@ public final class RestoreService implements ClusterStateApplier {\n         Repository repository,\n         RestoreSnapshotRequest request,\n         RepositoryData repositoryData,\n-        BiConsumer<ClusterState, Metadata.Builder> updater,\n+        BiConsumer<ClusterState, ProjectMetadata.Builder> updater,\n         ActionListener<RestoreCompletionResponse> listener\n     ) throws IOException {\n         assert Repository.assertSnapshotMetaThread();\n@@ -1371,7 +1371,7 @@ public final class RestoreService implements ClusterStateApplier {\n \n         private final Collection<DataStream> dataStreamsToRestore;\n \n-        private final BiConsumer<ClusterState, Metadata.Builder> updater;\n+        private final BiConsumer<ClusterState, ProjectMetadata.Builder> updater;\n \n         private final AllocationActionListener<RestoreCompletionResponse> listener;\n         private final Settings settings;\n@@ -1387,7 +1387,7 @@ public final class RestoreService implements ClusterStateApplier {\n             SnapshotInfo snapshotInfo,\n             Metadata metadata,\n             Collection<DataStream> dataStreamsToRestore,\n-            BiConsumer<ClusterState, Metadata.Builder> updater,\n+            BiConsumer<ClusterState, ProjectMetadata.Builder> updater,\n             Settings settings,\n             ActionListener<RestoreCompletionResponse> listener\n         ) {\n@@ -1586,7 +1586,7 @@ public final class RestoreService implements ClusterStateApplier {\n                 );\n             }\n \n-            updater.accept(currentState, mdBuilder);\n+            updater.accept(currentState, mdBuilder.getProject(projectId));\n             final ClusterState updatedClusterState = builder.metadata(mdBuilder)\n                 .blocks(blocks)\n                 .putRoutingTable(projectId, rtBuilder.build())",
  "logs_path": "factory/glm-4.6/24634b85/elastic_elasticsearch_pr134369/logs.jsonl",
  "errors": [],
  "edit_run_id": "24634b85",
  "test_label": null
}