{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134393,
  "base_commit": "7d0ee1a56dbe93fafb200da390fbdc491dae81dd",
  "runner": "auggie",
  "model": "sonnet4.5",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 175287,
  "patch_unified": "diff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java\nindex dddb41e9..4406bf89 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/plugin/ComputeService.java\n@@ -240,13 +240,19 @@ public class ComputeService {\n \n             Runnable cancelQueryOnFailure = cancelQueryOnFailure(rootTask);\n \n+            /*\n+             * Grab the output attributes here, so we can pass them to\n+             * the listener without holding on to a reference to the\n+             * entire plan.\n+             */\n+            List<Attribute> mainPlanOutputAttributes = mainPlan.output();\n             try (\n                 ComputeListener localListener = new ComputeListener(\n                     transportService.getThreadPool(),\n                     cancelQueryOnFailure,\n                     finalListener.map(profiles -> {\n                         execInfo.markEndQuery();\n-                        return new Result(mainPlan.output(), collectedPages, profiles, execInfo);\n+                        return new Result(mainPlanOutputAttributes, collectedPages, profiles, execInfo);\n                     })\n                 )\n             ) {\n@@ -329,6 +335,12 @@ public class ComputeService {\n                 listener.onFailure(new IllegalStateException(error));\n                 return;\n             }\n+            /*\n+             * Grab the output attributes here, so we can pass them to\n+             * the listener without holding on to a reference to the\n+             * entire plan.\n+             */\n+            List<Attribute> outputAttributes = physicalPlan.output();\n             var computeContext = new ComputeContext(\n                 newChildSession(sessionId),\n                 profileDescription(profileQualifier, \"single\"),\n@@ -347,7 +359,7 @@ public class ComputeService {\n                     cancelQueryOnFailure,\n                     listener.map(completionInfo -> {\n                         updateExecutionInfoAfterCoordinatorOnlyQuery(execInfo);\n-                        return new Result(physicalPlan.output(), collectedPages, completionInfo, execInfo);\n+                        return new Result(outputAttributes, collectedPages, completionInfo, execInfo);\n                     })\n                 )\n             ) {\n@@ -658,6 +670,12 @@ public class ComputeService {\n                 throw new IllegalStateException(\"no drivers created\");\n             }\n             LOGGER.debug(\"using {} drivers\", drivers.size());\n+            /*\n+             * Grab the plan string here, so we can pass it to\n+             * the listener without holding on to a reference to the\n+             * entire plan.\n+             */\n+            String localPlanString = localPlan.toString();\n             ActionListener<Void> driverListener = listener.map(ignored -> {\n                 if (LOGGER.isDebugEnabled()) {\n                     LOGGER.debug(\n@@ -667,7 +685,7 @@ public class ComputeService {\n                             context.description(),\n                             clusterService.getClusterName().value(),\n                             transportService.getLocalNode().getName(),\n-                            localPlan.toString()\n+                            localPlanString\n                         )\n                     );\n                 }\n@@ -677,7 +695,7 @@ public class ComputeService {\n                         context.description(),\n                         clusterService.getClusterName().value(),\n                         transportService.getLocalNode().getName(),\n-                        localPlan.toString()\n+                        localPlanString\n                     );\n                 } else {\n                     return DriverCompletionInfo.excludingProfiles(drivers);",
  "logs_path": "auggie/sonnet4.5/7ad89f22/elastic_elasticsearch_pr134393/logs.jsonl",
  "errors": [],
  "edit_run_id": "7ad89f22",
  "test_label": "v1-rollouts-1-3-sonnet4.5"
}