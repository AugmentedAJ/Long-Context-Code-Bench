{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134451,
  "base_commit": "fc5a7efb564eb387866cf6d00997c435a21f9d69",
  "runner": "auggie",
  "model": "sonnet4.5",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 182703,
  "patch_unified": "diff --git a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java\nindex 2628de58..75cca40a 100644\n--- a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java\n+++ b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java\n@@ -176,14 +176,16 @@ public final class SourceConfirmedTextQuery extends Query {\n             return false;\n         }\n         SourceConfirmedTextQuery that = (SourceConfirmedTextQuery) obj;\n-        return Objects.equals(in, that.in)\n-            && Objects.equals(valueFetcherProvider, that.valueFetcherProvider)\n-            && Objects.equals(indexAnalyzer, that.indexAnalyzer);\n+        // Only compare the wrapped query. The valueFetcherProvider and indexAnalyzer are\n+        // implementation details that don't affect logical query equality.\n+        return Objects.equals(in, that.in);\n     }\n \n     @Override\n     public int hashCode() {\n-        return 31 * Objects.hash(in, valueFetcherProvider, indexAnalyzer) + classHash();\n+        // Only hash the wrapped query. The valueFetcherProvider and indexAnalyzer are\n+        // implementation details that don't affect logical query equality.\n+        return 31 * Objects.hash(in) + classHash();\n     }\n \n     @Override\ndiff --git a/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java b/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java\nindex be6a4510..dc40f891 100644\n--- a/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java\n+++ b/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java\n@@ -400,16 +400,20 @@ public class SourceConfirmedTextQueryTests extends ESTestCase {\n         PhraseQuery query2 = new PhraseQuery(\"body\", \"b\", \"c\");\n         Query sourceConfirmedPhraseQuery2 = new SourceConfirmedTextQuery(query2, SOURCE_FETCHER_PROVIDER, Lucene.STANDARD_ANALYZER);\n         assertEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery2);\n+        assertEquals(sourceConfirmedPhraseQuery1.hashCode(), sourceConfirmedPhraseQuery2.hashCode());\n \n         PhraseQuery query3 = new PhraseQuery(\"body\", \"b\", \"d\");\n         Query sourceConfirmedPhraseQuery3 = new SourceConfirmedTextQuery(query3, SOURCE_FETCHER_PROVIDER, Lucene.STANDARD_ANALYZER);\n         assertNotEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery3);\n \n+        // valueFetcherProvider and indexAnalyzer are implementation details and don't affect equality\n         Query sourceConfirmedPhraseQuery4 = new SourceConfirmedTextQuery(query1, context -> null, Lucene.STANDARD_ANALYZER);\n-        assertNotEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery4);\n+        assertEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery4);\n+        assertEquals(sourceConfirmedPhraseQuery1.hashCode(), sourceConfirmedPhraseQuery4.hashCode());\n \n         Query sourceConfirmedPhraseQuery5 = new SourceConfirmedTextQuery(query1, SOURCE_FETCHER_PROVIDER, Lucene.KEYWORD_ANALYZER);\n-        assertNotEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery5);\n+        assertEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery5);\n+        assertEquals(sourceConfirmedPhraseQuery1.hashCode(), sourceConfirmedPhraseQuery5.hashCode());\n     }\n \n     public void testApproximation() {",
  "logs_path": "auggie/sonnet4.5/7ad89f22/elastic_elasticsearch_pr134451/logs.jsonl",
  "errors": [],
  "edit_run_id": "7ad89f22",
  "test_label": "v1-rollouts-1-3-sonnet4.5"
}