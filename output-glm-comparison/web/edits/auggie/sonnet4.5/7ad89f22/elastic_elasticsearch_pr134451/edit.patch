diff --git a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java
index 2628de58..75cca40a 100644
--- a/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java
+++ b/modules/mapper-extras/src/main/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQuery.java
@@ -176,14 +176,16 @@ public final class SourceConfirmedTextQuery extends Query {
             return false;
         }
         SourceConfirmedTextQuery that = (SourceConfirmedTextQuery) obj;
-        return Objects.equals(in, that.in)
-            && Objects.equals(valueFetcherProvider, that.valueFetcherProvider)
-            && Objects.equals(indexAnalyzer, that.indexAnalyzer);
+        // Only compare the wrapped query. The valueFetcherProvider and indexAnalyzer are
+        // implementation details that don't affect logical query equality.
+        return Objects.equals(in, that.in);
     }
 
     @Override
     public int hashCode() {
-        return 31 * Objects.hash(in, valueFetcherProvider, indexAnalyzer) + classHash();
+        // Only hash the wrapped query. The valueFetcherProvider and indexAnalyzer are
+        // implementation details that don't affect logical query equality.
+        return 31 * Objects.hash(in) + classHash();
     }
 
     @Override
diff --git a/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java b/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java
index be6a4510..dc40f891 100644
--- a/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java
+++ b/modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/extras/SourceConfirmedTextQueryTests.java
@@ -400,16 +400,20 @@ public class SourceConfirmedTextQueryTests extends ESTestCase {
         PhraseQuery query2 = new PhraseQuery("body", "b", "c");
         Query sourceConfirmedPhraseQuery2 = new SourceConfirmedTextQuery(query2, SOURCE_FETCHER_PROVIDER, Lucene.STANDARD_ANALYZER);
         assertEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery2);
+        assertEquals(sourceConfirmedPhraseQuery1.hashCode(), sourceConfirmedPhraseQuery2.hashCode());
 
         PhraseQuery query3 = new PhraseQuery("body", "b", "d");
         Query sourceConfirmedPhraseQuery3 = new SourceConfirmedTextQuery(query3, SOURCE_FETCHER_PROVIDER, Lucene.STANDARD_ANALYZER);
         assertNotEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery3);
 
+        // valueFetcherProvider and indexAnalyzer are implementation details and don't affect equality
         Query sourceConfirmedPhraseQuery4 = new SourceConfirmedTextQuery(query1, context -> null, Lucene.STANDARD_ANALYZER);
-        assertNotEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery4);
+        assertEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery4);
+        assertEquals(sourceConfirmedPhraseQuery1.hashCode(), sourceConfirmedPhraseQuery4.hashCode());
 
         Query sourceConfirmedPhraseQuery5 = new SourceConfirmedTextQuery(query1, SOURCE_FETCHER_PROVIDER, Lucene.KEYWORD_ANALYZER);
-        assertNotEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery5);
+        assertEquals(sourceConfirmedPhraseQuery1, sourceConfirmedPhraseQuery5);
+        assertEquals(sourceConfirmedPhraseQuery1.hashCode(), sourceConfirmedPhraseQuery5.hashCode());
     }
 
     public void testApproximation() {