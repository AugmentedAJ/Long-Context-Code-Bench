{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 3640,
  "base_commit": "4155741f7f486537d4a5f7193d79098d523a6ae8",
  "runner": "claude-code",
  "model": "claude-sonnet-4-5",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 90626,
  "patch_unified": "diff --git a/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java b/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java\nindex 9764831..bdc9244 100644\n--- a/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java\n+++ b/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java\n@@ -151,7 +151,7 @@ public class NettyTransport extends AbstractLifecycleComponent<Transport> implem\n \n     private volatile BoundTransportAddress boundAddress;\n \n-    private final Object[] connectMutex;\n+    private final ConcurrentMap<String, Object> connectMutex = newConcurrentMap();\n     // this lock is here to make sure we close this transport and disconnect all the client nodes\n     // connections while no connect operations is going on... (this might help with 100% CPU when stopping the transport?)\n     private final ReadWriteLock globalLock = new ReentrantReadWriteLock();\n@@ -167,11 +167,6 @@ public class NettyTransport extends AbstractLifecycleComponent<Transport> implem\n             System.setProperty(\"org.jboss.netty.epollBugWorkaround\", \"true\");\n         }\n \n-        this.connectMutex = new Object[500];\n-        for (int i = 0; i < connectMutex.length; i++) {\n-            connectMutex[i] = new Object();\n-        }\n-\n         this.workerCount = componentSettings.getAsInt(\"worker_count\", EsExecutors.boundedNumberOfProcessors() * 2);\n         this.bossCount = componentSettings.getAsInt(\"boss_count\", 1);\n         this.blockingServer = settings.getAsBoolean(\"transport.tcp.blocking_server\", settings.getAsBoolean(TCP_BLOCKING_SERVER, settings.getAsBoolean(TCP_BLOCKING, false)));\n@@ -810,12 +805,7 @@ public class NettyTransport extends AbstractLifecycleComponent<Transport> implem\n     }\n \n     private Object connectLock(String nodeId) {\n-        int hash = nodeId.hashCode();\n-        // abs returns Integer.MIN_VALUE, so we need to protect against it...\n-        if (hash == Integer.MIN_VALUE) {\n-            hash = 0;\n-        }\n-        return connectMutex[Math.abs(hash) % connectMutex.length];\n+        return connectMutex.computeIfAbsent(nodeId, k -> new Object());\n     }\n \n     private class ChannelCloseListener implements ChannelFutureListener {",
  "logs_path": "claude-code/claude-sonnet-4-5/8d6f99fc/elastic_elasticsearch_pr3640/logs.jsonl",
  "errors": [],
  "edit_run_id": "8d6f99fc",
  "test_label": "v1-rollouts-1-3-sonnet4.5"
}