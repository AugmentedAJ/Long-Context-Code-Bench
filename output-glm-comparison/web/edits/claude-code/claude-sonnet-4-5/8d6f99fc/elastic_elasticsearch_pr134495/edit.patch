diff --git a/server/src/internalClusterTest/java/org/elasticsearch/search/ccs/CCSUsageTelemetryIT.java b/server/src/internalClusterTest/java/org/elasticsearch/search/ccs/CCSUsageTelemetryIT.java
index ab79fd7b..a3269d19 100644
--- a/server/src/internalClusterTest/java/org/elasticsearch/search/ccs/CCSUsageTelemetryIT.java
+++ b/server/src/internalClusterTest/java/org/elasticsearch/search/ccs/CCSUsageTelemetryIT.java
@@ -80,6 +80,54 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
     @Rule
     public SkipUnavailableRule skipOverride = new SkipUnavailableRule(REMOTE1, REMOTE2);
 
+    private void assertBasicCounts(CCSTelemetrySnapshot snapshot, long expectedTotal, long expectedSuccess) {
+        assertThat(snapshot.getTotalCount(), equalTo(expectedTotal));
+        assertThat(snapshot.getSuccessCount(), equalTo(expectedSuccess));
+    }
+
+    private void assertMrtMetrics(CCSTelemetrySnapshot snapshot, boolean minimizeRoundtrips, long expectedCount) {
+        assertThat(snapshot.getTookMrtTrue().count(), equalTo(minimizeRoundtrips ? expectedCount : 0L));
+        assertThat(snapshot.getTookMrtFalse().count(), equalTo(minimizeRoundtrips ? 0L : expectedCount));
+    }
+
+    private void assertRemoteSearchMetrics(
+        CCSTelemetrySnapshot snapshot,
+        long expectedSkippedRemotes,
+        double expectedAvg,
+        long expectedMax
+    ) {
+        assertThat(snapshot.getSearchCountWithSkippedRemotes(), equalTo(expectedSkippedRemotes));
+        assertThat(snapshot.getRemotesPerSearchAvg(), equalTo(expectedAvg));
+        assertThat(snapshot.getRemotesPerSearchMax(), equalTo(expectedMax));
+    }
+
+    private void assertFeatureCount(CCSTelemetrySnapshot snapshot, String feature, Long expectedCount) {
+        assertThat(snapshot.getFeatureCounts().get(feature), equalTo(expectedCount));
+    }
+
+    private void assertPerClusterTelemetry(
+        CCSTelemetrySnapshot.PerClusterCCSTelemetry telemetry,
+        long expectedCount,
+        long expectedSkippedCount,
+        long expectedTookCount
+    ) {
+        assertThat(telemetry.getCount(), equalTo(expectedCount));
+        assertThat(telemetry.getSkippedCount(), equalTo(expectedSkippedCount));
+        assertThat(telemetry.getTook().count(), equalTo(expectedTookCount));
+    }
+
+    private void assertFailedSearch(
+        CCSTelemetrySnapshot telemetry,
+        long expectedRemotesMax,
+        Map<String, Long> expectedFailures
+    ) {
+        assertBasicCounts(telemetry, 1L, 0L);
+        assertThat(telemetry.getTook().count(), equalTo(0L));
+        assertMrtMetrics(telemetry, false, 0L);
+        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(expectedRemotesMax));
+        assertThat(telemetry.getFailureReasons(), equalTo(expectedFailures));
+    }
+
     @Override
     protected Map<String, Boolean> skipUnavailableForRemoteClusters() {
         var map = skipOverride.getMap();
@@ -156,54 +204,36 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         );
         CCSTelemetrySnapshot telemetry = getTelemetrySnapshot(nodeName);
 
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
         assertThat(telemetry.getFailureReasons().size(), equalTo(0));
         assertThat(telemetry.getTook().count(), equalTo(1L));
-        assertThat(telemetry.getTookMrtTrue().count(), equalTo(minimizeRoundtrips ? 1L : 0L));
-        assertThat(telemetry.getTookMrtFalse().count(), equalTo(minimizeRoundtrips ? 0L : 1L));
-        assertThat(telemetry.getRemotesPerSearchAvg(), equalTo(2.0));
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(2L));
-        assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(0L));
+        assertMrtMetrics(telemetry, minimizeRoundtrips, 1L);
+        assertRemoteSearchMetrics(telemetry, 0L, 2.0, 2L);
         assertThat(telemetry.getClientCounts().size(), equalTo(1));
         assertThat(telemetry.getClientCounts().get("kibana"), equalTo(1L));
-        if (minimizeRoundtrips) {
-            assertThat(telemetry.getFeatureCounts().get(MRT_FEATURE), equalTo(1L));
-        } else {
-            assertThat(telemetry.getFeatureCounts().get(MRT_FEATURE), equalTo(null));
-        }
-        assertThat(telemetry.getFeatureCounts().get(ASYNC_FEATURE), equalTo(null));
+        assertFeatureCount(telemetry, MRT_FEATURE, minimizeRoundtrips ? 1L : null);
+        assertFeatureCount(telemetry, ASYNC_FEATURE, null);
 
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(3));
         for (String clusterAlias : remoteClusterAlias()) {
-            var clusterTelemetry = perCluster.get(clusterAlias);
-            assertThat(clusterTelemetry.getCount(), equalTo(1L));
-            assertThat(clusterTelemetry.getSkippedCount(), equalTo(0L));
-            assertThat(clusterTelemetry.getTook().count(), equalTo(1L));
+            assertPerClusterTelemetry(perCluster.get(clusterAlias), 1L, 0L, 1L);
         }
 
         // another search
         assertResponse(cluster(LOCAL_CLUSTER).client(nodeName).search(searchRequest), Assert::assertNotNull);
         telemetry = getTelemetrySnapshot(nodeName);
-        assertThat(telemetry.getTotalCount(), equalTo(2L));
-        assertThat(telemetry.getSuccessCount(), equalTo(2L));
+        assertBasicCounts(telemetry, 2L, 2L);
         assertThat(telemetry.getFailureReasons().size(), equalTo(0));
         assertThat(telemetry.getTook().count(), equalTo(2L));
-        assertThat(telemetry.getTookMrtTrue().count(), equalTo(minimizeRoundtrips ? 2L : 0L));
-        assertThat(telemetry.getTookMrtFalse().count(), equalTo(minimizeRoundtrips ? 0L : 2L));
-        assertThat(telemetry.getRemotesPerSearchAvg(), equalTo(2.0));
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(2L));
-        assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(0L));
+        assertMrtMetrics(telemetry, minimizeRoundtrips, 2L);
+        assertRemoteSearchMetrics(telemetry, 0L, 2.0, 2L);
         assertThat(telemetry.getClientCounts().size(), equalTo(1));
         assertThat(telemetry.getClientCounts().get("kibana"), equalTo(1L));
         perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(3));
         for (String clusterAlias : remoteClusterAlias()) {
-            var clusterTelemetry = perCluster.get(clusterAlias);
-            assertThat(clusterTelemetry.getCount(), equalTo(2L));
-            assertThat(clusterTelemetry.getSkippedCount(), equalTo(0L));
-            assertThat(clusterTelemetry.getTook().count(), equalTo(2L));
+            assertPerClusterTelemetry(perCluster.get(clusterAlias), 2L, 0L, 2L);
         }
     }
 
@@ -261,18 +291,13 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromSearch("*:" + remoteIndex);
         var perCluster = telemetry.getByRemoteCluster();
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
         assertThat(telemetry.getFailureReasons().size(), equalTo(0));
         assertThat(telemetry.getTook().count(), equalTo(1L));
         assertThat(perCluster.size(), equalTo(2));
         assertThat(telemetry.getClientCounts().size(), equalTo(0));
-        assertThat(perCluster.get(REMOTE1).getCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE1).getSkippedCount(), equalTo(0L));
-        assertThat(perCluster.get(REMOTE1).getTook().count(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE2).getCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE2).getSkippedCount(), equalTo(0L));
-        assertThat(perCluster.get(REMOTE2).getTook().count(), equalTo(1L));
+        assertPerClusterTelemetry(perCluster.get(REMOTE1), 1L, 0L, 1L);
+        assertPerClusterTelemetry(perCluster.get(REMOTE2), 1L, 0L, 1L);
     }
 
     /**
@@ -339,13 +364,8 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         searchRequest.allowPartialSearchResults(true);
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromFailedSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(0L));
-        assertThat(telemetry.getTook().count(), equalTo(0L));
-        assertThat(telemetry.getTookMrtTrue().count(), equalTo(0L));
-        assertThat(telemetry.getTookMrtFalse().count(), equalTo(0L));
         Map<String, Long> expectedFailures = Map.of(Result.UNKNOWN.getName(), 1L);
-        assertThat(telemetry.getFailureReasons(), equalTo(expectedFailures));
+        assertFailedSearch(telemetry, 2L, expectedFailures);
     }
 
     /**
@@ -370,20 +390,15 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         assertResponse(cluster(LOCAL_CLUSTER).client(nodeName).search(searchRequest), Assert::assertNotNull);
 
         CCSTelemetrySnapshot telemetry = getTelemetrySnapshot(nodeName);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
         // Note that this counts how many searches had skipped remotes, not how many remotes are skipped
-        assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(1L));
-        // Still count the remote that failed
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(2L));
+        assertRemoteSearchMetrics(telemetry, 1L, 2.0, 2L);
         assertThat(telemetry.getTook().count(), equalTo(1L));
         // Each remote will have its skipped count bumped
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(3));
         for (String remote : remoteClusterAlias()) {
-            assertThat(perCluster.get(remote).getCount(), equalTo(0L));
-            assertThat(perCluster.get(remote).getSkippedCount(), equalTo(1L));
-            assertThat(perCluster.get(remote).getTook().count(), equalTo(0L));
+            assertPerClusterTelemetry(perCluster.get(remote), 0L, 1L, 0L);
         }
     }
 
@@ -407,24 +422,17 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         assertResponse(cluster(LOCAL_CLUSTER).client(nodeName).search(searchRequest), Assert::assertNotNull);
 
         CCSTelemetrySnapshot telemetry = getTelemetrySnapshot(nodeName);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
         // Note that this counts how many searches had skipped remotes, not how many remotes are skipped
-        assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(1L));
-        // Still count the remote that failed
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(2L));
+        assertRemoteSearchMetrics(telemetry, 1L, 2.0, 2L);
         assertThat(telemetry.getTook().count(), equalTo(1L));
         // Each remote will have its skipped count bumped
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(3));
         // This one is skipped
-        assertThat(perCluster.get(REMOTE1).getCount(), equalTo(0L));
-        assertThat(perCluster.get(REMOTE1).getSkippedCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE1).getTook().count(), equalTo(0L));
+        assertPerClusterTelemetry(perCluster.get(REMOTE1), 0L, 1L, 0L);
         // This one is OK
-        assertThat(perCluster.get(REMOTE2).getCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE2).getSkippedCount(), equalTo(0L));
-        assertThat(perCluster.get(REMOTE2).getTook().count(), equalTo(1L));
+        assertPerClusterTelemetry(perCluster.get(REMOTE2), 1L, 0L, 1L);
     }
 
     /**
@@ -447,15 +455,11 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         searchRequest.source(sourceBuilder);
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
-        assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(1L));
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
+        assertRemoteSearchMetrics(telemetry, 1L, 1.0, 1L);
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(2));
-        assertThat(perCluster.get(REMOTE1).getCount(), equalTo(0L));
-        assertThat(perCluster.get(REMOTE1).getSkippedCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE1).getTook().count(), equalTo(0L));
+        assertPerClusterTelemetry(perCluster.get(REMOTE1), 0L, 1L, 0L);
         assertThat(perCluster.get(REMOTE2), equalTo(null));
     }
 
@@ -478,15 +482,11 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         searchRequest.source(sourceBuilder);
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
-        assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(1L));
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
+        assertRemoteSearchMetrics(telemetry, 1L, 1.0, 1L);
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(1));
-        assertThat(perCluster.get(REMOTE1).getCount(), equalTo(0L));
-        assertThat(perCluster.get(REMOTE1).getSkippedCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE1).getTook().count(), equalTo(0L));
+        assertPerClusterTelemetry(perCluster.get(REMOTE1), 0L, 1L, 0L);
         assertThat(perCluster.get(REMOTE2), equalTo(null));
     }
 
@@ -504,15 +504,10 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         searchRequest.source(sourceBuilder);
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromFailedSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(0L));
+        Map<String, Long> expectedFailure = Map.of(Result.TIMEOUT.getName(), 1L);
+        assertFailedSearch(telemetry, 1L, expectedFailure);
         // Failure is not skipping
         assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(0L));
-        // Still count the remote that failed
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(1L));
-        assertThat(telemetry.getTook().count(), equalTo(0L));
-        Map<String, Long> expectedFailure = Map.of(Result.TIMEOUT.getName(), 1L);
-        assertThat(telemetry.getFailureReasons(), equalTo(expectedFailure));
         // No per-cluster data on total failure
         assertThat(telemetry.getByRemoteCluster().size(), equalTo(0));
     }
@@ -536,15 +531,10 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         searchRequest.source(new SearchSourceBuilder().query(queryBuilder).size(10));
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromFailedSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(0L));
+        Map<String, Long> expectedFailure = Map.of(Result.REMOTES_UNAVAILABLE.getName(), 1L);
+        assertFailedSearch(telemetry, 2L, expectedFailure);
         // Failure is not skipping
         assertThat(telemetry.getSearchCountWithSkippedRemotes(), equalTo(0L));
-        // Still count the remote that failed
-        assertThat(telemetry.getRemotesPerSearchMax(), equalTo(2L));
-        assertThat(telemetry.getTook().count(), equalTo(0L));
-        Map<String, Long> expectedFailure = Map.of(Result.REMOTES_UNAVAILABLE.getName(), 1L);
-        assertThat(telemetry.getFailureReasons(), equalTo(expectedFailure));
         // No per-cluster data on total failure
         assertThat(telemetry.getByRemoteCluster().size(), equalTo(0));
     }
@@ -557,12 +547,10 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         String localIndex = (String) testClusterInfo.get("local.index");
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromSearch(localIndex, REMOTE1 + ":" + "no_such_index*");
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(2));
-        assertThat(perCluster.get(REMOTE1).getCount(), equalTo(1L));
-        assertThat(perCluster.get(REMOTE1).getTook().count(), equalTo(1L));
+        assertPerClusterTelemetry(perCluster.get(REMOTE1), 1L, 0L, 1L);
         assertThat(perCluster.get(REMOTE2), equalTo(null));
     }
 
@@ -573,12 +561,10 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
     public void testRemoteHasNoIndexFailure() throws Exception {
         SearchRequest searchRequest = makeSearchRequest(REMOTE1 + ":no_such_index");
         CCSTelemetrySnapshot telemetry = getTelemetryFromFailedSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(0L));
+        Map<String, Long> expectedFailure = Map.of(Result.NOT_FOUND.getName(), 1L);
+        assertFailedSearch(telemetry, 1L, expectedFailure);
         var perCluster = telemetry.getByRemoteCluster();
         assertThat(perCluster.size(), equalTo(0));
-        Map<String, Long> expectedFailure = Map.of(Result.NOT_FOUND.getName(), 1L);
-        assertThat(telemetry.getFailureReasons(), equalTo(expectedFailure));
     }
 
     public void testPITSearch() throws ExecutionException, InterruptedException {
@@ -605,9 +591,8 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         client.execute(TransportClosePointInTimeAction.TYPE, new ClosePointInTimeRequest(pitID)).actionGet();
         CCSTelemetrySnapshot telemetry = getTelemetrySnapshot(nodeName);
 
-        assertThat(telemetry.getTotalCount(), equalTo(2L));
-        assertThat(telemetry.getSuccessCount(), equalTo(2L));
-        assertThat(telemetry.getFeatureCounts().get(PIT_FEATURE), equalTo(2L));
+        assertBasicCounts(telemetry, 2L, 2L);
+        assertFeatureCount(telemetry, PIT_FEATURE, 2L);
     }
 
     public void testCompoundRetrieverSearch() throws ExecutionException, InterruptedException {
@@ -620,8 +605,7 @@ public class CCSUsageTelemetryIT extends AbstractMultiClustersTestCase {
         searchRequest.source(new SearchSourceBuilder().retriever(compoundRetriever));
 
         CCSTelemetrySnapshot telemetry = getTelemetryFromSearch(searchRequest);
-        assertThat(telemetry.getTotalCount(), equalTo(1L));
-        assertThat(telemetry.getSuccessCount(), equalTo(1L));
+        assertBasicCounts(telemetry, 1L, 1L);
     }
 
     private CCSTelemetrySnapshot getTelemetrySnapshot(String nodeName) {
diff --git a/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSTelemetrySnapshotTests.java b/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSTelemetrySnapshotTests.java
index 156bff93..3e3fdd78 100644
--- a/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSTelemetrySnapshotTests.java
+++ b/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSTelemetrySnapshotTests.java
@@ -180,6 +180,73 @@ public class CCSTelemetrySnapshotTests extends AbstractWireSerializingTestCase<C
         );
     }
 
+    private void assertBasicCounts(CCSTelemetrySnapshot snapshot, long expectedTotal, long expectedSuccess) {
+        assertThat(snapshot.getTotalCount(), equalTo(expectedTotal));
+        assertThat(snapshot.getSuccessCount(), equalTo(expectedSuccess));
+    }
+
+    private void assertTookMetrics(CCSTelemetrySnapshot snapshot, long expectedCount) {
+        assertThat(snapshot.getTook().count(), equalTo(expectedCount));
+        assertThat(snapshot.getTookMrtTrue().count(), equalTo(expectedCount));
+        assertThat(snapshot.getTookMrtFalse().count(), equalTo(expectedCount));
+    }
+
+    private void assertMapValuesDoubled(Map<String, Long> actual, Map<String, Long> original) {
+        actual.forEach((k, v) -> assertThat(v, equalTo(original.get(k) * 2)));
+    }
+
+    private void assertPerClusterTelemetryDoubled(
+        Map<String, PerClusterCCSTelemetry> actual,
+        Map<String, PerClusterCCSTelemetry> original
+    ) {
+        actual.forEach((k, v) -> {
+            assertThat(v.getCount(), equalTo(original.get(k).getCount() * 2));
+            assertThat(v.getSkippedCount(), equalTo(original.get(k).getSkippedCount() * 2));
+            assertThat(v.getTook().count(), equalTo(original.get(k).getTook().count() * 2));
+        });
+    }
+
+    private void assertMapValuesAdded(
+        Map<String, Long> actual,
+        Map<String, Long> first,
+        Map<String, Long> second
+    ) {
+        actual.forEach(
+            (k, v) -> assertThat(
+                v,
+                equalTo(first.getOrDefault(k, 0L) + second.getOrDefault(k, 0L))
+            )
+        );
+    }
+
+    private void assertPerClusterTelemetryAdded(
+        Map<String, PerClusterCCSTelemetry> actual,
+        Map<String, PerClusterCCSTelemetry> first,
+        Map<String, PerClusterCCSTelemetry> second
+    ) {
+        PerClusterCCSTelemetry zeroDummy = new PerClusterCCSTelemetry();
+        actual.forEach((k, v) -> {
+            assertThat(
+                v.getCount(),
+                equalTo(
+                    first.getOrDefault(k, zeroDummy).getCount() + second.getOrDefault(k, zeroDummy).getCount()
+                )
+            );
+            assertThat(
+                v.getSkippedCount(),
+                equalTo(
+                    first.getOrDefault(k, zeroDummy).getSkippedCount() + second.getOrDefault(k, zeroDummy).getSkippedCount()
+                )
+            );
+            assertThat(
+                v.getTook().count(),
+                equalTo(
+                    first.getOrDefault(k, zeroDummy).getTook().count() + second.getOrDefault(k, zeroDummy).getTook().count()
+                )
+            );
+        });
+    }
+
     public void testAdd() {
         CCSTelemetrySnapshot empty = new CCSTelemetrySnapshot();
         CCSTelemetrySnapshot full = randomCCSTelemetrySnapshot();
@@ -187,23 +254,15 @@ public class CCSTelemetrySnapshotTests extends AbstractWireSerializingTestCase<C
         assertThat(empty, equalTo(full));
         // Add again
         empty.add(full);
-        assertThat(empty.getTotalCount(), equalTo(full.getTotalCount() * 2));
-        assertThat(empty.getSuccessCount(), equalTo(full.getSuccessCount() * 2));
-        // check that each element of the map is doubled
-        empty.getFailureReasons().forEach((k, v) -> assertThat(v, equalTo(full.getFailureReasons().get(k) * 2)));
-        assertThat(empty.getTook().count(), equalTo(full.getTook().count() * 2));
-        assertThat(empty.getTookMrtTrue().count(), equalTo(full.getTookMrtTrue().count() * 2));
-        assertThat(empty.getTookMrtFalse().count(), equalTo(full.getTookMrtFalse().count() * 2));
+        assertBasicCounts(empty, full.getTotalCount() * 2, full.getSuccessCount() * 2);
+        assertMapValuesDoubled(empty.getFailureReasons(), full.getFailureReasons());
+        assertTookMetrics(empty, full.getTook().count() * 2);
         assertThat(empty.getSearchCountWithSkippedRemotes(), equalTo(full.getSearchCountWithSkippedRemotes() * 2));
         assertThat(empty.getRemotesPerSearchMax(), equalTo(full.getRemotesPerSearchMax()));
         assertThat(empty.getRemotesPerSearchAvg(), closeTo(full.getRemotesPerSearchAvg(), 0.01));
-        empty.getFeatureCounts().forEach((k, v) -> assertThat(v, equalTo(full.getFeatureCounts().get(k) * 2)));
-        empty.getClientCounts().forEach((k, v) -> assertThat(v, equalTo(full.getClientCounts().get(k) * 2)));
-        empty.getByRemoteCluster().forEach((k, v) -> {
-            assertThat(v.getCount(), equalTo(full.getByRemoteCluster().get(k).getCount() * 2));
-            assertThat(v.getSkippedCount(), equalTo(full.getByRemoteCluster().get(k).getSkippedCount() * 2));
-            assertThat(v.getTook().count(), equalTo(full.getByRemoteCluster().get(k).getTook().count() * 2));
-        });
+        assertMapValuesDoubled(empty.getFeatureCounts(), full.getFeatureCounts());
+        assertMapValuesDoubled(empty.getClientCounts(), full.getClientCounts());
+        assertPerClusterTelemetryDoubled(empty.getByRemoteCluster(), full.getByRemoteCluster());
     }
 
     public void testAddTwo() {
@@ -213,15 +272,8 @@ public class CCSTelemetrySnapshotTests extends AbstractWireSerializingTestCase<C
 
         empty.add(full);
         empty.add(full2);
-        assertThat(empty.getTotalCount(), equalTo(full.getTotalCount() + full2.getTotalCount()));
-        assertThat(empty.getSuccessCount(), equalTo(full.getSuccessCount() + full2.getSuccessCount()));
-        empty.getFailureReasons()
-            .forEach(
-                (k, v) -> assertThat(
-                    v,
-                    equalTo(full.getFailureReasons().getOrDefault(k, 0L) + full2.getFailureReasons().getOrDefault(k, 0L))
-                )
-            );
+        assertBasicCounts(empty, full.getTotalCount() + full2.getTotalCount(), full.getSuccessCount() + full2.getSuccessCount());
+        assertMapValuesAdded(empty.getFailureReasons(), full.getFailureReasons(), full2.getFailureReasons());
         assertThat(empty.getTook().count(), equalTo(full.getTook().count() + full2.getTook().count()));
         assertThat(empty.getTookMrtTrue().count(), equalTo(full.getTookMrtTrue().count() + full2.getTookMrtTrue().count()));
         assertThat(empty.getTookMrtFalse().count(), equalTo(full.getTookMrtFalse().count() + full2.getTookMrtFalse().count()));
@@ -233,42 +285,9 @@ public class CCSTelemetrySnapshotTests extends AbstractWireSerializingTestCase<C
         double expectedAvg = (full.getRemotesPerSearchAvg() * full.getTotalCount() + full2.getRemotesPerSearchAvg() * full2.getTotalCount())
             / empty.getTotalCount();
         assertThat(empty.getRemotesPerSearchAvg(), closeTo(expectedAvg, 0.01));
-        empty.getFeatureCounts()
-            .forEach(
-                (k, v) -> assertThat(v, equalTo(full.getFeatureCounts().getOrDefault(k, 0L) + full2.getFeatureCounts().getOrDefault(k, 0L)))
-            );
-        empty.getClientCounts()
-            .forEach(
-                (k, v) -> assertThat(v, equalTo(full.getClientCounts().getOrDefault(k, 0L) + full2.getClientCounts().getOrDefault(k, 0L)))
-            );
-        PerClusterCCSTelemetry zeroDummy = new PerClusterCCSTelemetry();
-        empty.getByRemoteCluster().forEach((k, v) -> {
-            assertThat(
-                v.getCount(),
-                equalTo(
-                    full.getByRemoteCluster().getOrDefault(k, zeroDummy).getCount() + full2.getByRemoteCluster()
-                        .getOrDefault(k, zeroDummy)
-                        .getCount()
-                )
-            );
-            assertThat(
-                v.getSkippedCount(),
-                equalTo(
-                    full.getByRemoteCluster().getOrDefault(k, zeroDummy).getSkippedCount() + full2.getByRemoteCluster()
-                        .getOrDefault(k, zeroDummy)
-                        .getSkippedCount()
-                )
-            );
-            assertThat(
-                v.getTook().count(),
-                equalTo(
-                    full.getByRemoteCluster().getOrDefault(k, zeroDummy).getTook().count() + full2.getByRemoteCluster()
-                        .getOrDefault(k, zeroDummy)
-                        .getTook()
-                        .count()
-                )
-            );
-        });
+        assertMapValuesAdded(empty.getFeatureCounts(), full.getFeatureCounts(), full2.getFeatureCounts());
+        assertMapValuesAdded(empty.getClientCounts(), full.getClientCounts(), full2.getClientCounts());
+        assertPerClusterTelemetryAdded(empty.getByRemoteCluster(), full.getByRemoteCluster(), full2.getByRemoteCluster());
     }
 
     private LongMetricValue manyValuesHistogram(long startingWith) {
diff --git a/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSUsageTelemetryTests.java b/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSUsageTelemetryTests.java
index 5eb2224e..622d843d 100644
--- a/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSUsageTelemetryTests.java
+++ b/server/src/test/java/org/elasticsearch/action/admin/cluster/stats/CCSUsageTelemetryTests.java
@@ -23,6 +23,51 @@ import static org.hamcrest.Matchers.greaterThan;
 
 public class CCSUsageTelemetryTests extends ESTestCase {
 
+    private void assertBasicCounts(CCSTelemetrySnapshot snapshot, long expectedTotal, long expectedSuccess) {
+        assertThat(snapshot.getTotalCount(), equalTo(expectedTotal));
+        assertThat(snapshot.getSuccessCount(), equalTo(expectedSuccess));
+    }
+
+    private void assertFeatureCounts(CCSTelemetrySnapshot snapshot, long expectedAsyncCount, long expectedMrtCount) {
+        assertThat(snapshot.getFeatureCounts().getOrDefault(ASYNC_FEATURE, 0L), equalTo(expectedAsyncCount));
+        assertThat(snapshot.getFeatureCounts().getOrDefault(MRT_FEATURE, 0L), equalTo(expectedMrtCount));
+    }
+
+    private void assertMrtMetrics(CCSTelemetrySnapshot snapshot, boolean minimizeRoundTrips, long took) {
+        if (minimizeRoundTrips) {
+            assertThat(snapshot.getTookMrtTrue().count(), equalTo(1L));
+            assertThat(snapshot.getTookMrtTrue().avg(), greaterThan(0L));
+            assertThat(snapshot.getTookMrtTrue().avg(), closeTo(took));
+            assertThat(snapshot.getTookMrtFalse().count(), equalTo(0L));
+            assertThat(snapshot.getTookMrtFalse().max(), equalTo(0L));
+        } else {
+            assertThat(snapshot.getTookMrtFalse().count(), equalTo(1L));
+            assertThat(snapshot.getTookMrtFalse().avg(), greaterThan(0L));
+            assertThat(snapshot.getTookMrtFalse().avg(), closeTo(took));
+            assertThat(snapshot.getTookMrtTrue().count(), equalTo(0L));
+            assertThat(snapshot.getTookMrtTrue().max(), equalTo(0L));
+        }
+    }
+
+    private void assertPerClusterTelemetry(
+        CCSTelemetrySnapshot.PerClusterCCSTelemetry telemetry,
+        long expectedCount,
+        long expectedSkippedCount,
+        long tookValue
+    ) {
+        assertNotNull(telemetry);
+        assertThat(telemetry.getCount(), equalTo(expectedCount));
+        assertThat(telemetry.getSkippedCount(), equalTo(expectedSkippedCount));
+        assertThat(telemetry.getTook().count(), equalTo(expectedCount));
+        assertThat(telemetry.getTook().avg(), greaterThan(0L));
+        assertThat(telemetry.getTook().avg(), closeTo(tookValue));
+    }
+
+    private void assertFailureReasons(CCSTelemetrySnapshot snapshot, CCSUsageTelemetry.Result result, long expectedCount) {
+        assertThat(snapshot.getFailureReasons().size(), equalTo(1));
+        assertThat(snapshot.getFailureReasons().get(result.getName()), equalTo(expectedCount));
+    }
+
     public void testSuccessfulSearchResults() {
         CCSUsageTelemetry ccsUsageHolder = new CCSUsageTelemetry();
 
@@ -65,53 +110,22 @@ public class CCSUsageTelemetryTests extends ESTestCase {
 
             CCSTelemetrySnapshot snapshot = ccsUsageHolder.getCCSTelemetrySnapshot();
 
-            assertThat(snapshot.getTotalCount(), equalTo(1L));
-            assertThat(snapshot.getSuccessCount(), equalTo(1L));
-            assertThat(snapshot.getFeatureCounts().getOrDefault(ASYNC_FEATURE, 0L), equalTo(expectedAsyncCount));
-            assertThat(snapshot.getFeatureCounts().getOrDefault(MRT_FEATURE, 0L), equalTo(expectedMinRTCount));
+            assertBasicCounts(snapshot, 1L, 1L);
+            assertFeatureCounts(snapshot, expectedAsyncCount, expectedMinRTCount);
             assertThat(snapshot.getSearchCountWithSkippedRemotes(), equalTo(expectedSearchesWithSkippedRemotes));
             assertThat(snapshot.getTook().avg(), greaterThan(0L));
             // Expect it to be within 1% of the actual value
             assertThat(snapshot.getTook().avg(), closeTo(took1));
             assertThat(snapshot.getTook().max(), closeTo(took1));
-            if (minimizeRoundTrips) {
-                assertThat(snapshot.getTookMrtTrue().count(), equalTo(1L));
-                assertThat(snapshot.getTookMrtTrue().avg(), greaterThan(0L));
-                assertThat(snapshot.getTookMrtTrue().avg(), closeTo(took1));
-                assertThat(snapshot.getTookMrtFalse().count(), equalTo(0L));
-                assertThat(snapshot.getTookMrtFalse().max(), equalTo(0L));
-            } else {
-                assertThat(snapshot.getTookMrtFalse().count(), equalTo(1L));
-                assertThat(snapshot.getTookMrtFalse().avg(), greaterThan(0L));
-                assertThat(snapshot.getTookMrtFalse().avg(), closeTo(took1));
-                assertThat(snapshot.getTookMrtTrue().count(), equalTo(0L));
-                assertThat(snapshot.getTookMrtTrue().max(), equalTo(0L));
-            }
+            assertMrtMetrics(snapshot, minimizeRoundTrips, took1);
             // We currently don't count unknown clients
             assertThat(snapshot.getClientCounts().size(), equalTo(0));
 
             // per cluster telemetry asserts
-
             var telemetryByCluster = snapshot.getByRemoteCluster();
             assertThat(telemetryByCluster.size(), equalTo(2));
-            var localClusterTelemetry = telemetryByCluster.get("(local)");
-            assertNotNull(localClusterTelemetry);
-            assertThat(localClusterTelemetry.getCount(), equalTo(1L));
-            assertThat(localClusterTelemetry.getSkippedCount(), equalTo(0L));
-            assertThat(localClusterTelemetry.getTook().count(), equalTo(1L));
-            assertThat(localClusterTelemetry.getTook().avg(), greaterThan(0L));
-            assertThat(localClusterTelemetry.getTook().avg(), closeTo(tookLocal));
-            // assertThat(localClusterTelemetry.getTook().max(), greaterThanOrEqualTo(tookLocal));
-
-            var remote1ClusterTelemetry = telemetryByCluster.get("remote1");
-            assertNotNull(remote1ClusterTelemetry);
-            assertThat(remote1ClusterTelemetry.getCount(), equalTo(1L));
-            assertThat(remote1ClusterTelemetry.getSkippedCount(), equalTo(expectedSearchesWithSkippedRemotes));
-            assertThat(remote1ClusterTelemetry.getTook().avg(), greaterThan(0L));
-            assertThat(remote1ClusterTelemetry.getTook().count(), equalTo(1L));
-            assertThat(remote1ClusterTelemetry.getTook().avg(), greaterThan(0L));
-            assertThat(remote1ClusterTelemetry.getTook().avg(), closeTo(took1Remote1));
-            // assertThat(remote1ClusterTelemetry.getTook().max(), greaterThanOrEqualTo(took1Remote1));
+            assertPerClusterTelemetry(telemetryByCluster.get("(local)"), 1L, 0L, tookLocal);
+            assertPerClusterTelemetry(telemetryByCluster.get("remote1"), 1L, expectedSearchesWithSkippedRemotes, took1Remote1);
         }
 
         // second search
@@ -143,21 +157,17 @@ public class CCSUsageTelemetryTests extends ESTestCase {
 
             CCSTelemetrySnapshot snapshot = ccsUsageHolder.getCCSTelemetrySnapshot();
 
-            assertThat(snapshot.getTotalCount(), equalTo(2L));
-            assertThat(snapshot.getSuccessCount(), equalTo(2L));
-            assertThat(snapshot.getFeatureCounts().getOrDefault(ASYNC_FEATURE, 0L), equalTo(expectedAsyncCount));
-            assertThat(snapshot.getFeatureCounts().getOrDefault(MRT_FEATURE, 0L), equalTo(expectedMinRTCount));
+            assertBasicCounts(snapshot, 2L, 2L);
+            assertFeatureCounts(snapshot, expectedAsyncCount, expectedMinRTCount);
             assertThat(snapshot.getSearchCountWithSkippedRemotes(), equalTo(expectedSearchesWithSkippedRemotes));
             assertThat(snapshot.getTook().avg(), greaterThan(0L));
             assertThat(snapshot.getTook().avg(), closeTo((took1 + took2) / 2));
-            // assertThat(snapshot.getTook().max(), greaterThanOrEqualTo(Math.max(took1, took2)));
 
             // Counting only known clients
             assertThat(snapshot.getClientCounts().get("kibana"), equalTo(1L));
             assertThat(snapshot.getClientCounts().size(), equalTo(1));
 
             // per cluster telemetry asserts
-
             var telemetryByCluster = snapshot.getByRemoteCluster();
             assertThat(telemetryByCluster.size(), equalTo(2));
             var localClusterTelemetry = telemetryByCluster.get("(local)");
@@ -174,7 +184,6 @@ public class CCSUsageTelemetryTests extends ESTestCase {
             assertThat(remote1ClusterTelemetry.getTook().count(), equalTo(2L));
             assertThat(remote1ClusterTelemetry.getTook().avg(), greaterThan(0L));
             assertThat(remote1ClusterTelemetry.getTook().avg(), closeTo((took1Remote1 + took2Remote1) / 2));
-            // assertThat(remote1ClusterTelemetry.getTook().max(), greaterThanOrEqualTo(Math.max(took1Remote1, took2Remote1)));
         }
     }
 
@@ -241,15 +250,12 @@ public class CCSUsageTelemetryTests extends ESTestCase {
 
             CCSTelemetrySnapshot snapshot = ccsUsageHolder.getCCSTelemetrySnapshot();
 
-            assertThat(snapshot.getTotalCount(), equalTo(1L));
-            assertThat(snapshot.getSuccessCount(), equalTo(0L));
+            assertBasicCounts(snapshot, 1L, 0L);
             assertThat(snapshot.getSearchCountWithSkippedRemotes(), equalTo(skippedRemote ? 1L : 0L));
             assertThat(snapshot.getTook().count(), equalTo(0L));
-            assertThat(snapshot.getFailureReasons().size(), equalTo(1));
-            assertThat(snapshot.getFailureReasons().get(CANCELED.getName()), equalTo(1L));
+            assertFailureReasons(snapshot, CANCELED, 1L);
             // still counting features on failure
-            assertThat(snapshot.getFeatureCounts().getOrDefault(ASYNC_FEATURE, 0L), equalTo(async ? 1L : 0L));
-            assertThat(snapshot.getFeatureCounts().getOrDefault(MRT_FEATURE, 0L), equalTo(minimizeRoundTrips ? 1L : 0L));
+            assertFeatureCounts(snapshot, async ? 1L : 0L, minimizeRoundTrips ? 1L : 0L);
         }
 
         // second search
@@ -267,11 +273,9 @@ public class CCSUsageTelemetryTests extends ESTestCase {
 
             CCSTelemetrySnapshot snapshot = ccsUsageHolder.getCCSTelemetrySnapshot();
 
-            assertThat(snapshot.getTotalCount(), equalTo(2L));
-            assertThat(snapshot.getSuccessCount(), equalTo(0L));
+            assertBasicCounts(snapshot, 2L, 0L);
             assertThat(snapshot.getTook().count(), equalTo(0L));
-            assertThat(snapshot.getFailureReasons().size(), equalTo(1));
-            assertThat(snapshot.getFailureReasons().get(CANCELED.getName()), equalTo(2L));
+            assertFailureReasons(snapshot, CANCELED, 2L);
             assertThat(snapshot.getClientCounts().get("kibana"), equalTo(1L));
         }
     }