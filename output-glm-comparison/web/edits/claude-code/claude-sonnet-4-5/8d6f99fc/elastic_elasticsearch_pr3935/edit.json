{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 3935,
  "base_commit": "60550e4cc27bd11488540d911081794d69434478",
  "runner": "claude-code",
  "model": "claude-sonnet-4-5",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 221621,
  "patch_unified": "diff --git a/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java b/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java\nindex 67769a6..2898190 100644\n--- a/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java\n+++ b/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java\n@@ -363,8 +363,10 @@ public class ImmutableSettings implements Settings {\n     @Override\n     public String[] getAsArray(String settingPrefix, String[] defaultArray, Boolean commaDelimited) throws SettingsException {\n         List<String> result = Lists.newArrayList();\n+        boolean settingPresent = false;\n \n         if (get(settingPrefix) != null) {\n+            settingPresent = true;\n             if (commaDelimited) {\n                 String[] strings = Strings.splitStringByCommaToArray(get(settingPrefix));\n                 if (strings.length > 0) {\n@@ -383,9 +385,10 @@ public class ImmutableSettings implements Settings {\n             if (value == null) {\n                 break;\n             }\n+            settingPresent = true;\n             result.add(value.trim());\n         }\n-        if (result.isEmpty()) {\n+        if (result.isEmpty() && !settingPresent) {\n             return defaultArray;\n         }\n         return result.toArray(new String[result.size()]);\ndiff --git a/src/test/java/org/elasticsearch/common/settings/ImmutableSettingsTests.java b/src/test/java/org/elasticsearch/common/settings/ImmutableSettingsTests.java\nindex 145b936..68a649d 100644\n--- a/src/test/java/org/elasticsearch/common/settings/ImmutableSettingsTests.java\n+++ b/src/test/java/org/elasticsearch/common/settings/ImmutableSettingsTests.java\n@@ -120,4 +120,31 @@ public class ImmutableSettingsTests extends ElasticsearchTestCase{\n                 .build();\n         assertThat(settings.get(\"setting1\"), is(nullValue()));\n     }\n+\n+    @Test\n+    public void testGetAsArrayWithEmptyString() {\n+        // Test that an empty string returns an empty array (allows resetting)\n+        Settings settings = settingsBuilder()\n+                .put(\"array.empty\", \"\")\n+                .put(\"array.withvalues\", \"value1,value2\")\n+                .build();\n+\n+        // Empty string should return empty array, not default\n+        String[] emptyResult = settings.getAsArray(\"array.empty\", new String[]{\"default\"});\n+        assertThat(emptyResult, notNullValue());\n+        assertThat(emptyResult.length, equalTo(0));\n+\n+        // Values should return the values\n+        String[] valuesResult = settings.getAsArray(\"array.withvalues\", new String[]{\"default\"});\n+        assertThat(valuesResult, notNullValue());\n+        assertThat(valuesResult.length, equalTo(2));\n+        assertThat(valuesResult[0], equalTo(\"value1\"));\n+        assertThat(valuesResult[1], equalTo(\"value2\"));\n+\n+        // Non-existent key should return default\n+        String[] defaultResult = settings.getAsArray(\"array.nonexistent\", new String[]{\"default\"});\n+        assertThat(defaultResult, notNullValue());\n+        assertThat(defaultResult.length, equalTo(1));\n+        assertThat(defaultResult[0], equalTo(\"default\"));\n+    }\n }",
  "logs_path": "claude-code/claude-sonnet-4-5/8d6f99fc/elastic_elasticsearch_pr3935/logs.jsonl",
  "errors": [],
  "edit_run_id": "8d6f99fc",
  "test_label": "v1-rollouts-1-3-sonnet4.5"
}