{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 134754,
  "base_commit": "d70e2bd0d84d610b8ad101288141196261ad7628",
  "runner": "claude-code",
  "model": "claude-sonnet-4-5",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 105794,
  "patch_unified": "diff --git a/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java b/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java\nindex 3bc2fde3..c7ecb6c7 100644\n--- a/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java\n+++ b/qa/lucene-index-compatibility/src/javaRestTest/java/org/elasticsearch/lucene/FullClusterRestartSystemIndexCompatibilityIT.java\n@@ -49,7 +49,10 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n         final String asyncSearchIndex = \".async-search\";\n         final int numDocs = 2431;\n \n-        final Request asyncSearchRequest = new Request(\"POST\", \"/\" + index + \"/_async_search?size=100&keep_on_completion=true\");\n+        final Request asyncSearchRequest = new Request(\n+            \"POST\",\n+            \"/\" + index + \"/_async_search?size=100&keep_on_completion=true&wait_for_completion_timeout=10s\"\n+        );\n \n         if (isFullyUpgradedTo(VERSION_MINUS_2)) {\n             createIndex(\n@@ -67,7 +70,7 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n             String asyncId = searchAsyncAndStoreId(asyncSearchRequest, \"n-2_id\");\n             ensureGreen(asyncSearchIndex);\n \n-            assertAsyncSearchHitCount(asyncId, numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(asyncId, numDocs));\n             assertBusy(() -> assertDocCountNoWarnings(client(), asyncSearchIndex, 1));\n             assertThat(indexVersion(asyncSearchIndex, true), equalTo(VERSION_MINUS_2));\n             return;\n@@ -76,7 +79,7 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n         if (isFullyUpgradedTo(VERSION_MINUS_1)) {\n             // check .async-search index is readable\n             assertThat(indexVersion(asyncSearchIndex, true), equalTo(VERSION_MINUS_2));\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs));\n \n             // migrate system indices\n             Request migrateRequest = new Request(\"POST\", \"/_migration/system_features\");\n@@ -99,11 +102,11 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n             }, 30, TimeUnit.SECONDS);\n \n             // check search results from n-2 search are still readable\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs));\n \n             // perform new async search and check its readable\n             String asyncId = searchAsyncAndStoreId(asyncSearchRequest, \"n-1_id\");\n-            assertAsyncSearchHitCount(asyncId, numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(asyncId, numDocs));\n             assertBusy(() -> assertDocCountNoWarnings(client(), asyncSearchIndex, 2));\n \n             // in order to move to current version we need write block for n-2 index\n@@ -112,12 +115,12 @@ public class FullClusterRestartSystemIndexCompatibilityIT extends FullClusterRes\n \n         if (isFullyUpgradedTo(VERSION_CURRENT)) {\n             assertThat(indexVersion(index, true), equalTo(VERSION_MINUS_2));\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs);\n-            assertAsyncSearchHitCount(async_search_ids.get(\"n-1_id\"), numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-2_id\"), numDocs));\n+            assertBusy(() -> assertAsyncSearchHitCount(async_search_ids.get(\"n-1_id\"), numDocs));\n \n             // check system index is still writeable\n             String asyncId = searchAsyncAndStoreId(asyncSearchRequest, \"n_id\");\n-            assertAsyncSearchHitCount(asyncId, numDocs);\n+            assertBusy(() -> assertAsyncSearchHitCount(asyncId, numDocs));\n             assertBusy(() -> assertDocCountNoWarnings(client(), asyncSearchIndex, 3));\n         }\n ",
  "logs_path": "claude-code/claude-sonnet-4-5/8d6f99fc/elastic_elasticsearch_pr134754/logs.jsonl",
  "errors": [],
  "edit_run_id": "8d6f99fc",
  "test_label": "v1-rollouts-1-3-sonnet4.5"
}