{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 114863,
  "base_commit": "4fa8485a26d5d57e52117ae8d9f89491853703d9",
  "runner": "factory",
  "model": "claude-sonnet-4-5-20250929",
  "timeout_s": 7200,
  "status": "success",
  "elapsed_ms": 1210419,
  "patch_unified": "diff --git a/x-pack/plugin/esql-core/src/main/java/org/elasticsearch/xpack/esql/core/type/DataType.java b/x-pack/plugin/esql-core/src/main/java/org/elasticsearch/xpack/esql/core/type/DataType.java\nindex b23703c6..6001bda0 100644\n--- a/x-pack/plugin/esql-core/src/main/java/org/elasticsearch/xpack/esql/core/type/DataType.java\n+++ b/x-pack/plugin/esql-core/src/main/java/org/elasticsearch/xpack/esql/core/type/DataType.java\n@@ -266,6 +266,8 @@ public enum DataType {\n         .sorted(Comparator.comparing(DataType::typeName))\n         .toList();\n \n+    private static final Collection<DataType> STRING_TYPES = TYPES.stream().filter(DataType::isString).toList();\n+\n     private static final Map<String, DataType> NAME_TO_TYPE = TYPES.stream().collect(toUnmodifiableMap(DataType::typeName, t -> t));\n \n     private static final Map<String, DataType> ES_TO_TYPE;\n@@ -292,6 +294,10 @@ public enum DataType {\n         return TYPES;\n     }\n \n+    public static Collection<DataType> stringTypes() {\n+        return STRING_TYPES;\n+    }\n+\n     /**\n      * Resolve a type from a name. This name is sometimes user supplied,\n      * like in the case of {@code ::<typename>} and is sometimes the name\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/CountDistinct.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/CountDistinct.java\nindex 2550e5bd..756000df 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/CountDistinct.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/CountDistinct.java\n@@ -209,7 +209,7 @@ public class CountDistinct extends AggregateFunction implements OptionalArgument\n         if (type == DataType.DOUBLE) {\n             return new CountDistinctDoubleAggregatorFunctionSupplier(inputChannels, precision);\n         }\n-        if (type == DataType.KEYWORD || type == DataType.IP || type == DataType.VERSION || type == DataType.TEXT) {\n+        if (DataType.isString(type) || type == DataType.IP || type == DataType.VERSION) {\n             return new CountDistinctBytesRefAggregatorFunctionSupplier(inputChannels, precision);\n         }\n         throw EsqlIllegalArgumentException.illegalDataType(type);\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Max.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Max.java\nindex 47d74c71..6119b2ce 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Max.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Max.java\n@@ -128,7 +128,7 @@ public class Max extends AggregateFunction implements ToAggregator, SurrogateExp\n         if (type == DataType.IP) {\n             return new MaxIpAggregatorFunctionSupplier(inputChannels);\n         }\n-        if (type == DataType.VERSION || type == DataType.KEYWORD || type == DataType.TEXT) {\n+        if (type == DataType.VERSION || DataType.isString(type)) {\n             return new MaxBytesRefAggregatorFunctionSupplier(inputChannels);\n         }\n         throw EsqlIllegalArgumentException.illegalDataType(type);\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Min.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Min.java\nindex ce69decc..a1492f79 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Min.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/aggregate/Min.java\n@@ -128,7 +128,7 @@ public class Min extends AggregateFunction implements ToAggregator, SurrogateExp\n         if (type == DataType.IP) {\n             return new MinIpAggregatorFunctionSupplier(inputChannels);\n         }\n-        if (type == DataType.VERSION || type == DataType.KEYWORD || type == DataType.TEXT) {\n+        if (type == DataType.VERSION || DataType.isString(type)) {\n             return new MinBytesRefAggregatorFunctionSupplier(inputChannels);\n         }\n         throw EsqlIllegalArgumentException.illegalDataType(type);\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/AbstractConvertFunction.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/AbstractConvertFunction.java\nindex 5401fcf1..b3dc5882 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/AbstractConvertFunction.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/AbstractConvertFunction.java\n@@ -48,7 +48,7 @@ public abstract class AbstractConvertFunction extends UnaryScalarFunction {\n \n     // the numeric types convert functions need to handle; the other numeric types are converted upstream to one of these\n     private static final List<DataType> NUMERIC_TYPES = List.of(DataType.INTEGER, DataType.LONG, DataType.UNSIGNED_LONG, DataType.DOUBLE);\n-    public static final List<DataType> STRING_TYPES = DataType.types().stream().filter(DataType::isString).toList();\n+    public static final List<DataType> STRING_TYPES = DataType.stringTypes().stream().toList();\n \n     protected AbstractConvertFunction(Source source, Expression field) {\n         super(source, field);\ndiff --git a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InsensitiveEqualsMapper.java b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InsensitiveEqualsMapper.java\nindex d11f5c9b..f5704239 100644\n--- a/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InsensitiveEqualsMapper.java\n+++ b/x-pack/plugin/esql/src/main/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InsensitiveEqualsMapper.java\n@@ -34,7 +34,7 @@ public class InsensitiveEqualsMapper extends ExpressionMapper<InsensitiveEquals>\n \n         var leftEval = toEvaluator(bc.left(), layout);\n         var rightEval = toEvaluator(bc.right(), layout);\n-        if (leftType == DataType.KEYWORD || leftType == DataType.TEXT) {\n+        if (DataType.isString(leftType)) {\n             if (bc.right().foldable() && DataType.isString(rightType)) {\n                 BytesRef rightVal = BytesRefs.toBytesRef(bc.right().fold());\n                 Automaton automaton = InsensitiveEquals.automaton(rightVal);\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/AbstractFunctionTestCase.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/AbstractFunctionTestCase.java\nindex ca9950a4..dd44e79b 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/AbstractFunctionTestCase.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/AbstractFunctionTestCase.java\n@@ -1287,7 +1287,7 @@ public abstract class AbstractFunctionTestCase extends ESTestCase {\n      * All string types (keyword, text, match_only_text, etc).\n      */\n     protected static DataType[] strings() {\n-        return DataType.types().stream().filter(DataType::isString).toArray(DataType[]::new);\n+        return DataType.stringTypes().stream().toArray(DataType[]::new);\n     }\n \n     /**\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/MatchTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/MatchTests.java\nindex d37bc896..bd29ccc8 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/MatchTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/MatchTests.java\n@@ -21,6 +21,7 @@ import org.elasticsearch.xpack.esql.expression.function.TestCaseSupplier;\n import org.hamcrest.Matcher;\n \n import java.util.Arrays;\n+import java.util.HashSet;\n import java.util.LinkedList;\n import java.util.List;\n import java.util.Set;\n@@ -37,7 +38,7 @@ public class MatchTests extends AbstractFunctionTestCase {\n \n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\n-        Set<DataType> supported = Set.of(DataType.KEYWORD, DataType.TEXT);\n+        Set<DataType> supported = new HashSet<>(DataType.stringTypes());\n         List<Set<DataType>> supportedPerPosition = List.of(supported, supported);\n         List<TestCaseSupplier> suppliers = new LinkedList<>();\n         for (DataType fieldType : validStringDataTypes()) {\n@@ -68,7 +69,7 @@ public class MatchTests extends AbstractFunctionTestCase {\n     }\n \n     private static List<DataType> validStringDataTypes() {\n-        return Arrays.stream(DataType.values()).filter(DataType::isString).toList();\n+        return DataType.stringTypes().stream().toList();\n     }\n \n     private static TestCaseSupplier.TestCase testCase(\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/QueryStringTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/QueryStringTests.java\nindex 2dfdb05e..926a4b96 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/QueryStringTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/fulltext/QueryStringTests.java\n@@ -36,7 +36,7 @@ public class QueryStringTests extends AbstractFunctionTestCase {\n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\n         List<TestCaseSupplier> suppliers = new LinkedList<>();\n-        for (DataType strType : Arrays.stream(DataType.values()).filter(DataType::isString).toList()) {\n+        for (DataType strType : DataType.stringTypes()) {\n             suppliers.add(\n                 new TestCaseSupplier(\n                     \"<\" + strType + \">\",\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/CategorizeTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/CategorizeTests.java\nindex f93389d5..23245ce4 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/CategorizeTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/grouping/CategorizeTests.java\n@@ -31,7 +31,7 @@ public class CategorizeTests extends AbstractScalarFunctionTestCase {\n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\n         List<TestCaseSupplier> suppliers = new ArrayList<>();\n-        for (DataType dataType : List.of(DataType.KEYWORD, DataType.TEXT)) {\n+        for (DataType dataType : DataType.stringTypes()) {\n             suppliers.add(\n                 new TestCaseSupplier(\n                     \"text with \" + dataType.typeName(),\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianPointTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianPointTests.java\nindex 9548b047..bd9b3d98 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianPointTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianPointTests.java\n@@ -55,7 +55,7 @@ public class ToCartesianPointTests extends AbstractScalarFunctionTestCase {\n             }\n         );\n         // strings that are cartesian point representations\n-        for (DataType dt : List.of(DataType.KEYWORD, DataType.TEXT)) {\n+        for (DataType dt : DataType.stringTypes()) {\n             TestCaseSupplier.unary(\n                 suppliers,\n                 evaluatorName.apply(\"FromString\"),\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianShapeTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianShapeTests.java\nindex 5784c355..cdaf0e8c 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianShapeTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToCartesianShapeTests.java\n@@ -56,7 +56,7 @@ public class ToCartesianShapeTests extends AbstractScalarFunctionTestCase {\n             }\n         );\n         // strings that are cartesian_shape representations\n-        for (DataType dt : List.of(DataType.KEYWORD, DataType.TEXT)) {\n+        for (DataType dt : DataType.stringTypes()) {\n             TestCaseSupplier.unary(\n                 suppliers,\n                 evaluatorName.apply(\"FromString\"),\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoPointTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoPointTests.java\nindex 445c4b8f..6e97451d 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoPointTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoPointTests.java\n@@ -49,7 +49,7 @@ public class ToGeoPointTests extends AbstractScalarFunctionTestCase {\n             );\n         });\n         // strings that are geo point representations\n-        for (DataType dt : List.of(DataType.KEYWORD, DataType.TEXT)) {\n+        for (DataType dt : DataType.stringTypes()) {\n             TestCaseSupplier.unary(\n                 suppliers,\n                 evaluatorName.apply(\"FromString\"),\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoShapeTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoShapeTests.java\nindex 38d871b1..e32457e9 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoShapeTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/convert/ToGeoShapeTests.java\n@@ -50,7 +50,7 @@ public class ToGeoShapeTests extends AbstractScalarFunctionTestCase {\n             );\n         });\n         // strings that are geo_shape representations\n-        for (DataType dt : List.of(DataType.KEYWORD, DataType.TEXT)) {\n+        for (DataType dt : DataType.stringTypes()) {\n             TestCaseSupplier.unary(\n                 suppliers,\n                 evaluatorName.apply(\"FromString\"),\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ConcatTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ConcatTests.java\nindex bbe92ae4..72ffff25 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ConcatTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ConcatTests.java\n@@ -23,6 +23,7 @@ import org.elasticsearch.xpack.esql.expression.function.TestCaseSupplier;\n \n import java.util.ArrayList;\n import java.util.HashMap;\n+import java.util.HashSet;\n import java.util.List;\n import java.util.Map;\n import java.util.Objects;\n@@ -48,7 +49,8 @@ public class ConcatTests extends AbstractScalarFunctionTestCase {\n         for (int length = 4; length < 100; length++) {\n             suppliers(suppliers, length);\n         }\n-        Set<DataType> supported = Set.of(DataType.NULL, DataType.KEYWORD, DataType.TEXT);\n+        Set<DataType> supported = new HashSet<>(DataType.stringTypes());\n+        supported.add(DataType.NULL);\n         List<Set<DataType>> supportedPerPosition = List.of(supported, supported);\n         for (DataType lhs : DataType.types()) {\n             if (lhs == DataType.NULL || DataType.isRepresentable(lhs) == false) {\n@@ -58,8 +60,8 @@ public class ConcatTests extends AbstractScalarFunctionTestCase {\n                 if (rhs == DataType.NULL || DataType.isRepresentable(rhs) == false) {\n                     continue;\n                 }\n-                boolean lhsIsString = lhs == DataType.KEYWORD || lhs == DataType.TEXT;\n-                boolean rhsIsString = rhs == DataType.KEYWORD || rhs == DataType.TEXT;\n+                boolean lhsIsString = DataType.isString(lhs);\n+                boolean rhsIsString = DataType.isString(rhs);\n                 if (lhsIsString && rhsIsString) {\n                     continue;\n                 }\n@@ -101,8 +103,8 @@ public class ConcatTests extends AbstractScalarFunctionTestCase {\n \n     private static void add(List<TestCaseSupplier> suppliers, String name, int length, Supplier<String> valueSupplier) {\n         Map<Integer, List<List<DataType>>> permutations = new HashMap<Integer, List<List<DataType>>>();\n-        List<DataType> supportedDataTypes = List.of(DataType.KEYWORD, DataType.TEXT);\n-        permutations.put(0, List.of(List.of(DataType.KEYWORD), List.of(DataType.TEXT)));\n+        List<DataType> supportedDataTypes = DataType.stringTypes().stream().toList();\n+        permutations.put(0, supportedDataTypes.stream().map(List::of).toList());\n         for (int v = 0; v < length - 1; v++) {\n             List<List<DataType>> current = permutations.get(v);\n             List<List<DataType>> next = new ArrayList<>();\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/EndsWithTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/EndsWithTests.java\nindex 6d086e26..98d0db0d 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/EndsWithTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/EndsWithTests.java\n@@ -33,8 +33,8 @@ public class EndsWithTests extends AbstractScalarFunctionTestCase {\n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\n         List<TestCaseSupplier> suppliers = new LinkedList<>();\n-        for (DataType strType : Arrays.stream(DataType.values()).filter(DataType::isString).toList()) {\n-            for (DataType suffixType : Arrays.stream(DataType.values()).filter(DataType::isString).toList()) {\n+        for (DataType strType : DataType.stringTypes()) {\n+            for (DataType suffixType : DataType.stringTypes()) {\n                 suppliers.add(\n                     new TestCaseSupplier(\n                         \"<\" + strType + \">, empty <\" + suffixType + \">\",\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/LocateTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/LocateTests.java\nindex 207125be..5c6beaa5 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/LocateTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/LocateTests.java\n@@ -35,7 +35,7 @@ public class LocateTests extends AbstractScalarFunctionTestCase {\n         this.testCase = testCaseSupplier.get();\n     }\n \n-    private static final DataType[] STRING_TYPES = new DataType[] { DataType.KEYWORD, DataType.TEXT };\n+    private static final Collection<DataType> STRING_TYPES = DataType.stringTypes();\n \n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/RLikeTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/RLikeTests.java\nindex 5a34d850..4f8adf3a 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/RLikeTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/RLikeTests.java\n@@ -69,7 +69,7 @@ public class RLikeTests extends AbstractScalarFunctionTestCase {\n         casesForString(cases, \"6 bytes, 2 code points\", () -> \"❗️\", false, escapeString, optionalPattern);\n         casesForString(cases, \"100 random code points\", () -> randomUnicodeOfCodepointLength(100), true, escapeString, optionalPattern);\n         for (DataType type : DataType.types()) {\n-            if (type == DataType.KEYWORD || type == DataType.TEXT || type == DataType.NULL) {\n+            if (DataType.isString(type) || type == DataType.NULL) {\n                 continue;\n             }\n             if (DataType.isRepresentable(type) == false) {\n@@ -125,7 +125,7 @@ public class RLikeTests extends AbstractScalarFunctionTestCase {\n     }\n \n     private static void cases(List<TestCaseSupplier> cases, String title, Supplier<TextAndPattern> textAndPattern, boolean expected) {\n-        for (DataType type : new DataType[] { DataType.KEYWORD, DataType.TEXT }) {\n+        for (DataType type : DataType.stringTypes()) {\n             cases.add(new TestCaseSupplier(title + \" with \" + type.esType(), List.of(type, type, DataType.BOOLEAN), () -> {\n                 TextAndPattern v = textAndPattern.get();\n                 return new TestCaseSupplier.TestCase(\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ReverseTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ReverseTests.java\nindex 2873f18d..58d52cc0 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ReverseTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/ReverseTests.java\n@@ -33,7 +33,7 @@ public class ReverseTests extends AbstractScalarFunctionTestCase {\n     public static Iterable<Object[]> parameters() {\n         List<TestCaseSupplier> suppliers = new ArrayList<>();\n \n-        for (DataType stringType : new DataType[] { DataType.KEYWORD, DataType.TEXT }) {\n+        for (DataType stringType : DataType.stringTypes()) {\n             for (var supplier : TestCaseSupplier.stringCases(stringType)) {\n                 suppliers.add(makeSupplier(supplier));\n             }\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/SplitTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/SplitTests.java\nindex b5560f37..414412fa 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/SplitTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/SplitTests.java\n@@ -42,7 +42,7 @@ public class SplitTests extends AbstractScalarFunctionTestCase {\n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\n         List<TestCaseSupplier> suppliers = new ArrayList<>();\n-        List<DataType> supportedDataTyes = List.of(DataType.KEYWORD, DataType.TEXT);\n+        List<DataType> supportedDataTyes = DataType.stringTypes().stream().toList();\n         for (DataType sType : supportedDataTyes) {\n             for (DataType dType : supportedDataTyes) {\n                 suppliers.add(new TestCaseSupplier(\"split test \" + sType.toString() + \" \" + dType.toString(), List.of(sType, dType), () -> {\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/StartsWithTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/StartsWithTests.java\nindex 8bc8cf31..bcee1559 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/StartsWithTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/StartsWithTests.java\n@@ -32,8 +32,8 @@ public class StartsWithTests extends AbstractScalarFunctionTestCase {\n     @ParametersFactory\n     public static Iterable<Object[]> parameters() {\n         List<TestCaseSupplier> suppliers = new ArrayList<>();\n-        for (DataType strType : Arrays.stream(DataType.values()).filter(DataType::isString).toList()) {\n-            for (DataType prefixType : Arrays.stream(DataType.values()).filter(DataType::isString).toList()) {\n+        for (DataType strType : DataType.stringTypes()) {\n+            for (DataType prefixType : DataType.stringTypes()) {\n                 suppliers.add(new TestCaseSupplier(List.of(strType, prefixType), () -> {\n                     String str = randomAlphaOfLength(5);\n                     String prefix = randomAlphaOfLength(5);\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/WildcardLikeTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/WildcardLikeTests.java\nindex 53b3a99f..737ccd4e 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/WildcardLikeTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/function/scalar/string/WildcardLikeTests.java\n@@ -53,7 +53,7 @@ public class WildcardLikeTests extends AbstractScalarFunctionTestCase {\n     }\n \n     private static void addCases(List<TestCaseSupplier> suppliers) {\n-        for (DataType type : new DataType[] { DataType.KEYWORD, DataType.TEXT }) {\n+        for (DataType type : DataType.stringTypes()) {\n             suppliers.add(new TestCaseSupplier(\" with \" + type.esType(), List.of(type, type), () -> {\n                 BytesRef str = new BytesRef(randomAlphaOfLength(5));\n                 String patternString = randomAlphaOfLength(2);\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InTests.java\nindex 2a1dfb09..a39cea30 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/expression/predicate/operator/comparison/InTests.java\n@@ -187,8 +187,8 @@ public class InTests extends AbstractFunctionTestCase {\n             );\n         }));\n \n-        for (DataType type1 : new DataType[] { DataType.KEYWORD, DataType.TEXT }) {\n-            for (DataType type2 : new DataType[] { DataType.KEYWORD, DataType.TEXT }) {\n+        for (DataType type1 : DataType.stringTypes()) {\n+            for (DataType type2 : DataType.stringTypes()) {\n                 if (type1 == type2 || items > 1) continue;\n                 suppliers.add(new TestCaseSupplier(type1 + \" \" + type2, List.of(type1, type2), () -> {\n                     List<Object> inlist = randomList(items, items, () -> randomLiteral(type1).value());\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/type/EsqlDataTypeConverterTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/type/EsqlDataTypeConverterTests.java\nindex 8ad08368..a9dfc834 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/type/EsqlDataTypeConverterTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/type/EsqlDataTypeConverterTests.java\n@@ -62,7 +62,7 @@ public class EsqlDataTypeConverterTests extends ESTestCase {\n     }\n \n     public void testCommonTypeStrings() {\n-        List<DataType> STRINGS = Arrays.stream(DataType.values()).filter(DataType::isString).toList();\n+        List<DataType> STRINGS = DataType.stringTypes().stream().toList();\n         for (DataType dataType1 : STRINGS) {\n             for (DataType dataType2 : DataType.values()) {\n                 if (dataType2 == NULL) {",
  "logs_path": "factory/claude-sonnet-4-5-20250929/074538b9/elastic_elasticsearch_pr114863/logs.jsonl",
  "errors": [],
  "edit_run_id": "074538b9",
  "test_label": "v0"
}