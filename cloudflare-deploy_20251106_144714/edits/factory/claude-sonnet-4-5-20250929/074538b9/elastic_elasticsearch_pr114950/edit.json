{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 114950,
  "base_commit": "0648ab8920bba04ae691fa1a74c73a1981c9a14d",
  "runner": "factory",
  "model": "claude-sonnet-4-5-20250929",
  "timeout_s": 7200,
  "status": "success",
  "elapsed_ms": 529858,
  "patch_unified": "diff --git a/server/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java b/server/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java\nindex cce4e0b5..b00ae85e 100644\n--- a/server/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java\n+++ b/server/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java\n@@ -19,6 +19,7 @@ import org.elasticsearch.common.ValidationException;\n import org.elasticsearch.common.io.stream.StreamInput;\n import org.elasticsearch.common.io.stream.StreamOutput;\n import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.logging.DeprecationCategory;\n import org.elasticsearch.common.logging.DeprecationLogger;\n import org.elasticsearch.common.util.CollectionUtils;\n import org.elasticsearch.common.xcontent.XContentHelper;\n@@ -1429,6 +1430,11 @@ public final class SearchSourceBuilder implements Writeable, ToXContentObject, R\n                     if (RANK_SUPPORTED == false) {\n                         throwUnknownKey(parser, token, currentFieldName);\n                     }\n+                    deprecationLogger.warn(\n+                        DeprecationCategory.API,\n+                        \"search_rank_field_deprecated\",\n+                        \"[rank] is deprecated and will be removed in a future version. Use [retriever] instead.\"\n+                    );\n                     if (parser.nextToken() != XContentParser.Token.FIELD_NAME) {\n                         throw new ParsingException(\n                             parser.getTokenLocation(),\n@@ -1636,6 +1642,11 @@ public final class SearchSourceBuilder implements Writeable, ToXContentObject, R\n                     if (RANK_SUPPORTED == false) {\n                         throwUnknownKey(parser, token, currentFieldName);\n                     }\n+                    deprecationLogger.warn(\n+                        DeprecationCategory.API,\n+                        \"search_sub_searches_field_deprecated\",\n+                        \"[sub_searches] is deprecated and will be removed in a future version. Use [retriever] instead.\"\n+                    );\n                     if (subSearchSourceBuilders.isEmpty() == false) {\n                         throw new IllegalArgumentException(\n                             \"cannot specify field [\" + currentFieldName + \"] and field [\" + QUERY_FIELD.getPreferredName() + \"]\"\ndiff --git a/server/src/test/java/org/elasticsearch/search/builder/SearchSourceBuilderTests.java b/server/src/test/java/org/elasticsearch/search/builder/SearchSourceBuilderTests.java\nindex 240a677f..e58f712b 100644\n--- a/server/src/test/java/org/elasticsearch/search/builder/SearchSourceBuilderTests.java\n+++ b/server/src/test/java/org/elasticsearch/search/builder/SearchSourceBuilderTests.java\n@@ -94,6 +94,19 @@ public class SearchSourceBuilderTests extends AbstractSearchTestCase {\n         try (XContentParser xParser = createParser(builder)) {\n             assertParseSearchSource(testSearchSourceBuilder, xParser);\n         }\n+        // Check if deprecation warnings should be present\n+        boolean hasSubSearches = testSearchSourceBuilder.subSearches().size() > 1;\n+        boolean hasRank = testSearchSourceBuilder.rankBuilder() != null;\n+        if (hasSubSearches && hasRank) {\n+            assertWarnings(\n+                \"[sub_searches] is deprecated and will be removed in a future version. Use [retriever] instead.\",\n+                \"[rank] is deprecated and will be removed in a future version. Use [retriever] instead.\"\n+            );\n+        } else if (hasSubSearches) {\n+            assertWarnings(\"[sub_searches] is deprecated and will be removed in a future version. Use [retriever] instead.\");\n+        } else if (hasRank) {\n+            assertWarnings(\"[rank] is deprecated and will be removed in a future version. Use [retriever] instead.\");\n+        }\n     }\n \n     public void testFromXContentInvalid() throws IOException {",
  "logs_path": "factory/claude-sonnet-4-5-20250929/074538b9/elastic_elasticsearch_pr114950/logs.jsonl",
  "errors": [],
  "edit_run_id": "074538b9",
  "test_label": "v0"
}