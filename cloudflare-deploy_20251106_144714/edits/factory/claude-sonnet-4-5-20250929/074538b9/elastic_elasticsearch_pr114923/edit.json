{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 114923,
  "base_commit": "291ced7b482ab952f420993f43cacac49a2f9a9e",
  "runner": "factory",
  "model": "claude-sonnet-4-5-20250929",
  "timeout_s": 7200,
  "status": "success",
  "elapsed_ms": 216197,
  "patch_unified": "diff --git a/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java\nindex 8f32bcf7..a49ed075 100644\n--- a/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java\n+++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java\n@@ -814,7 +814,6 @@ public class Security extends Plugin\n             Arrays.asList(\n                 new TokenSSLBootstrapCheck(),\n                 new PkiRealmBootstrapCheck(getSslService()),\n-                new SecurityImplicitBehaviorBootstrapCheck(nodeMetadata, getLicenseService()),\n                 new TransportTLSBootstrapCheck()\n             )\n         );\ndiff --git a/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/SecurityImplicitBehaviorBootstrapCheck.java b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/SecurityImplicitBehaviorBootstrapCheck.java\ndeleted file mode 100644\nindex 2d535100..00000000\n--- a/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/SecurityImplicitBehaviorBootstrapCheck.java\n+++ /dev/null\n@@ -1,67 +0,0 @@\n-/*\n- * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n- * or more contributor license agreements. Licensed under the Elastic License\n- * 2.0; you may not use this file except in compliance with the Elastic License\n- * 2.0.\n- */\n-\n-package org.elasticsearch.xpack.security;\n-\n-import org.elasticsearch.Version;\n-import org.elasticsearch.bootstrap.BootstrapCheck;\n-import org.elasticsearch.bootstrap.BootstrapContext;\n-import org.elasticsearch.common.ReferenceDocs;\n-import org.elasticsearch.env.NodeMetadata;\n-import org.elasticsearch.license.ClusterStateLicenseService;\n-import org.elasticsearch.license.License;\n-import org.elasticsearch.license.LicenseService;\n-import org.elasticsearch.xpack.core.XPackSettings;\n-\n-public class SecurityImplicitBehaviorBootstrapCheck implements BootstrapCheck {\n-\n-    private final NodeMetadata nodeMetadata;\n-    private final LicenseService licenseService;\n-\n-    public SecurityImplicitBehaviorBootstrapCheck(NodeMetadata nodeMetadata, LicenseService licenseService) {\n-        this.nodeMetadata = nodeMetadata;\n-        this.licenseService = licenseService;\n-    }\n-\n-    @Override\n-    public BootstrapCheckResult check(BootstrapContext context) {\n-        if (nodeMetadata == null) {\n-            return BootstrapCheckResult.success();\n-        }\n-        if (licenseService instanceof ClusterStateLicenseService clusterStateLicenseService) {\n-            final License license = clusterStateLicenseService.getLicense(context.metadata());\n-            // TODO[wrb]: Add an \"isCurrentMajor\" method to BuildVersion?\n-            final Version lastKnownVersion = nodeMetadata.previousNodeVersion().toVersion();\n-            // pre v7.2.0 nodes have Version.EMPTY and its id is 0, so Version#before handles this successfully\n-            if (lastKnownVersion.before(Version.V_8_0_0)\n-                && XPackSettings.SECURITY_ENABLED.exists(context.settings()) == false\n-                && (license.operationMode() == License.OperationMode.BASIC || license.operationMode() == License.OperationMode.TRIAL)) {\n-                return BootstrapCheckResult.failure(\n-                    \"The default value for [\"\n-                        + XPackSettings.SECURITY_ENABLED.getKey()\n-                        + \"] has changed in the current version. \"\n-                        + \" Security features were implicitly disabled for this node but they would now be enabled, possibly\"\n-                        + \" preventing access to the node. \"\n-                        + \"See \"\n-                        + this.referenceDocs()\n-                        + \" to configure security, or explicitly disable security by \"\n-                        + \"setting [xpack.security.enabled] to \\\"false\\\" in elasticsearch.yml before restarting the node.\"\n-                );\n-            }\n-        }\n-        return BootstrapCheckResult.success();\n-    }\n-\n-    public boolean alwaysEnforce() {\n-        return true;\n-    }\n-\n-    @Override\n-    public ReferenceDocs referenceDocs() {\n-        return ReferenceDocs.BOOTSTRAP_CHECK_SECURITY_MINIMAL_SETUP;\n-    }\n-}\ndiff --git a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityImplicitBehaviorBootstrapCheckTests.java b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityImplicitBehaviorBootstrapCheckTests.java\ndeleted file mode 100644\nindex 85e8d6dd..00000000\n--- a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityImplicitBehaviorBootstrapCheckTests.java\n+++ /dev/null\n@@ -1,73 +0,0 @@\n-/*\n- * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n- * or more contributor license agreements. Licensed under the Elastic License\n- * 2.0; you may not use this file except in compliance with the Elastic License\n- * 2.0.\n- */\n-\n-package org.elasticsearch.xpack.security;\n-\n-import org.elasticsearch.Version;\n-import org.elasticsearch.bootstrap.BootstrapCheck;\n-import org.elasticsearch.cluster.metadata.Metadata;\n-import org.elasticsearch.common.settings.Settings;\n-import org.elasticsearch.core.TimeValue;\n-import org.elasticsearch.core.UpdateForV9;\n-import org.elasticsearch.env.BuildVersion;\n-import org.elasticsearch.env.NodeMetadata;\n-import org.elasticsearch.index.IndexVersion;\n-import org.elasticsearch.license.ClusterStateLicenseService;\n-import org.elasticsearch.license.License;\n-import org.elasticsearch.license.LicensesMetadata;\n-import org.elasticsearch.license.TestUtils;\n-import org.elasticsearch.license.internal.TrialLicenseVersion;\n-import org.elasticsearch.test.AbstractBootstrapCheckTestCase;\n-import org.elasticsearch.test.VersionUtils;\n-import org.elasticsearch.xpack.core.XPackSettings;\n-\n-import static org.hamcrest.Matchers.is;\n-import static org.mockito.Mockito.mock;\n-\n-public class SecurityImplicitBehaviorBootstrapCheckTests extends AbstractBootstrapCheckTestCase {\n-\n-    @UpdateForV9(owner = UpdateForV9.Owner.SECURITY)\n-    @AwaitsFix(bugUrl = \"requires updates for version 9.0 bump\")\n-    public void testUpgradeFrom8xWithImplicitSecuritySettings() throws Exception {\n-        final BuildVersion previousVersion = toBuildVersion(VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, null));\n-        NodeMetadata nodeMetadata = new NodeMetadata(randomAlphaOfLength(10), previousVersion, IndexVersion.current());\n-        nodeMetadata = nodeMetadata.upgradeToCurrentVersion();\n-        ClusterStateLicenseService licenseService = mock(ClusterStateLicenseService.class);\n-        BootstrapCheck.BootstrapCheckResult result = new SecurityImplicitBehaviorBootstrapCheck(nodeMetadata, licenseService).check(\n-            createTestContext(\n-                Settings.EMPTY,\n-                createLicensesMetadata(TrialLicenseVersion.fromXContent(previousVersion.toString()), randomFrom(\"basic\", \"trial\"))\n-            )\n-        );\n-        assertThat(result.isSuccess(), is(true));\n-    }\n-\n-    @UpdateForV9(owner = UpdateForV9.Owner.SECURITY)\n-    @AwaitsFix(bugUrl = \"requires updates for version 9.0 bump\")\n-    public void testUpgradeFrom8xWithExplicitSecuritySettings() throws Exception {\n-        final BuildVersion previousVersion = toBuildVersion(VersionUtils.randomVersionBetween(random(), Version.V_8_0_0, null));\n-        NodeMetadata nodeMetadata = new NodeMetadata(randomAlphaOfLength(10), previousVersion, IndexVersion.current());\n-        nodeMetadata = nodeMetadata.upgradeToCurrentVersion();\n-        ClusterStateLicenseService licenseService = mock(ClusterStateLicenseService.class);\n-        BootstrapCheck.BootstrapCheckResult result = new SecurityImplicitBehaviorBootstrapCheck(nodeMetadata, licenseService).check(\n-            createTestContext(\n-                Settings.builder().put(XPackSettings.SECURITY_ENABLED.getKey(), true).build(),\n-                createLicensesMetadata(TrialLicenseVersion.fromXContent(previousVersion.toString()), randomFrom(\"basic\", \"trial\"))\n-            )\n-        );\n-        assertThat(result.isSuccess(), is(true));\n-    }\n-\n-    private Metadata createLicensesMetadata(TrialLicenseVersion era, String licenseMode) throws Exception {\n-        License license = TestUtils.generateSignedLicense(licenseMode, TimeValue.timeValueHours(2));\n-        return Metadata.builder().putCustom(LicensesMetadata.TYPE, new LicensesMetadata(license, era)).build();\n-    }\n-\n-    private static BuildVersion toBuildVersion(Version version) {\n-        return BuildVersion.fromVersionId(version.id());\n-    }\n-}",
  "logs_path": "factory/claude-sonnet-4-5-20250929/074538b9/elastic_elasticsearch_pr114923/logs.jsonl",
  "errors": [],
  "edit_run_id": "074538b9",
  "test_label": "v0"
}