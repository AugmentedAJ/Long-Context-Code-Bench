{"timestamp": 1761907826.7866418, "event": "agent_start", "runner": "auggie", "model": "sonnet4.5", "command": ["auggie", "--print", "--model", "sonnet4.5", "--workspace-root", "/var/folders/1t/tn_3vh3x0nv_snwb7xrv97th0000gn/T/tmpixj1smoz/workspace", "--instruction-file", "/var/folders/1t/tn_3vh3x0nv_snwb7xrv97th0000gn/T/tmpixj1smoz/workspace/.auggie_task.txt", "--retry-timeout", "1800"], "workspace": "/var/folders/1t/tn_3vh3x0nv_snwb7xrv97th0000gn/T/tmpixj1smoz/workspace", "timeout_s": 1800}
{"timestamp": 1761907978.418903, "event": "agent_run", "stdout": "\ud83e\udd16\nI'll help you backport the changes from the main branch to the 8.x branch. Let me start by gathering information about this backport.\n\n\n\u001b[90m\ud83d\udd27 Tool call: github-api\u001b[0m\n   path: \"/repos/elastic/elasticsearch/pulls/114856\"\n   summary: \"Get details about PR #114856\"\n\n\u001b[90m\ud83d\udccb Tool result: github-api\u001b[0m\nadditions: 42\nbody: '@tetianakravchenko has noticed ingestion failures with the OTel demo. The issue\n  is that for some reason, the `k8s.pod.ip` field is set to an empty string. While\n  this sounds like a bug, we should handle those situations more gracefully.'\nchanged_files: 5\nclosed_at: '2024-10-16T07:10:10Z'\ncommits: 4\ncreated_at: '2024-10-15T17:57:35Z'\ndeletions: 17\nmerged_at: '2024-10-16T07:10:10Z'\nnumber: 114856\nstate: closed\ntitle: 'OTel mappings: avoid metrics to be rejected when  attributes are malformed'\nupdated_at: '2024-10-16T09:58:22Z'\nurl: https://api.github.com/repos/elastic/elasticsearch/pulls/114856\n... (4 more lines)\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \".\"\n   type: \"directory\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the files and directories up to 2 levels deep in ., excluding hidden items:\n./BUILDING.md\n./CHANGELOG.md\n./CONTRIBUTING.md\n./LICENSE.txt\n./NOTICE.txt\n./README.asciidoc\n./REST_API_COMPATIBILITY.md\n./TESTING.asciidoc\n./TRACING.md\n./Vagrantfile\n./benchmarks\n./branches.json\n./build-conventions\n./build-tools\n... (201 more lines)\n\n\u001b[90m\ud83d\udd27 Tool call: github-api\u001b[0m\n   path: \"/repos/elastic/elasticsearch/pulls/114856/files\"\n   summary: \"Get the files changed in PR #114856\"\n\n\u001b[90m\ud83d\udccb Tool result: github-api\u001b[0m\n- additions: 5\n  deletions: 0\n  status: added\n- additions: 2\n  deletions: 5\n  status: modified\n- additions: 0\n  deletions: 11\n  status: modified\n- additions: 1\n  deletions: 1\n  status: modified\n- additions: 34\n  deletions: 0\n  status: modified\n... (1 more lines)\n\ud83e\udd16\nLet me get more detailed information about the files changed:\n\n\n\u001b[90m\ud83d\udd27 Tool call: web-fetch\u001b[0m\n   url: \"https://github.com/elastic/elasticsearch/pull/114856/files\"\n\n\u001b[90m\ud83d\udccb Tool result: web-fetch\u001b[0m\n@@ -0,0 +1,5 @@\n\n    pr: 114856\n\n    summary: \"OTel mappings: avoid metrics to be rejected when attributes are malformed\"\n\n    area: Data streams\n\n    type: bug\n\n    issues: []\n@@ -3,6 +3,8 @@ _meta:\n\n      description: Default mappings for the OpenTelemetry metrics index template installed by x-pack\n\n... (337 more lines)\n\ud83e\udd16\nNow let me search for the relevant files in the current workspace:\n\n\n\u001b[90m\ud83d\udd27 Tool call: codebase-retrieval\u001b[0m\n   information_request: \"OpenTelemetry OTel metrics mappings component template files, specifically otel@mappings.yaml and related configuration files\"\n\n\u001b[90m\ud83d\udccb Tool result: codebase-retrieval\u001b[0m\nThe following code sections were retrieved:\nPath: x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml\n     1\tversion: ${xpack.oteldata.template.version}\n     2\t_meta:\n     3\t  description: Default mappings for the OpenTelemetry metrics index template installed by x-pack\n     4\t  managed: true\n     5\ttemplate:\n     6\t  mappings:\n     7\t    properties:\n     8\t      start_timestamp:\n     9\t        type: date_nanos\n    10\t      metrics:\n    11\t        type: passthrough\n    12\t        dynamic: true\n    13\t        priority: 10\n... (687 more lines)\n\ud83e\udd16\nNow let me look at the specific files that need to be modified:\n\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml:\n     1\tversion: ${xpack.oteldata.template.version}\n     2\t_meta:\n     3\t  description: Default mappings for the OpenTelemetry metrics index template installed by x-pack\n     4\t  managed: true\n     5\ttemplate:\n     6\t  mappings:\n     7\t    properties:\n     8\t      start_timestamp:\n     9\t        type: date_nanos\n    10\t      metrics:\n    11\t        type: passthrough\n    12\t        dynamic: true\n    13\t        priority: 10\n    14\t      unit:\n... (41 more lines)\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml:\n     1\t---\n     2\tversion: ${xpack.oteldata.template.version}\n     3\tindex_patterns: [\"metrics-*.otel-*\"]\n     4\tpriority: 120\n     5\tdata_stream: {}\n     6\tallow_auto_create: true\n     7\t_meta:\n     8\t  description: default OpenTelemetry metrics template installed by x-pack\n     9\t  managed: true\n    10\tcomposed_of:\n    11\t  - metrics@tsdb-settings\n    12\t  - otel@mappings\n    13\t  - metrics-otel@mappings\n    14\t  - semconv-resource-to-ecs@mappings\n... (29 more lines)\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/main/resources/otel-data-registry-version.json\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\n\u274c Error:\nFile not found: x-pack/plugin/otel-data/src/main/resources/otel-data-registry-version.json\n\n\u001b[90m\ud83d\udd27 Tool call: codebase-retrieval\u001b[0m\n   information_request: \"otel-data registry version file or version configuration for OTel templates\"\n\n\u001b[90m\ud83d\udccb Tool result: codebase-retrieval\u001b[0m\nThe following code sections were retrieved:\nPath: x-pack/plugin/otel-data/src/main/resources/resources.yaml\n     1\t# \"version\" holds the version of the templates and ingest pipelines installed\n     2\t# by xpack-plugin otel-data. This must be increased whenever an existing template is\n     3\t# changed, in order for it to be updated on Elasticsearch upgrade.\n     4\tversion: 5\n     5\t\n     6\tcomponent-templates:\n     7\t  - otel@mappings\n     8\t  - logs-otel@mappings\n     9\t  - semconv-resource-to-ecs@mappings\n    10\t  - metrics-otel@mappings\n    11\t  - traces-otel@mappings\n    12\t  - ecs-tsdb@mappings\n    13\tindex-templates:\n... (572 more lines)\n\ud83e\udd16\nNow let me check the test file:\n\n\n\u001b[90m\ud83d\udd27 Tool call: codebase-retrieval\u001b[0m\n   information_request: \"OTel metrics test files, specifically tests for metrics-generic.otel data stream and IP field handling\"\n\n\u001b[90m\ud83d\udccb Tool result: codebase-retrieval\u001b[0m\nThe following code sections were retrieved:\nPath: modules/ingest-common/src/internalClusterTest/java/org/elasticsearch/plugins/internal/XContentMeteringParserDecoratorWithPipelinesIT.java\n...\n    44\t\n    45\t    public void testDocumentIsReportedWithPipelines() throws Exception {\n    46\t        hasWrappedParser = false;\n    47\t        // pipeline adding fields, changing destination is not affecting reporting\n    48\t        final BytesReference pipelineBody = new BytesArray(\"\"\"\n    49\t            {\n    50\t              \"processors\": [\n    51\t                {\n    52\t                   \"set\": {\n    53\t                     \"field\": \"my-text-field\",\n    54\t                     \"value\": \"xxxx\"\n    55\t                   }\n... (528 more lines)\n\ud83e\udd16\nNow let me view the test file to see where I need to add the new test:\n\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml:\n     1\t---\n     2\tsetup:\n     3\t  - do:\n     4\t      cluster.health:\n     5\t        wait_for_events: languid\n     6\t  - do:\n     7\t      cluster.put_component_template:\n     8\t        name: metrics-otel@custom\n     9\t        body:\n    10\t          template:\n    11\t            settings:\n    12\t              index:\n    13\t                routing_path: [unit, attributes.*, resource.attributes.*]\n    14\t                mode: time_series\n... (236 more lines)\n\ud83e\udd16\nNow let me check if there's a changelog file to add:\n\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"docs/changelog\"\n   type: \"directory\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the files and directories up to 2 levels deep in docs/changelog, excluding hidden items:\ndocs/changelog/106520.yaml\ndocs/changelog/107047.yaml\ndocs/changelog/107936.yaml\ndocs/changelog/109017.yaml\ndocs/changelog/109193.yaml\ndocs/changelog/109414.yaml\ndocs/changelog/109583.yaml\ndocs/changelog/109667.yaml\ndocs/changelog/109684.yaml\ndocs/changelog/110021.yaml\ndocs/changelog/110116.yaml\ndocs/changelog/110216.yaml\ndocs/changelog/110237.yaml\ndocs/changelog/110399.yaml\n... (274 more lines)\n\ud83e\udd16\nPerfect! Now I have all the information I need. Based on the PR #114856, I need to make the following changes:\n\n1. Add a changelog file `docs/changelog/114856.yaml`\n2. Update `x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml` to add `index.mapping.ignore_malformed: true` setting\n3. Remove the `dynamic_templates` section from `x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml`\n4. Update the version in `x-pack/plugin/otel-data/src/main/resources/resources.yaml` from 5 to 6\n5. Add a new test case to `x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml`\n\nLet me start implementing these changes:\n\n\n\u001b[90m\ud83d\udd27 Tool call: save-file\u001b[0m\n   instructions_reminder: \"LIMIT THE FILE CONTENT TO AT MOST 150 LINES. IF MORE CONTENT NEEDS TO BE ADDED USE THE str-replace-editor TOOL TO EDIT THE FILE AFTER IT HAS BEEN CREATED.\"\n   path: \"docs/changelog/114856.yaml\"\n   file_content: \"pr: 114856\n   summary: \"OTel mappings: avoid metrics to be rejected when attributes are malformed\"\n   area: Data streams\n   type: bug\n   issues: []\n   \"\n\n\u001b[90m\ud83d\udccb Tool result: save-file\u001b[0m\nFile saved.  Saved file {docs/changelog/114856.yaml}\n\n\u001b[90m\ud83d\udd27 Tool call: str-replace-editor\u001b[0m\n\u001b[36m\ud83d\udcdd x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml (lines 5-4 \u2192 lines 6-7)\u001b[0m\n\u001b[32m+  settings:\u001b[0m\n\u001b[32m+    index.mapping.ignore_malformed: true\u001b[0m\n\n\u001b[90m\ud83d\udccb Tool result: str-replace-editor\u001b[0m\nSuccessfully edited the file x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml.\nResult for str_replace for entry with index [1]:\nReplacement successful.\nnew_str starts at line 1 and ends at line 8.\n\nReview the changes and make sure they are as expected (correct indentation, no duplicate lines, etc).\nEdit the file again if necessary.\n\n\n\u001b[90m\ud83d\udd27 Tool call: str-replace-editor\u001b[0m\n\u001b[36m\ud83d\udcdd x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml (lines 9-20 \u2192 line 9)\u001b[0m\n\u001b[31m-        value: metrics\u001b[0m\n\u001b[31m-    dynamic_templates:\u001b[0m\n\u001b[31m-      - ecs_ip:\u001b[0m\n\u001b[31m-          mapping:\u001b[0m\n\u001b[31m-            type: ip\u001b[0m\n\u001b[31m-          path_match: [ \"ip\", \"*.ip\", \"*_ip\" ]\u001b[0m\n\u001b[31m-          match_mapping_type: string\u001b[0m\n\u001b[31m-      - all_strings_to_keywords:\u001b[0m\n\u001b[31m-          mapping:\u001b[0m\n\u001b[31m-            ignore_above: 1024\u001b[0m\n\u001b[31m-            type: keyword\u001b[0m\n\u001b[31m-          match_mapping_type: string\u001b[0m\n\u001b[32m+        value: metrics\u001b[0m\n\n\u001b[90m\ud83d\udccb Tool result: str-replace-editor\u001b[0m\nSuccessfully edited the file x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml.\nResult for str_replace for entry with index [1]:\nReplacement successful.\nnew_str starts at line 21 and ends at line 29.\n\nReview the changes and make sure they are as expected (correct indentation, no duplicate lines, etc).\nEdit the file again if necessary.\n\n\n\u001b[90m\ud83d\udd27 Tool call: str-replace-editor\u001b[0m\n\u001b[36m\ud83d\udcdd x-pack/plugin/otel-data/src/main/resources/resources.yaml (line 4 \u2192 line 4)\u001b[0m\n\u001b[31m-version: 5\u001b[0m\n\u001b[32m+version: 6\u001b[0m\n\n\u001b[90m\ud83d\udccb Tool result: str-replace-editor\u001b[0m\nSuccessfully edited the file x-pack/plugin/otel-data/src/main/resources/resources.yaml.\nResult for str_replace for entry with index [1]:\nReplacement successful.\nnew_str starts at line 1 and ends at line 4.\n\nReview the changes and make sure they are as expected (correct indentation, no duplicate lines, etc).\nEdit the file again if necessary.\n\n\ud83e\udd16\nNow let me add the new test case at the end of the test file:\n\n\n\u001b[90m\ud83d\udd27 Tool call: str-replace-editor\u001b[0m\n\u001b[36m\ud83d\udcdd x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml (line 7 \u2192 lines 7-41)\u001b[0m\n\u001b[31m-  - match: { .$idx0name.mappings.properties.metrics.properties.histogram.type: 'histogram' }\u001b[0m\n\u001b[32m+  - match: { .$idx0name.mappings.properties.metrics.properties.histogram.type: 'histogram' }\u001b[0m\n\u001b[32m+---\u001b[0m\n\u001b[32m+Empty IP field:\u001b[0m\n\u001b[32m+  - do:\u001b[0m\n\u001b[32m+      bulk:\u001b[0m\n\u001b[32m+        index: metrics-generic.otel-default\u001b[0m\n\u001b[32m+        refresh: true\u001b[0m\n\u001b[32m+        body:\u001b[0m\n\u001b[32m+          - create: {\"dynamic_templates\":{\"metrics.foo.bar\":\"counter_long\"}}\u001b[0m\n\u001b[32m+          - \"@timestamp\": 2024-07-18T14:48:33.467654000Z\u001b[0m\n\u001b[32m+            resource:\u001b[0m\n\u001b[32m+              attributes:\u001b[0m\n\u001b[32m+                host.name: localhost\u001b[0m\n\u001b[2m... 24 more lines\u001b[0m\n\n\u001b[90m\ud83d\udccb Tool result: str-replace-editor\u001b[0m\nSuccessfully edited the file x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml.\nResult for str_replace for entry with index [1]:\nReplacement successful.\nnew_str starts at line 241 and ends at line 281.\n\nReview the changes and make sure they are as expected (correct indentation, no duplicate lines, etc).\nEdit the file again if necessary.\n\n\ud83e\udd16\nPerfect! Now let me verify all the changes I made by viewing the modified files:\n\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"docs/changelog/114856.yaml\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on docs/changelog/114856.yaml:\n     1\tpr: 114856\n     2\tsummary: \"OTel mappings: avoid metrics to be rejected when attributes are malformed\"\n     3\tarea: Data streams\n     4\ttype: bug\n     5\tissues: []\n     6\t\n     7\t\nTotal lines in file: 7\n\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml:\n     1\tversion: ${xpack.oteldata.template.version}\n     2\t_meta:\n     3\t  description: Default mappings for the OpenTelemetry metrics index template installed by x-pack\n     4\t  managed: true\n     5\ttemplate:\n     6\t  settings:\n     7\t    index.mapping.ignore_malformed: true\n     8\t  mappings:\n     9\t    properties:\n    10\t      start_timestamp:\n    11\t        type: date_nanos\n    12\t      metrics:\n    13\t        type: passthrough\n    14\t        dynamic: true\n... (43 more lines)\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml\"\n   type: \"file\"\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml:\n     1\t---\n     2\tversion: ${xpack.oteldata.template.version}\n     3\tindex_patterns: [\"metrics-*.otel-*\"]\n     4\tpriority: 120\n     5\tdata_stream: {}\n     6\tallow_auto_create: true\n     7\t_meta:\n     8\t  description: default OpenTelemetry metrics template installed by x-pack\n     9\t  managed: true\n    10\tcomposed_of:\n    11\t  - metrics@tsdb-settings\n    12\t  - otel@mappings\n    13\t  - metrics-otel@mappings\n    14\t  - semconv-resource-to-ecs@mappings\n... (18 more lines)\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/main/resources/resources.yaml\"\n   type: \"file\"\n   view_range: [1,10]\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/main/resources/resources.yaml:\n     1\t# \"version\" holds the version of the templates and ingest pipelines installed\n     2\t# by xpack-plugin otel-data. This must be increased whenever an existing template is\n     3\t# changed, in order for it to be updated on Elasticsearch upgrade.\n     4\tversion: 6\n     5\t\n     6\tcomponent-templates:\n     7\t  - otel@mappings\n     8\t  - logs-otel@mappings\n     9\t  - semconv-resource-to-ecs@mappings\n    10\t  - metrics-otel@mappings\nTotal lines in file: 29\n\n\n\u001b[90m\ud83d\udd27 Tool call: view\u001b[0m\n   path: \"x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml\"\n   type: \"file\"\n   view_range: [240,-1]\n\n\u001b[90m\ud83d\udccb Tool result: view\u001b[0m\nHere's the result of running `cat -n` on x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml:\n   240\t        expand_wildcards: hidden\n   241\t  - match: { .$idx0name.mappings.properties.metrics.properties.counter_long.type: 'long' }\n   242\t  - match: { .$idx0name.mappings.properties.metrics.properties.gauge_long.type: 'long' }\n   243\t  - match: { .$idx0name.mappings.properties.metrics.properties.counter_double.type: 'double' }\n   244\t  - match: { .$idx0name.mappings.properties.metrics.properties.gauge_double.type: 'double' }\n   245\t  - match: { .$idx0name.mappings.properties.metrics.properties.summary.type: 'aggregate_metric_double' }\n   246\t  - match: { .$idx0name.mappings.properties.metrics.properties.summary_minmax.type: 'aggregate_metric_double' }\n   247\t  - match: { .$idx0name.mappings.properties.metrics.properties.histogram.type: 'histogram' }\n   248\t---\n   249\tEmpty IP field:\n   250\t  - do:\n   251\t      bulk:\n   252\t        index: metrics-generic.otel-default\n   253\t        refresh: true\n... (31 more lines)\n\ud83e\udd16\nPerfect! All the changes have been successfully applied. Let me create a summary of what was done:\n\n## Summary\n\nI have successfully backported the changes from PR #114856 to fix the issue where OTel metrics were being rejected when attributes are malformed (specifically when IP fields contain empty strings). The following changes were made:\n\n### Files Modified:\n\n1. **`docs/changelog/114856.yaml`** (new file)\n   - Added changelog entry documenting this bug fix\n\n2. **`x-pack/plugin/otel-data/src/main/resources/component-templates/metrics-otel@mappings.yaml`**\n   - Added `index.mapping.ignore_malformed: true` setting to the template settings section\n   - This allows malformed field values to be ignored rather than causing the entire document to be rejected\n\n3. **`x-pack/plugin/otel-data/src/main/resources/index-templates/metrics-otel@template.yaml`**\n   - Removed the `dynamic_templates` section (ecs_ip and all_strings_to_keywords)\n   - These dynamic templates are now handled by the `ecs-tsdb@mappings` component template which is already included in the `composed_of` list\n\n4. **`x-pack/plugin/otel-data/src/main/resources/resources.yaml`**\n   - Incremented version from 5 to 6\n   - This ensures the updated templates will be applied on Elasticsearch upgrade\n\n5. **`x-pack/plugin/otel-data/src/yamlRestTest/resources/rest-api-spec/test/20_metrics_tests.yml`**\n   - Added new test case \"Empty IP field\" that verifies:\n     - Documents with empty IP strings can be ingested without errors\n     - The IP field is correctly mapped as type 'ip'\n     - The malformed empty IP value is added to the `_ignored` field\n     - The document is successfully indexed with the metric data\n\n### What This Fixes:\n\nThe issue was that when OTel metrics contained attributes with malformed values (like an empty string for an IP field), the entire document would be rejected. With these changes:\n- Malformed field values are now ignored and tracked in the `_ignored` metadata field\n- The rest of the document is successfully indexed\n- This provides more graceful handling of data quality issues in production environments\n\nAll changes match the original PR #114856 and are ready for the 8.x backport.\n\n", "stderr": "", "returncode": 0}
