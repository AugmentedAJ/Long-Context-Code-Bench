{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 114917,
  "base_commit": "f4eba6279bb8e5f98862975dde2abc83d84b15db",
  "runner": "auggie",
  "model": "sonnet4.5",
  "timeout_s": 1800,
  "status": "success",
  "elapsed_ms": 620307,
  "patch_unified": "diff --git a/docs/plugins/mapper-annotated-text.asciidoc b/docs/plugins/mapper-annotated-text.asciidoc\nindex e4141e98..9b6eccd1 100644\n--- a/docs/plugins/mapper-annotated-text.asciidoc\n+++ b/docs/plugins/mapper-annotated-text.asciidoc\n@@ -167,8 +167,16 @@ duplicates removed. So:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"text\": {\n         \"type\": \"annotated_text\",\n@@ -215,8 +223,16 @@ are preserved.\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"text\": { \"type\": \"annotated_text\", \"store\": true }\n     }\ndiff --git a/docs/reference/mapping/fields/synthetic-source.asciidoc b/docs/reference/mapping/fields/synthetic-source.asciidoc\nindex 902b6c26..050fdfe5 100644\n--- a/docs/reference/mapping/fields/synthetic-source.asciidoc\n+++ b/docs/reference/mapping/fields/synthetic-source.asciidoc\n@@ -11,15 +11,19 @@ of official GA features.\n Though very handy to have around, the source field takes up a significant amount\n of space on disk. Instead of storing source documents on disk exactly as you\n send them, Elasticsearch can reconstruct source content on the fly upon retrieval.\n-Enable this by setting `mode: synthetic` in `_source`:\n+Enable this by using the value `synthetic` for the index setting `index.mapping.source.mode`:\n \n [source,console,id=enable-synthetic-source-example]\n ----\n PUT idx\n {\n-  \"mappings\": {\n-    \"_source\": {\n-      \"mode\": \"synthetic\"\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n     }\n   }\n }\n@@ -38,7 +42,7 @@ properties when used with synthetic `_source`.\n <<synthetic-source-fields-native-list, Most field types>> construct synthetic `_source` using existing data, most\n commonly <<doc-values,`doc_values`>> and <<stored-fields, stored fields>>. For these field types, no additional space\n is needed to store the contents of `_source` field. Due to the storage layout of <<doc-values,`doc_values`>>, the\n-generated `_source` field undergoes <<synthetic-source-modifications, modifications>> compared to original document.\n+generated `_source` field undergoes <<synthetic-source-modifications, modifications>> compared to the original document.\n \n For all other field types, the original value of the field is stored as is, in the same way as the `_source` field in\n non-synthetic mode. In this case there are no modifications and field data in `_source` is the same as in the original\n@@ -227,10 +231,16 @@ For instance:\n ----\n PUT idx_keep\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": {\n-      \"mode\": \"synthetic\"\n-    },\n     \"properties\": {\n       \"path\": {\n         \"type\": \"object\",\ndiff --git a/docs/reference/mapping/types/aggregate-metric-double.asciidoc b/docs/reference/mapping/types/aggregate-metric-double.asciidoc\nindex 8e14fba9..8a4ddffc 100644\n--- a/docs/reference/mapping/types/aggregate-metric-double.asciidoc\n+++ b/docs/reference/mapping/types/aggregate-metric-double.asciidoc\n@@ -267,8 +267,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"agg_metric\": {\n         \"type\": \"aggregate_metric_double\",\ndiff --git a/docs/reference/mapping/types/binary.asciidoc b/docs/reference/mapping/types/binary.asciidoc\nindex a06e5b4f..335c371b 100644\n--- a/docs/reference/mapping/types/binary.asciidoc\n+++ b/docs/reference/mapping/types/binary.asciidoc\n@@ -68,8 +68,16 @@ of official GA features.\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"binary\": { \"type\": \"binary\", \"doc_values\": true }\n     }\ndiff --git a/docs/reference/mapping/types/boolean.asciidoc b/docs/reference/mapping/types/boolean.asciidoc\nindex 32f3d13e..494c4102 100644\n--- a/docs/reference/mapping/types/boolean.asciidoc\n+++ b/docs/reference/mapping/types/boolean.asciidoc\n@@ -249,8 +249,16 @@ Synthetic source always sorts `boolean` fields. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"bool\": { \"type\": \"boolean\" }\n     }\ndiff --git a/docs/reference/mapping/types/date.asciidoc b/docs/reference/mapping/types/date.asciidoc\nindex ab845280..b29da457 100644\n--- a/docs/reference/mapping/types/date.asciidoc\n+++ b/docs/reference/mapping/types/date.asciidoc\n@@ -256,8 +256,16 @@ Synthetic source always sorts `date` fields. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"date\": { \"type\": \"date\" }\n     }\ndiff --git a/docs/reference/mapping/types/date_nanos.asciidoc b/docs/reference/mapping/types/date_nanos.asciidoc\nindex 1a3b390b..e9ec85c4 100644\n--- a/docs/reference/mapping/types/date_nanos.asciidoc\n+++ b/docs/reference/mapping/types/date_nanos.asciidoc\n@@ -160,8 +160,16 @@ Synthetic source always sorts `date_nanos` fields. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"date\": { \"type\": \"date_nanos\" }\n     }\ndiff --git a/docs/reference/mapping/types/flattened.asciidoc b/docs/reference/mapping/types/flattened.asciidoc\nindex 0a72ebc9..af6ef3e7 100644\n--- a/docs/reference/mapping/types/flattened.asciidoc\n+++ b/docs/reference/mapping/types/flattened.asciidoc\n@@ -334,8 +334,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"flattened\": { \"type\": \"flattened\" }\n     }\n@@ -367,8 +375,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"flattened\": { \"type\": \"flattened\" }\n     }\n@@ -407,8 +423,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"flattened\": { \"type\": \"flattened\" }\n     }\ndiff --git a/docs/reference/mapping/types/geo-point.asciidoc b/docs/reference/mapping/types/geo-point.asciidoc\nindex 6db05188..9ba8ea6e 100644\n--- a/docs/reference/mapping/types/geo-point.asciidoc\n+++ b/docs/reference/mapping/types/geo-point.asciidoc\n@@ -229,8 +229,16 @@ longitude) and reduces them to their stored precision. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"point\": { \"type\": \"geo_point\" }\n     }\ndiff --git a/docs/reference/mapping/types/ip.asciidoc b/docs/reference/mapping/types/ip.asciidoc\nindex f0689164..f85dd78e 100644\n--- a/docs/reference/mapping/types/ip.asciidoc\n+++ b/docs/reference/mapping/types/ip.asciidoc\n@@ -170,8 +170,16 @@ Synthetic source always sorts `ip` fields and removes duplicates. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"ip\": { \"type\": \"ip\" }\n     }\ndiff --git a/docs/reference/mapping/types/keyword.asciidoc b/docs/reference/mapping/types/keyword.asciidoc\nindex a4be7026..b9421604 100644\n--- a/docs/reference/mapping/types/keyword.asciidoc\n+++ b/docs/reference/mapping/types/keyword.asciidoc\n@@ -188,8 +188,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"kwd\": { \"type\": \"keyword\" }\n     }\n@@ -218,8 +226,16 @@ are preserved. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"kwd\": { \"type\": \"keyword\", \"store\": true }\n     }\n@@ -248,8 +264,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"kwd\": { \"type\": \"keyword\", \"ignore_above\": 3 }\n     }\ndiff --git a/docs/reference/mapping/types/numeric.asciidoc b/docs/reference/mapping/types/numeric.asciidoc\nindex d1e1c037..5bfa1bc7 100644\n--- a/docs/reference/mapping/types/numeric.asciidoc\n+++ b/docs/reference/mapping/types/numeric.asciidoc\n@@ -259,8 +259,16 @@ Synthetic source always sorts numeric fields. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"long\": { \"type\": \"long\" }\n     }\n@@ -287,8 +295,16 @@ Scaled floats will always apply their scaling factor so:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"f\": { \"type\": \"scaled_float\", \"scaling_factor\": 0.01 }\n     }\ndiff --git a/docs/reference/mapping/types/range.asciidoc b/docs/reference/mapping/types/range.asciidoc\nindex 14c5b609..4eea288d 100644\n--- a/docs/reference/mapping/types/range.asciidoc\n+++ b/docs/reference/mapping/types/range.asciidoc\n@@ -254,8 +254,16 @@ Synthetic source always sorts values and removes duplicates for all `range` fiel\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"my_range\": { \"type\": \"long_range\" }\n     }\n@@ -316,8 +324,16 @@ For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"my_range\": { \"type\": \"ip_range\" }\n     }\n@@ -357,8 +373,16 @@ Range field vales are always represented as inclusive on both sides with bounds\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"my_range\": { \"type\": \"long_range\" }\n     }\n@@ -394,8 +418,16 @@ Default values for range bounds are represented as `null` in synthetic source. T\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"my_range\": { \"type\": \"integer_range\" }\n     }\n@@ -429,8 +461,16 @@ Will become:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"my_range\": { \"type\": \"date_range\" }\n     }\ndiff --git a/docs/reference/mapping/types/text.asciidoc b/docs/reference/mapping/types/text.asciidoc\nindex c33af69d..be6fffe6 100644\n--- a/docs/reference/mapping/types/text.asciidoc\n+++ b/docs/reference/mapping/types/text.asciidoc\n@@ -184,8 +184,16 @@ duplicates removed. So:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"text\": {\n         \"type\": \"text\",\n@@ -233,8 +241,16 @@ are preserved.\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"text\": { \"type\": \"text\", \"store\": true }\n     }\ndiff --git a/docs/reference/mapping/types/version.asciidoc b/docs/reference/mapping/types/version.asciidoc\nindex 8da0fcae..d5df0b41 100644\n--- a/docs/reference/mapping/types/version.asciidoc\n+++ b/docs/reference/mapping/types/version.asciidoc\n@@ -86,8 +86,16 @@ Synthetic source always sorts `version` fields and removes duplicates. For examp\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"versions\": { \"type\": \"version\" }\n     }\ndiff --git a/docs/reference/mapping/types/wildcard.asciidoc b/docs/reference/mapping/types/wildcard.asciidoc\nindex 79fc9530..89a3109a 100644\n--- a/docs/reference/mapping/types/wildcard.asciidoc\n+++ b/docs/reference/mapping/types/wildcard.asciidoc\n@@ -141,8 +141,16 @@ Synthetic source always sorts `wildcard` fields. For example:\n ----\n PUT idx\n {\n+  \"settings\": {\n+    \"index\": {\n+      \"mapping\": {\n+        \"source\": {\n+          \"mode\": \"synthetic\"\n+        }\n+      }\n+    }\n+  },\n   \"mappings\": {\n-    \"_source\": { \"mode\": \"synthetic\" },\n     \"properties\": {\n       \"card\": { \"type\": \"wildcard\" }\n     }",
  "logs_path": "auggie/sonnet4.5/a9463435/elastic_elasticsearch_pr114917/logs.jsonl",
  "errors": [],
  "edit_run_id": "a9463435",
  "test_label": "v0"
}