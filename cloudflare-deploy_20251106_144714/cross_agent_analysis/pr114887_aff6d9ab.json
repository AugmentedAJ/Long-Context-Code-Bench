{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 114887,
  "base_commit": "6de48b122f41ad9ddd8449dbcaec46e883d7e4a8",
  "head_commit": "6799f7fcf675e865a109b59e857327c7d1e347fd",
  "task_instructions": "You are working on a codebase. Your task is to make the necessary code changes to accomplish the following:\n\n[8.x] Inline `MockTransportService#getLocalDiscoNode()` (#114883)\n\nBackports the following commits to 8.x:\n - Inline `MockTransportService#getLocalDiscoNode()` (#114883)\n\nPlease make all necessary code changes to complete this task.",
  "ground_truth_diff": "diff --git a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\nindex b55f4eccafca..cad839bed955 100644\n--- a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n+++ b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n@@ -103,7 +103,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), TestProfiles.LIGHT_PROFILE)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), TestProfiles.LIGHT_PROFILE)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\n@@ -147,7 +147,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), connectionProfile)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), connectionProfile)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\ndiff --git a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\nindex 7b4229284839..780f3994ce62 100644\n--- a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n+++ b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n@@ -154,7 +154,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             updateRemoteClusterSettings(Collections.singletonMap(\"seeds\", remoteNode.getAddress().toString()));\n \n@@ -307,7 +307,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             {\n                 // check that skip_unavailable alone cannot be set\ndiff --git a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\nindex 06434a0c9051..70682cfd41d8 100644\n--- a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n+++ b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n@@ -486,7 +486,7 @@ public class TransportSearchActionTests extends ESTestCase {\n                 threadPool\n             );\n             mockTransportServices[i] = remoteSeedTransport;\n-            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalNode();\n             knownNodes.add(remoteSeedNode);\n             nodes[i] = remoteSeedNode;\n             settingsBuilder.put(\"cluster.remote.remote\" + i + \".seeds\", remoteSeedNode.getAddress().toString());\ndiff --git a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\nindex 78d76476d06f..e5cdecd25ef3 100644\n--- a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n+++ b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n@@ -157,13 +157,13 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n \n             parentTransportService.addSendBehavior(sendRequestBehavior);\n \n-            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalDiscoNode());\n+            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalNode());\n \n             final CancellableTask parentTask = (CancellableTask) parentTransportService.getTaskManager()\n                 .register(\"transport\", \"internal:testAction\", new ParentRequest());\n \n             parentTransportService.sendChildRequest(\n-                childTransportService.getLocalDiscoNode(),\n+                childTransportService.getLocalNode(),\n                 \"internal:testAction[c]\",\n                 new EmptyRequest(),\n                 parentTask,\n@@ -172,7 +172,7 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n             );\n \n             try (MockLog mockLog = MockLog.capture(TaskCancellationService.class)) {\n-                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalDiscoNode())) {\n+                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalNode())) {\n                     mockLog.addExpectation(expectation);\n                 }\n \ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\nindex 43dce7d406ba..d7cf38828b7b 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n@@ -89,7 +89,7 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n         ) {\n             remoteTransport.getTaskManager().setTaskCancellationService(new TaskCancellationService(remoteTransport));\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService localService = MockTransportService.createNewService(\n                     builder.build(),\n@@ -163,11 +163,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -216,11 +216,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\nindex ff0742c89bba..0efaef701564 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n@@ -73,7 +73,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n@@ -152,7 +152,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n                 .put(\"cluster.remote.test.seeds\", remoteNode.getAddress().getAddress() + \":\" + remoteNode.getAddress().getPort())\n@@ -251,7 +251,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\nindex 7a259cf3100f..21346bb93ef8 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n@@ -311,11 +311,11 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            DiscoveryNode seedNode1 = seedTransport1.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n-            knownNodes.add(seedTransport1.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            DiscoveryNode seedNode1 = seedTransport1.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n+            knownNodes.add(seedTransport1.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             List<String> seedNodes = addresses(seedNode1, seedNode);\n             Collections.shuffle(seedNodes, random());\n@@ -447,9 +447,9 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode node1 = transport1.getLocalDiscoNode();\n-            DiscoveryNode node2 = transport3.getLocalDiscoNode();\n-            DiscoveryNode node3 = transport2.getLocalDiscoNode();\n+            DiscoveryNode node1 = transport1.getLocalNode();\n+            DiscoveryNode node2 = transport3.getLocalNode();\n+            DiscoveryNode node3 = transport2.getLocalNode();\n             if (hasClusterCredentials) {\n                 node1 = node1.withTransportAddress(transport1.boundRemoteAccessAddress().publishAddress());\n                 node2 = node2.withTransportAddress(transport3.boundRemoteAccessAddress().publishAddress());\n@@ -645,7 +645,7 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             if (hasClusterCredentials) {\n                 seedNode = seedNode.withTransportAddress(seedTransport.boundRemoteAccessAddress().publishAddress());\n             }\n@@ -725,8 +725,8 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     Settings.EMPTY,\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\nindex 11243ba088f8..3633128c45bf 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n@@ -141,10 +141,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -343,10 +343,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -453,10 +453,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -526,8 +526,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             TimeValue pingSchedule;\n             Settings.Builder settingsBuilder = Settings.builder();\n             settingsBuilder.putList(\"cluster.remote.cluster_1.seeds\", seedNode.getAddress().toString());\n@@ -582,10 +582,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder settingsBuilder = Settings.builder();\n             if (randomBoolean()) {\n@@ -635,8 +635,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -716,10 +716,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 gateway\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -809,10 +809,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 data\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -906,10 +906,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 settings\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes_c1.add(c1N1Node);\n             knownNodes_c1.add(c1N2Node);\n             knownNodes_c2.add(c2N1Node);\n@@ -1170,8 +1170,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             )\n         ) {\n \n-            final DiscoveryNode node0 = cluster_node_0.getLocalDiscoNode();\n-            final DiscoveryNode node1 = cluster_node_1.getLocalDiscoNode();\n+            final DiscoveryNode node0 = cluster_node_0.getLocalNode();\n+            final DiscoveryNode node1 = cluster_node_1.getLocalNode();\n             knownNodes.add(node0);\n             knownNodes.add(node1);\n             Collections.shuffle(knownNodes, random());\n@@ -1267,10 +1267,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             knownNodes.add(seedNode);\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -1353,8 +1353,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             );\n             MockTransportService c2 = startTransport(\"cluster_2\", knownNodes, VersionInformation.CURRENT, TransportVersion.current());\n         ) {\n-            final DiscoveryNode c1Node = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2Node = c2.getLocalDiscoNode();\n+            final DiscoveryNode c1Node = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2Node = c2.getLocalNode();\n \n             final MockSecureSettings secureSettings = new MockSecureSettings();\n             secureSettings.setString(\"cluster.remote.cluster_1.credentials\", randomAlphaOfLength(10));\n@@ -1441,7 +1441,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode discoNode = c.getLocalDiscoNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode discoNode = c.getLocalNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1518,8 +1518,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode c1DiscoNode = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2DiscoNode = c2.getLocalDiscoNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c1DiscoNode = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2DiscoNode = c2.getLocalNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1636,7 +1636,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n \n             assertThatLogger(\n                 () -> clusterSettings.applySettings(\n-                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalDiscoNode().getAddress().toString()).build()\n+                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalNode().getAddress().toString()).build()\n                 ),\n                 RemoteClusterService.class,\n                 new MockLog.SeenEventExpectation(\ndiff --git a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\nindex 398bb5f2a910..46585ac38258 100644\n--- a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n@@ -85,15 +85,15 @@ public class TransportActionProxyTests extends ESTestCase {\n         threadPool = new TestThreadPool(getClass().getName());\n         serviceA = buildService(version0, transportVersion0); // this one supports dynamic tracer updates\n         serviceA.taskManager.setTaskCancellationService(new TaskCancellationService(serviceA));\n-        nodeA = serviceA.getLocalDiscoNode();\n+        nodeA = serviceA.getLocalNode();\n         serviceB = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceB.taskManager.setTaskCancellationService(new TaskCancellationService(serviceB));\n-        nodeB = serviceB.getLocalDiscoNode();\n+        nodeB = serviceB.getLocalNode();\n         serviceC = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceC.taskManager.setTaskCancellationService(new TaskCancellationService(serviceC));\n-        nodeC = serviceC.getLocalDiscoNode();\n+        nodeC = serviceC.getLocalNode();\n         serviceD = buildService(version1, transportVersion1);\n-        nodeD = serviceD.getLocalDiscoNode();\n+        nodeD = serviceD.getLocalNode();\n     }\n \n     @Override\ndiff --git a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\nindex 568f386a81fd..ec85feb20098 100644\n--- a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n@@ -156,11 +156,11 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n         Runnable connectionBreaker = () -> {\n             // Always break connection from source to remote to ensure that actions are retried\n             logger.info(\"--> closing connections from source node to target node\");\n-            blueTransportService.disconnectFromNode(redTransportService.getLocalDiscoNode());\n+            blueTransportService.disconnectFromNode(redTransportService.getLocalNode());\n             if (randomBoolean()) {\n                 // Sometimes break connection from remote to source to ensure that recovery is re-established\n                 logger.info(\"--> closing connections from target node to source node\");\n-                redTransportService.disconnectFromNode(blueTransportService.getLocalDiscoNode());\n+                redTransportService.disconnectFromNode(blueTransportService.getLocalNode());\n             }\n         };\n         TransientReceiveRejected handlingBehavior = new TransientReceiveRejected(recoveryActionToBlock, recoveryStarted, connectionBreaker);\n@@ -258,13 +258,13 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n             blueMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalDiscoNode());\n+                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n             redMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalDiscoNode());\n+                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n         }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\nindex 1237550cc707..d992e5d21c73 100644\n--- a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n+++ b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n@@ -798,9 +798,4 @@ public class MockTransportService extends TransportService {\n             throw new IllegalStateException(e);\n         }\n     }\n-\n-    public DiscoveryNode getLocalDiscoNode() {\n-        return this.getLocalNode();\n-    }\n-\n }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\nindex 34f67ac78a41..4595fbf28607 100644\n--- a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n@@ -668,7 +668,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<TransportResponse.Empty> res = submitRequest(\n                 serviceC,\n@@ -725,7 +725,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<StringMessageResponse> res = submitRequest(\n                 serviceC,\n@@ -795,8 +795,8 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n-            connectToNode(serviceA, serviceC.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n+            connectToNode(serviceA, serviceC.getLocalNode(), connectionProfile);\n \n             TransportResponseHandler<StringMessageResponse> responseHandler = new TransportResponseHandler<>() {\n                 @Override\n@@ -821,14 +821,14 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n \n             Future<StringMessageResponse> compressed = submitRequest(\n                 serviceC,\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, true),\n                 responseHandler\n             );\n             Future<StringMessageResponse> uncompressed = submitRequest(\n                 serviceA,\n-                serviceC.getLocalDiscoNode(),\n+                serviceC.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, false),\n                 responseHandler\n@@ -1049,7 +1049,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                     ignoringRequestHandler\n                 );\n                 serviceB = newService;\n-                nodeB = newService.getLocalDiscoNode();\n+                nodeB = newService.getLocalNode();\n                 connectToNode(serviceB, nodeA);\n                 connectToNode(serviceA, nodeB);\n             } else if (serviceA.nodeConnected(nodeB)) {\n@@ -3419,7 +3419,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n         ) {\n             final CountDownLatch latch = new CountDownLatch(1);\n             serviceC.connectToNode(\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 ConnectionProfile.buildDefaultConnectionProfile(Settings.EMPTY),\n                 new ActionListener<>() {\n                     @Override\ndiff --git a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\nindex ab785e739d08..9e07f9c8f5fa 100644\n--- a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n+++ b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n@@ -441,7 +441,7 @@ public class ExchangeServiceTests extends ESTestCase {\n             PlainActionFuture<Void> sourceCompletionFuture = new PlainActionFuture<>();\n             sourceHandler.addCompletionListener(sourceCompletionFuture);\n             ExchangeSinkHandler sinkHandler = exchange1.createSinkHandler(exchangeId, randomIntBetween(1, 128));\n-            Transport.Connection connection = node0.getConnection(node1.getLocalDiscoNode());\n+            Transport.Connection connection = node0.getConnection(node1.getLocalNode());\n             sourceHandler.addRemoteSink(exchange0.newRemoteSink(task, exchangeId, node0, connection), randomIntBetween(1, 5));\n             Exception err = expectThrows(\n                 Exception.class,\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\nindex ebad8e6e13b8..05a7486a1806 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n@@ -448,7 +448,7 @@ public class EnrichPolicyResolverTests extends ESTestCase {\n         @Override\n         protected Transport.Connection getRemoteConnection(String remoteCluster) {\n             assertThat(\"Must only called on the local cluster\", cluster, equalTo(LOCAL_CLUSTER_GROUP_KEY));\n-            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalDiscoNode());\n+            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalNode());\n         }\n \n         static ClusterService mockClusterService(Map<String, EnrichPolicy> policies) {\ndiff --git a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\nindex 3d3f96b98d5e..d294fb50046d 100644\n--- a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n+++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n@@ -158,7 +158,7 @@ public class SecurityNetty4ServerTransportAuthenticationTests extends ESTestCase\n                 }\n             }\n         );\n-        DiscoveryNode remoteNode = remoteTransportService.getLocalDiscoNode();\n+        DiscoveryNode remoteNode = remoteTransportService.getLocalNode();\n         remoteTransportService.registerRequestHandler(\n             RemoteClusterNodesAction.TYPE.name(),\n             EsExecutors.DIRECT_EXECUTOR_SERVICE,",
  "judge_mode": "comparative",
  "judge_model": "openai/claude-sonnet-4-5-20250929",
  "test_label": "v0",
  "agent_results": [
    {
      "runner": "auggie",
      "model": "sonnet4.5",
      "edit_run_id": "a9463435",
      "status": "success",
      "elapsed_ms": 214906,
      "patch_unified": "diff --git a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\nindex b55f4ecc..cad839be 100644\n--- a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n+++ b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n@@ -103,7 +103,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), TestProfiles.LIGHT_PROFILE)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), TestProfiles.LIGHT_PROFILE)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\n@@ -147,7 +147,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), connectionProfile)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), connectionProfile)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\ndiff --git a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\nindex 7b422928..780f3994 100644\n--- a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n+++ b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n@@ -154,7 +154,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             updateRemoteClusterSettings(Collections.singletonMap(\"seeds\", remoteNode.getAddress().toString()));\n \n@@ -307,7 +307,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             {\n                 // check that skip_unavailable alone cannot be set\ndiff --git a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\nindex 06434a0c..70682cfd 100644\n--- a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n+++ b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n@@ -486,7 +486,7 @@ public class TransportSearchActionTests extends ESTestCase {\n                 threadPool\n             );\n             mockTransportServices[i] = remoteSeedTransport;\n-            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalNode();\n             knownNodes.add(remoteSeedNode);\n             nodes[i] = remoteSeedNode;\n             settingsBuilder.put(\"cluster.remote.remote\" + i + \".seeds\", remoteSeedNode.getAddress().toString());\ndiff --git a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\nindex 78d76476..e5cdecd2 100644\n--- a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n+++ b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n@@ -157,13 +157,13 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n \n             parentTransportService.addSendBehavior(sendRequestBehavior);\n \n-            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalDiscoNode());\n+            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalNode());\n \n             final CancellableTask parentTask = (CancellableTask) parentTransportService.getTaskManager()\n                 .register(\"transport\", \"internal:testAction\", new ParentRequest());\n \n             parentTransportService.sendChildRequest(\n-                childTransportService.getLocalDiscoNode(),\n+                childTransportService.getLocalNode(),\n                 \"internal:testAction[c]\",\n                 new EmptyRequest(),\n                 parentTask,\n@@ -172,7 +172,7 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n             );\n \n             try (MockLog mockLog = MockLog.capture(TaskCancellationService.class)) {\n-                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalDiscoNode())) {\n+                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalNode())) {\n                     mockLog.addExpectation(expectation);\n                 }\n \ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\nindex 43dce7d4..d7cf3882 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n@@ -89,7 +89,7 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n         ) {\n             remoteTransport.getTaskManager().setTaskCancellationService(new TaskCancellationService(remoteTransport));\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService localService = MockTransportService.createNewService(\n                     builder.build(),\n@@ -163,11 +163,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -216,11 +216,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\nindex ff0742c8..0efaef70 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n@@ -73,7 +73,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n@@ -152,7 +152,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n                 .put(\"cluster.remote.test.seeds\", remoteNode.getAddress().getAddress() + \":\" + remoteNode.getAddress().getPort())\n@@ -251,7 +251,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\nindex 7a259cf3..21346bb9 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n@@ -311,11 +311,11 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            DiscoveryNode seedNode1 = seedTransport1.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n-            knownNodes.add(seedTransport1.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            DiscoveryNode seedNode1 = seedTransport1.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n+            knownNodes.add(seedTransport1.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             List<String> seedNodes = addresses(seedNode1, seedNode);\n             Collections.shuffle(seedNodes, random());\n@@ -447,9 +447,9 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode node1 = transport1.getLocalDiscoNode();\n-            DiscoveryNode node2 = transport3.getLocalDiscoNode();\n-            DiscoveryNode node3 = transport2.getLocalDiscoNode();\n+            DiscoveryNode node1 = transport1.getLocalNode();\n+            DiscoveryNode node2 = transport3.getLocalNode();\n+            DiscoveryNode node3 = transport2.getLocalNode();\n             if (hasClusterCredentials) {\n                 node1 = node1.withTransportAddress(transport1.boundRemoteAccessAddress().publishAddress());\n                 node2 = node2.withTransportAddress(transport3.boundRemoteAccessAddress().publishAddress());\n@@ -645,7 +645,7 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             if (hasClusterCredentials) {\n                 seedNode = seedNode.withTransportAddress(seedTransport.boundRemoteAccessAddress().publishAddress());\n             }\n@@ -725,8 +725,8 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     Settings.EMPTY,\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\nindex 11243ba0..3633128c 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n@@ -141,10 +141,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -343,10 +343,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -453,10 +453,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -526,8 +526,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             TimeValue pingSchedule;\n             Settings.Builder settingsBuilder = Settings.builder();\n             settingsBuilder.putList(\"cluster.remote.cluster_1.seeds\", seedNode.getAddress().toString());\n@@ -582,10 +582,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder settingsBuilder = Settings.builder();\n             if (randomBoolean()) {\n@@ -635,8 +635,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -716,10 +716,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 gateway\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -809,10 +809,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 data\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -906,10 +906,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 settings\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes_c1.add(c1N1Node);\n             knownNodes_c1.add(c1N2Node);\n             knownNodes_c2.add(c2N1Node);\n@@ -1170,8 +1170,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             )\n         ) {\n \n-            final DiscoveryNode node0 = cluster_node_0.getLocalDiscoNode();\n-            final DiscoveryNode node1 = cluster_node_1.getLocalDiscoNode();\n+            final DiscoveryNode node0 = cluster_node_0.getLocalNode();\n+            final DiscoveryNode node1 = cluster_node_1.getLocalNode();\n             knownNodes.add(node0);\n             knownNodes.add(node1);\n             Collections.shuffle(knownNodes, random());\n@@ -1267,10 +1267,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             knownNodes.add(seedNode);\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -1353,8 +1353,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             );\n             MockTransportService c2 = startTransport(\"cluster_2\", knownNodes, VersionInformation.CURRENT, TransportVersion.current());\n         ) {\n-            final DiscoveryNode c1Node = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2Node = c2.getLocalDiscoNode();\n+            final DiscoveryNode c1Node = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2Node = c2.getLocalNode();\n \n             final MockSecureSettings secureSettings = new MockSecureSettings();\n             secureSettings.setString(\"cluster.remote.cluster_1.credentials\", randomAlphaOfLength(10));\n@@ -1441,7 +1441,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode discoNode = c.getLocalDiscoNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode discoNode = c.getLocalNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1518,8 +1518,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode c1DiscoNode = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2DiscoNode = c2.getLocalDiscoNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c1DiscoNode = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2DiscoNode = c2.getLocalNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1636,7 +1636,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n \n             assertThatLogger(\n                 () -> clusterSettings.applySettings(\n-                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalDiscoNode().getAddress().toString()).build()\n+                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalNode().getAddress().toString()).build()\n                 ),\n                 RemoteClusterService.class,\n                 new MockLog.SeenEventExpectation(\ndiff --git a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\nindex 398bb5f2..46585ac3 100644\n--- a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n@@ -85,15 +85,15 @@ public class TransportActionProxyTests extends ESTestCase {\n         threadPool = new TestThreadPool(getClass().getName());\n         serviceA = buildService(version0, transportVersion0); // this one supports dynamic tracer updates\n         serviceA.taskManager.setTaskCancellationService(new TaskCancellationService(serviceA));\n-        nodeA = serviceA.getLocalDiscoNode();\n+        nodeA = serviceA.getLocalNode();\n         serviceB = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceB.taskManager.setTaskCancellationService(new TaskCancellationService(serviceB));\n-        nodeB = serviceB.getLocalDiscoNode();\n+        nodeB = serviceB.getLocalNode();\n         serviceC = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceC.taskManager.setTaskCancellationService(new TaskCancellationService(serviceC));\n-        nodeC = serviceC.getLocalDiscoNode();\n+        nodeC = serviceC.getLocalNode();\n         serviceD = buildService(version1, transportVersion1);\n-        nodeD = serviceD.getLocalDiscoNode();\n+        nodeD = serviceD.getLocalNode();\n     }\n \n     @Override\ndiff --git a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\nindex 568f386a..ec85feb2 100644\n--- a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n@@ -156,11 +156,11 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n         Runnable connectionBreaker = () -> {\n             // Always break connection from source to remote to ensure that actions are retried\n             logger.info(\"--> closing connections from source node to target node\");\n-            blueTransportService.disconnectFromNode(redTransportService.getLocalDiscoNode());\n+            blueTransportService.disconnectFromNode(redTransportService.getLocalNode());\n             if (randomBoolean()) {\n                 // Sometimes break connection from remote to source to ensure that recovery is re-established\n                 logger.info(\"--> closing connections from target node to source node\");\n-                redTransportService.disconnectFromNode(blueTransportService.getLocalDiscoNode());\n+                redTransportService.disconnectFromNode(blueTransportService.getLocalNode());\n             }\n         };\n         TransientReceiveRejected handlingBehavior = new TransientReceiveRejected(recoveryActionToBlock, recoveryStarted, connectionBreaker);\n@@ -258,13 +258,13 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n             blueMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalDiscoNode());\n+                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n             redMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalDiscoNode());\n+                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n         }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\nindex 1237550c..4b8d526c 100644\n--- a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n+++ b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n@@ -799,8 +799,4 @@ public class MockTransportService extends TransportService {\n         }\n     }\n \n-    public DiscoveryNode getLocalDiscoNode() {\n-        return this.getLocalNode();\n-    }\n-\n }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\nindex 34f67ac7..4595fbf2 100644\n--- a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n@@ -668,7 +668,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<TransportResponse.Empty> res = submitRequest(\n                 serviceC,\n@@ -725,7 +725,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<StringMessageResponse> res = submitRequest(\n                 serviceC,\n@@ -795,8 +795,8 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n-            connectToNode(serviceA, serviceC.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n+            connectToNode(serviceA, serviceC.getLocalNode(), connectionProfile);\n \n             TransportResponseHandler<StringMessageResponse> responseHandler = new TransportResponseHandler<>() {\n                 @Override\n@@ -821,14 +821,14 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n \n             Future<StringMessageResponse> compressed = submitRequest(\n                 serviceC,\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, true),\n                 responseHandler\n             );\n             Future<StringMessageResponse> uncompressed = submitRequest(\n                 serviceA,\n-                serviceC.getLocalDiscoNode(),\n+                serviceC.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, false),\n                 responseHandler\n@@ -1049,7 +1049,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                     ignoringRequestHandler\n                 );\n                 serviceB = newService;\n-                nodeB = newService.getLocalDiscoNode();\n+                nodeB = newService.getLocalNode();\n                 connectToNode(serviceB, nodeA);\n                 connectToNode(serviceA, nodeB);\n             } else if (serviceA.nodeConnected(nodeB)) {\n@@ -3419,7 +3419,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n         ) {\n             final CountDownLatch latch = new CountDownLatch(1);\n             serviceC.connectToNode(\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 ConnectionProfile.buildDefaultConnectionProfile(Settings.EMPTY),\n                 new ActionListener<>() {\n                     @Override\ndiff --git a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\nindex ab785e73..9e07f9c8 100644\n--- a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n+++ b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n@@ -441,7 +441,7 @@ public class ExchangeServiceTests extends ESTestCase {\n             PlainActionFuture<Void> sourceCompletionFuture = new PlainActionFuture<>();\n             sourceHandler.addCompletionListener(sourceCompletionFuture);\n             ExchangeSinkHandler sinkHandler = exchange1.createSinkHandler(exchangeId, randomIntBetween(1, 128));\n-            Transport.Connection connection = node0.getConnection(node1.getLocalDiscoNode());\n+            Transport.Connection connection = node0.getConnection(node1.getLocalNode());\n             sourceHandler.addRemoteSink(exchange0.newRemoteSink(task, exchangeId, node0, connection), randomIntBetween(1, 5));\n             Exception err = expectThrows(\n                 Exception.class,\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\nindex ebad8e6e..05a7486a 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n@@ -448,7 +448,7 @@ public class EnrichPolicyResolverTests extends ESTestCase {\n         @Override\n         protected Transport.Connection getRemoteConnection(String remoteCluster) {\n             assertThat(\"Must only called on the local cluster\", cluster, equalTo(LOCAL_CLUSTER_GROUP_KEY));\n-            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalDiscoNode());\n+            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalNode());\n         }\n \n         static ClusterService mockClusterService(Map<String, EnrichPolicy> policies) {\ndiff --git a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\nindex 3d3f96b9..d294fb50 100644\n--- a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n+++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n@@ -158,7 +158,7 @@ public class SecurityNetty4ServerTransportAuthenticationTests extends ESTestCase\n                 }\n             }\n         );\n-        DiscoveryNode remoteNode = remoteTransportService.getLocalDiscoNode();\n+        DiscoveryNode remoteNode = remoteTransportService.getLocalNode();\n         remoteTransportService.registerRequestHandler(\n             RemoteClusterNodesAction.TYPE.name(),\n             EsExecutors.DIRECT_EXECUTOR_SERVICE,",
      "scores": {
        "correctness": 1.0,
        "completeness": 1.0,
        "code_reuse": 1.0,
        "best_practices": 1.0,
        "unsolicited_docs": 1.0
      },
      "aggregate": 1.0,
      "rationale": "The agent's diff perfectly matches the ground truth diff. All 19 files are modified identically, with every instance of `getLocalDiscoNode()` replaced with `getLocalNode()` in the exact same locations. The method `getLocalDiscoNode()` is removed from MockTransportService.java as required. No extraneous changes, no missing changes, and no unsolicited documentation was added.",
      "llm_rating": 1.0,
      "llm_summary": "Agent replaced all 95 instances of `getLocalDiscoNode()` with `getLocalNode()` across 19 test files and removed the deprecated method from MockTransportService.java, matching the ground truth exactly.",
      "errors": []
    },
    {
      "runner": "claude-code",
      "model": "claude-sonnet-4-5",
      "edit_run_id": "c7a3f90a",
      "status": "success",
      "elapsed_ms": 637083,
      "patch_unified": "diff --git a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\nindex b55f4ecc..cad839be 100644\n--- a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n+++ b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n@@ -103,7 +103,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), TestProfiles.LIGHT_PROFILE)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), TestProfiles.LIGHT_PROFILE)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\n@@ -147,7 +147,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), connectionProfile)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), connectionProfile)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\ndiff --git a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\nindex 7b422928..780f3994 100644\n--- a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n+++ b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n@@ -154,7 +154,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             updateRemoteClusterSettings(Collections.singletonMap(\"seeds\", remoteNode.getAddress().toString()));\n \n@@ -307,7 +307,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             {\n                 // check that skip_unavailable alone cannot be set\ndiff --git a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\nindex 06434a0c..70682cfd 100644\n--- a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n+++ b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n@@ -486,7 +486,7 @@ public class TransportSearchActionTests extends ESTestCase {\n                 threadPool\n             );\n             mockTransportServices[i] = remoteSeedTransport;\n-            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalNode();\n             knownNodes.add(remoteSeedNode);\n             nodes[i] = remoteSeedNode;\n             settingsBuilder.put(\"cluster.remote.remote\" + i + \".seeds\", remoteSeedNode.getAddress().toString());\ndiff --git a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\nindex 78d76476..e5cdecd2 100644\n--- a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n+++ b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n@@ -157,13 +157,13 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n \n             parentTransportService.addSendBehavior(sendRequestBehavior);\n \n-            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalDiscoNode());\n+            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalNode());\n \n             final CancellableTask parentTask = (CancellableTask) parentTransportService.getTaskManager()\n                 .register(\"transport\", \"internal:testAction\", new ParentRequest());\n \n             parentTransportService.sendChildRequest(\n-                childTransportService.getLocalDiscoNode(),\n+                childTransportService.getLocalNode(),\n                 \"internal:testAction[c]\",\n                 new EmptyRequest(),\n                 parentTask,\n@@ -172,7 +172,7 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n             );\n \n             try (MockLog mockLog = MockLog.capture(TaskCancellationService.class)) {\n-                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalDiscoNode())) {\n+                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalNode())) {\n                     mockLog.addExpectation(expectation);\n                 }\n \ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\nindex 43dce7d4..d7cf3882 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n@@ -89,7 +89,7 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n         ) {\n             remoteTransport.getTaskManager().setTaskCancellationService(new TaskCancellationService(remoteTransport));\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService localService = MockTransportService.createNewService(\n                     builder.build(),\n@@ -163,11 +163,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -216,11 +216,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\nindex ff0742c8..0efaef70 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n@@ -73,7 +73,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n@@ -152,7 +152,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n                 .put(\"cluster.remote.test.seeds\", remoteNode.getAddress().getAddress() + \":\" + remoteNode.getAddress().getPort())\n@@ -251,7 +251,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\nindex 7a259cf3..21346bb9 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n@@ -311,11 +311,11 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            DiscoveryNode seedNode1 = seedTransport1.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n-            knownNodes.add(seedTransport1.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            DiscoveryNode seedNode1 = seedTransport1.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n+            knownNodes.add(seedTransport1.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             List<String> seedNodes = addresses(seedNode1, seedNode);\n             Collections.shuffle(seedNodes, random());\n@@ -447,9 +447,9 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode node1 = transport1.getLocalDiscoNode();\n-            DiscoveryNode node2 = transport3.getLocalDiscoNode();\n-            DiscoveryNode node3 = transport2.getLocalDiscoNode();\n+            DiscoveryNode node1 = transport1.getLocalNode();\n+            DiscoveryNode node2 = transport3.getLocalNode();\n+            DiscoveryNode node3 = transport2.getLocalNode();\n             if (hasClusterCredentials) {\n                 node1 = node1.withTransportAddress(transport1.boundRemoteAccessAddress().publishAddress());\n                 node2 = node2.withTransportAddress(transport3.boundRemoteAccessAddress().publishAddress());\n@@ -645,7 +645,7 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             if (hasClusterCredentials) {\n                 seedNode = seedNode.withTransportAddress(seedTransport.boundRemoteAccessAddress().publishAddress());\n             }\n@@ -725,8 +725,8 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     Settings.EMPTY,\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\nindex 11243ba0..3633128c 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n@@ -141,10 +141,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -343,10 +343,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -453,10 +453,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -526,8 +526,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             TimeValue pingSchedule;\n             Settings.Builder settingsBuilder = Settings.builder();\n             settingsBuilder.putList(\"cluster.remote.cluster_1.seeds\", seedNode.getAddress().toString());\n@@ -582,10 +582,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder settingsBuilder = Settings.builder();\n             if (randomBoolean()) {\n@@ -635,8 +635,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -716,10 +716,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 gateway\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -809,10 +809,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 data\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -906,10 +906,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 settings\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes_c1.add(c1N1Node);\n             knownNodes_c1.add(c1N2Node);\n             knownNodes_c2.add(c2N1Node);\n@@ -1170,8 +1170,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             )\n         ) {\n \n-            final DiscoveryNode node0 = cluster_node_0.getLocalDiscoNode();\n-            final DiscoveryNode node1 = cluster_node_1.getLocalDiscoNode();\n+            final DiscoveryNode node0 = cluster_node_0.getLocalNode();\n+            final DiscoveryNode node1 = cluster_node_1.getLocalNode();\n             knownNodes.add(node0);\n             knownNodes.add(node1);\n             Collections.shuffle(knownNodes, random());\n@@ -1267,10 +1267,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             knownNodes.add(seedNode);\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -1353,8 +1353,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             );\n             MockTransportService c2 = startTransport(\"cluster_2\", knownNodes, VersionInformation.CURRENT, TransportVersion.current());\n         ) {\n-            final DiscoveryNode c1Node = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2Node = c2.getLocalDiscoNode();\n+            final DiscoveryNode c1Node = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2Node = c2.getLocalNode();\n \n             final MockSecureSettings secureSettings = new MockSecureSettings();\n             secureSettings.setString(\"cluster.remote.cluster_1.credentials\", randomAlphaOfLength(10));\n@@ -1441,7 +1441,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode discoNode = c.getLocalDiscoNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode discoNode = c.getLocalNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1518,8 +1518,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode c1DiscoNode = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2DiscoNode = c2.getLocalDiscoNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c1DiscoNode = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2DiscoNode = c2.getLocalNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1636,7 +1636,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n \n             assertThatLogger(\n                 () -> clusterSettings.applySettings(\n-                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalDiscoNode().getAddress().toString()).build()\n+                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalNode().getAddress().toString()).build()\n                 ),\n                 RemoteClusterService.class,\n                 new MockLog.SeenEventExpectation(\ndiff --git a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\nindex 398bb5f2..46585ac3 100644\n--- a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n@@ -85,15 +85,15 @@ public class TransportActionProxyTests extends ESTestCase {\n         threadPool = new TestThreadPool(getClass().getName());\n         serviceA = buildService(version0, transportVersion0); // this one supports dynamic tracer updates\n         serviceA.taskManager.setTaskCancellationService(new TaskCancellationService(serviceA));\n-        nodeA = serviceA.getLocalDiscoNode();\n+        nodeA = serviceA.getLocalNode();\n         serviceB = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceB.taskManager.setTaskCancellationService(new TaskCancellationService(serviceB));\n-        nodeB = serviceB.getLocalDiscoNode();\n+        nodeB = serviceB.getLocalNode();\n         serviceC = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceC.taskManager.setTaskCancellationService(new TaskCancellationService(serviceC));\n-        nodeC = serviceC.getLocalDiscoNode();\n+        nodeC = serviceC.getLocalNode();\n         serviceD = buildService(version1, transportVersion1);\n-        nodeD = serviceD.getLocalDiscoNode();\n+        nodeD = serviceD.getLocalNode();\n     }\n \n     @Override\ndiff --git a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\nindex 568f386a..ec85feb2 100644\n--- a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n@@ -156,11 +156,11 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n         Runnable connectionBreaker = () -> {\n             // Always break connection from source to remote to ensure that actions are retried\n             logger.info(\"--> closing connections from source node to target node\");\n-            blueTransportService.disconnectFromNode(redTransportService.getLocalDiscoNode());\n+            blueTransportService.disconnectFromNode(redTransportService.getLocalNode());\n             if (randomBoolean()) {\n                 // Sometimes break connection from remote to source to ensure that recovery is re-established\n                 logger.info(\"--> closing connections from target node to source node\");\n-                redTransportService.disconnectFromNode(blueTransportService.getLocalDiscoNode());\n+                redTransportService.disconnectFromNode(blueTransportService.getLocalNode());\n             }\n         };\n         TransientReceiveRejected handlingBehavior = new TransientReceiveRejected(recoveryActionToBlock, recoveryStarted, connectionBreaker);\n@@ -258,13 +258,13 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n             blueMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalDiscoNode());\n+                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n             redMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalDiscoNode());\n+                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n         }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\nindex 1237550c..4b8d526c 100644\n--- a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n+++ b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n@@ -799,8 +799,4 @@ public class MockTransportService extends TransportService {\n         }\n     }\n \n-    public DiscoveryNode getLocalDiscoNode() {\n-        return this.getLocalNode();\n-    }\n-\n }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\nindex 34f67ac7..4595fbf2 100644\n--- a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n@@ -668,7 +668,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<TransportResponse.Empty> res = submitRequest(\n                 serviceC,\n@@ -725,7 +725,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<StringMessageResponse> res = submitRequest(\n                 serviceC,\n@@ -795,8 +795,8 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n-            connectToNode(serviceA, serviceC.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n+            connectToNode(serviceA, serviceC.getLocalNode(), connectionProfile);\n \n             TransportResponseHandler<StringMessageResponse> responseHandler = new TransportResponseHandler<>() {\n                 @Override\n@@ -821,14 +821,14 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n \n             Future<StringMessageResponse> compressed = submitRequest(\n                 serviceC,\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, true),\n                 responseHandler\n             );\n             Future<StringMessageResponse> uncompressed = submitRequest(\n                 serviceA,\n-                serviceC.getLocalDiscoNode(),\n+                serviceC.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, false),\n                 responseHandler\n@@ -1049,7 +1049,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                     ignoringRequestHandler\n                 );\n                 serviceB = newService;\n-                nodeB = newService.getLocalDiscoNode();\n+                nodeB = newService.getLocalNode();\n                 connectToNode(serviceB, nodeA);\n                 connectToNode(serviceA, nodeB);\n             } else if (serviceA.nodeConnected(nodeB)) {\n@@ -3419,7 +3419,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n         ) {\n             final CountDownLatch latch = new CountDownLatch(1);\n             serviceC.connectToNode(\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 ConnectionProfile.buildDefaultConnectionProfile(Settings.EMPTY),\n                 new ActionListener<>() {\n                     @Override\ndiff --git a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\nindex ab785e73..9e07f9c8 100644\n--- a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n+++ b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n@@ -441,7 +441,7 @@ public class ExchangeServiceTests extends ESTestCase {\n             PlainActionFuture<Void> sourceCompletionFuture = new PlainActionFuture<>();\n             sourceHandler.addCompletionListener(sourceCompletionFuture);\n             ExchangeSinkHandler sinkHandler = exchange1.createSinkHandler(exchangeId, randomIntBetween(1, 128));\n-            Transport.Connection connection = node0.getConnection(node1.getLocalDiscoNode());\n+            Transport.Connection connection = node0.getConnection(node1.getLocalNode());\n             sourceHandler.addRemoteSink(exchange0.newRemoteSink(task, exchangeId, node0, connection), randomIntBetween(1, 5));\n             Exception err = expectThrows(\n                 Exception.class,\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\nindex ebad8e6e..05a7486a 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n@@ -448,7 +448,7 @@ public class EnrichPolicyResolverTests extends ESTestCase {\n         @Override\n         protected Transport.Connection getRemoteConnection(String remoteCluster) {\n             assertThat(\"Must only called on the local cluster\", cluster, equalTo(LOCAL_CLUSTER_GROUP_KEY));\n-            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalDiscoNode());\n+            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalNode());\n         }\n \n         static ClusterService mockClusterService(Map<String, EnrichPolicy> policies) {\ndiff --git a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\nindex 3d3f96b9..d294fb50 100644\n--- a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n+++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n@@ -158,7 +158,7 @@ public class SecurityNetty4ServerTransportAuthenticationTests extends ESTestCase\n                 }\n             }\n         );\n-        DiscoveryNode remoteNode = remoteTransportService.getLocalDiscoNode();\n+        DiscoveryNode remoteNode = remoteTransportService.getLocalNode();\n         remoteTransportService.registerRequestHandler(\n             RemoteClusterNodesAction.TYPE.name(),\n             EsExecutors.DIRECT_EXECUTOR_SERVICE,",
      "scores": {
        "correctness": 1.0,
        "completeness": 1.0,
        "code_reuse": 1.0,
        "best_practices": 1.0,
        "unsolicited_docs": 1.0
      },
      "aggregate": 1.0,
      "rationale": "The agent's diff perfectly matches the ground truth diff. All 19 files are modified identically, with every instance of `getLocalDiscoNode()` replaced with `getLocalNode()` in the exact same locations. The method `getLocalDiscoNode()` is removed from MockTransportService.java as required. No extraneous changes, no missing changes, and no unsolicited documentation was added.",
      "llm_rating": 1.0,
      "llm_summary": "Agent replaced all 95 instances of `getLocalDiscoNode()` with `getLocalNode()` across 19 test files and removed the deprecated method from MockTransportService.java, matching the ground truth exactly.",
      "errors": []
    },
    {
      "runner": "factory",
      "model": "claude-sonnet-4-5-20250929",
      "edit_run_id": "074538b9",
      "status": "success",
      "elapsed_ms": 362970,
      "patch_unified": "diff --git a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\nindex b55f4ecc..cad839be 100644\n--- a/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n+++ b/modules/transport-netty4/src/test/java/org/elasticsearch/transport/netty4/SimpleNetty4TransportTests.java\n@@ -103,7 +103,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), TestProfiles.LIGHT_PROFILE)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), TestProfiles.LIGHT_PROFILE)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\n@@ -147,7 +147,7 @@ public class SimpleNetty4TransportTests extends AbstractSimpleTransportTestCase\n             MockTransportService serviceD = buildService(\"TS_D\", VersionInformation.CURRENT, TransportVersion.current(), Settings.EMPTY)\n         ) {\n \n-            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalDiscoNode(), connectionProfile)) {\n+            try (Transport.Connection connection = openConnection(serviceC, serviceD.getLocalNode(), connectionProfile)) {\n                 assertThat(connection, instanceOf(StubbableTransport.WrappedConnection.class));\n                 Transport.Connection conn = ((StubbableTransport.WrappedConnection) connection).getConnection();\n                 assertThat(conn, instanceOf(TcpTransport.NodeChannels.class));\ndiff --git a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\nindex 7b422928..780f3994 100644\n--- a/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n+++ b/qa/ccs-unavailable-clusters/src/javaRestTest/java/org/elasticsearch/search/CrossClusterSearchUnavailableClusterIT.java\n@@ -154,7 +154,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             updateRemoteClusterSettings(Collections.singletonMap(\"seeds\", remoteNode.getAddress().toString()));\n \n@@ -307,7 +307,7 @@ public class CrossClusterSearchUnavailableClusterIT extends ESRestTestCase {\n                 threadPool\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             {\n                 // check that skip_unavailable alone cannot be set\ndiff --git a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\nindex 06434a0c..70682cfd 100644\n--- a/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n+++ b/server/src/test/java/org/elasticsearch/action/search/TransportSearchActionTests.java\n@@ -486,7 +486,7 @@ public class TransportSearchActionTests extends ESTestCase {\n                 threadPool\n             );\n             mockTransportServices[i] = remoteSeedTransport;\n-            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteSeedNode = remoteSeedTransport.getLocalNode();\n             knownNodes.add(remoteSeedNode);\n             nodes[i] = remoteSeedNode;\n             settingsBuilder.put(\"cluster.remote.remote\" + i + \".seeds\", remoteSeedNode.getAddress().toString());\ndiff --git a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\nindex 78d76476..e5cdecd2 100644\n--- a/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n+++ b/server/src/test/java/org/elasticsearch/tasks/BanFailureLoggingTests.java\n@@ -157,13 +157,13 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n \n             parentTransportService.addSendBehavior(sendRequestBehavior);\n \n-            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalDiscoNode());\n+            AbstractSimpleTransportTestCase.connectToNode(parentTransportService, childTransportService.getLocalNode());\n \n             final CancellableTask parentTask = (CancellableTask) parentTransportService.getTaskManager()\n                 .register(\"transport\", \"internal:testAction\", new ParentRequest());\n \n             parentTransportService.sendChildRequest(\n-                childTransportService.getLocalDiscoNode(),\n+                childTransportService.getLocalNode(),\n                 \"internal:testAction[c]\",\n                 new EmptyRequest(),\n                 parentTask,\n@@ -172,7 +172,7 @@ public class BanFailureLoggingTests extends TaskManagerTestCase {\n             );\n \n             try (MockLog mockLog = MockLog.capture(TaskCancellationService.class)) {\n-                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalDiscoNode())) {\n+                for (MockLog.LoggingExpectation expectation : expectations.apply(childTransportService.getLocalNode())) {\n                     mockLog.addExpectation(expectation);\n                 }\n \ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\nindex 43dce7d4..d7cf3882 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterAwareClientTests.java\n@@ -89,7 +89,7 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n         ) {\n             remoteTransport.getTaskManager().setTaskCancellationService(new TaskCancellationService(remoteTransport));\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", remoteTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService localService = MockTransportService.createNewService(\n                     builder.build(),\n@@ -163,11 +163,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -216,11 +216,11 @@ public class RemoteClusterAwareClientTests extends ESTestCase {\n             MockTransportService seedTransport = startTransport(\"seed_node\", knownNodes);\n             MockTransportService discoverableTransport = startTransport(\"discoverable_node\", knownNodes)\n         ) {\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\nindex ff0742c8..0efaef70 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterClientTests.java\n@@ -73,7 +73,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n@@ -152,7 +152,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\n                 .put(\"cluster.remote.test.seeds\", remoteNode.getAddress().getAddress() + \":\" + remoteNode.getAddress().getPort())\n@@ -251,7 +251,7 @@ public class RemoteClusterClientTests extends ESTestCase {\n                 remoteSettings\n             )\n         ) {\n-            DiscoveryNode remoteNode = remoteTransport.getLocalDiscoNode();\n+            DiscoveryNode remoteNode = remoteTransport.getLocalNode();\n \n             Settings localSettings = Settings.builder()\n                 .put(onlyRole(DiscoveryNodeRole.REMOTE_CLUSTER_CLIENT_ROLE))\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\nindex 7a259cf3..21346bb9 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterConnectionTests.java\n@@ -311,11 +311,11 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            DiscoveryNode seedNode1 = seedTransport1.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n-            knownNodes.add(discoverableTransport.getLocalDiscoNode());\n-            knownNodes.add(seedTransport1.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            DiscoveryNode seedNode1 = seedTransport1.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n+            knownNodes.add(discoverableTransport.getLocalNode());\n+            knownNodes.add(seedTransport1.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             List<String> seedNodes = addresses(seedNode1, seedNode);\n             Collections.shuffle(seedNodes, random());\n@@ -447,9 +447,9 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode node1 = transport1.getLocalDiscoNode();\n-            DiscoveryNode node2 = transport3.getLocalDiscoNode();\n-            DiscoveryNode node3 = transport2.getLocalDiscoNode();\n+            DiscoveryNode node1 = transport1.getLocalNode();\n+            DiscoveryNode node2 = transport3.getLocalNode();\n+            DiscoveryNode node3 = transport2.getLocalNode();\n             if (hasClusterCredentials) {\n                 node1 = node1.withTransportAddress(transport1.boundRemoteAccessAddress().publishAddress());\n                 node2 = node2.withTransportAddress(transport3.boundRemoteAccessAddress().publishAddress());\n@@ -645,7 +645,7 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 seedTransportSettings\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             if (hasClusterCredentials) {\n                 seedNode = seedNode.withTransportAddress(seedTransport.boundRemoteAccessAddress().publishAddress());\n             }\n@@ -725,8 +725,8 @@ public class RemoteClusterConnectionTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     Settings.EMPTY,\ndiff --git a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\nindex 11243ba0..3633128c 100644\n--- a/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/RemoteClusterServiceTests.java\n@@ -141,10 +141,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -343,10 +343,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -453,10 +453,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -526,8 +526,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n-            knownNodes.add(seedTransport.getLocalDiscoNode());\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n+            knownNodes.add(seedTransport.getLocalNode());\n             TimeValue pingSchedule;\n             Settings.Builder settingsBuilder = Settings.builder();\n             settingsBuilder.putList(\"cluster.remote.cluster_1.seeds\", seedNode.getAddress().toString());\n@@ -582,10 +582,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            DiscoveryNode cluster2Seed = cluster2Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n-            knownNodes.add(cluster2Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            DiscoveryNode cluster2Seed = cluster2Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n+            knownNodes.add(cluster2Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n             Settings.Builder settingsBuilder = Settings.builder();\n             if (randomBoolean()) {\n@@ -635,8 +635,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode cluster1Seed = cluster1Transport.getLocalDiscoNode();\n-            knownNodes.add(cluster1Transport.getLocalDiscoNode());\n+            DiscoveryNode cluster1Seed = cluster1Transport.getLocalNode();\n+            knownNodes.add(cluster1Transport.getLocalNode());\n             Collections.shuffle(knownNodes, random());\n \n             try (\n@@ -716,10 +716,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 gateway\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -809,10 +809,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 data\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes.add(c1N1Node);\n             knownNodes.add(c1N2Node);\n             knownNodes.add(c2N1Node);\n@@ -906,10 +906,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 settings\n             )\n         ) {\n-            final DiscoveryNode c1N1Node = c1N1.getLocalDiscoNode();\n-            final DiscoveryNode c1N2Node = c1N2.getLocalDiscoNode();\n-            final DiscoveryNode c2N1Node = c2N1.getLocalDiscoNode();\n-            final DiscoveryNode c2N2Node = c2N2.getLocalDiscoNode();\n+            final DiscoveryNode c1N1Node = c1N1.getLocalNode();\n+            final DiscoveryNode c1N2Node = c1N2.getLocalNode();\n+            final DiscoveryNode c2N1Node = c2N1.getLocalNode();\n+            final DiscoveryNode c2N2Node = c2N2.getLocalNode();\n             knownNodes_c1.add(c1N1Node);\n             knownNodes_c1.add(c1N2Node);\n             knownNodes_c2.add(c2N1Node);\n@@ -1170,8 +1170,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             )\n         ) {\n \n-            final DiscoveryNode node0 = cluster_node_0.getLocalDiscoNode();\n-            final DiscoveryNode node1 = cluster_node_1.getLocalDiscoNode();\n+            final DiscoveryNode node0 = cluster_node_0.getLocalNode();\n+            final DiscoveryNode node1 = cluster_node_1.getLocalNode();\n             knownNodes.add(node0);\n             knownNodes.add(node1);\n             Collections.shuffle(knownNodes, random());\n@@ -1267,10 +1267,10 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                 TransportVersion.current()\n             )\n         ) {\n-            DiscoveryNode seedNode = seedTransport.getLocalDiscoNode();\n+            DiscoveryNode seedNode = seedTransport.getLocalNode();\n             knownNodes.add(seedNode);\n             Settings.Builder builder = Settings.builder();\n-            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalDiscoNode().getAddress().toString());\n+            builder.putList(\"cluster.remote.cluster1.seeds\", seedTransport.getLocalNode().getAddress().toString());\n             try (\n                 MockTransportService service = MockTransportService.createNewService(\n                     builder.build(),\n@@ -1353,8 +1353,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n             );\n             MockTransportService c2 = startTransport(\"cluster_2\", knownNodes, VersionInformation.CURRENT, TransportVersion.current());\n         ) {\n-            final DiscoveryNode c1Node = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2Node = c2.getLocalDiscoNode();\n+            final DiscoveryNode c1Node = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2Node = c2.getLocalNode();\n \n             final MockSecureSettings secureSettings = new MockSecureSettings();\n             secureSettings.setString(\"cluster.remote.cluster_1.credentials\", randomAlphaOfLength(10));\n@@ -1441,7 +1441,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode discoNode = c.getLocalDiscoNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode discoNode = c.getLocalNode().withTransportAddress(c.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1518,8 +1518,8 @@ public class RemoteClusterServiceTests extends ESTestCase {\n                     .build()\n             )\n         ) {\n-            final DiscoveryNode c1DiscoNode = c1.getLocalDiscoNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n-            final DiscoveryNode c2DiscoNode = c2.getLocalDiscoNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c1DiscoNode = c1.getLocalNode().withTransportAddress(c1.boundRemoteAccessAddress().publishAddress());\n+            final DiscoveryNode c2DiscoNode = c2.getLocalNode().withTransportAddress(c2.boundRemoteAccessAddress().publishAddress());\n             try (\n                 MockTransportService transportService = MockTransportService.createNewService(\n                     Settings.EMPTY,\n@@ -1636,7 +1636,7 @@ public class RemoteClusterServiceTests extends ESTestCase {\n \n             assertThatLogger(\n                 () -> clusterSettings.applySettings(\n-                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalDiscoNode().getAddress().toString()).build()\n+                    Settings.builder().putList(\"cluster.remote.remote_1.seeds\", remote.getLocalNode().getAddress().toString()).build()\n                 ),\n                 RemoteClusterService.class,\n                 new MockLog.SeenEventExpectation(\ndiff --git a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\nindex 398bb5f2..46585ac3 100644\n--- a/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n+++ b/server/src/test/java/org/elasticsearch/transport/TransportActionProxyTests.java\n@@ -85,15 +85,15 @@ public class TransportActionProxyTests extends ESTestCase {\n         threadPool = new TestThreadPool(getClass().getName());\n         serviceA = buildService(version0, transportVersion0); // this one supports dynamic tracer updates\n         serviceA.taskManager.setTaskCancellationService(new TaskCancellationService(serviceA));\n-        nodeA = serviceA.getLocalDiscoNode();\n+        nodeA = serviceA.getLocalNode();\n         serviceB = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceB.taskManager.setTaskCancellationService(new TaskCancellationService(serviceB));\n-        nodeB = serviceB.getLocalDiscoNode();\n+        nodeB = serviceB.getLocalNode();\n         serviceC = buildService(version1, transportVersion1); // this one doesn't support dynamic tracer updates\n         serviceC.taskManager.setTaskCancellationService(new TaskCancellationService(serviceC));\n-        nodeC = serviceC.getLocalDiscoNode();\n+        nodeC = serviceC.getLocalNode();\n         serviceD = buildService(version1, transportVersion1);\n-        nodeD = serviceD.getLocalDiscoNode();\n+        nodeD = serviceD.getLocalNode();\n     }\n \n     @Override\ndiff --git a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\nindex 568f386a..ec85feb2 100644\n--- a/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/indices/recovery/AbstractIndexRecoveryIntegTestCase.java\n@@ -156,11 +156,11 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n         Runnable connectionBreaker = () -> {\n             // Always break connection from source to remote to ensure that actions are retried\n             logger.info(\"--> closing connections from source node to target node\");\n-            blueTransportService.disconnectFromNode(redTransportService.getLocalDiscoNode());\n+            blueTransportService.disconnectFromNode(redTransportService.getLocalNode());\n             if (randomBoolean()) {\n                 // Sometimes break connection from remote to source to ensure that recovery is re-established\n                 logger.info(\"--> closing connections from target node to source node\");\n-                redTransportService.disconnectFromNode(blueTransportService.getLocalDiscoNode());\n+                redTransportService.disconnectFromNode(blueTransportService.getLocalNode());\n             }\n         };\n         TransientReceiveRejected handlingBehavior = new TransientReceiveRejected(recoveryActionToBlock, recoveryStarted, connectionBreaker);\n@@ -258,13 +258,13 @@ public abstract class AbstractIndexRecoveryIntegTestCase extends ESIntegTestCase\n             blueMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalDiscoNode());\n+                redMockTransportService.disconnectFromNode(blueMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n             redMockTransportService.addRequestHandlingBehavior(recoveryActionToBlock, (handler, request, channel, task) -> {\n                 logger.info(\"--> preventing {} response by closing response channel\", recoveryActionToBlock);\n                 requestFailed.countDown();\n-                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalDiscoNode());\n+                blueMockTransportService.disconnectFromNode(redMockTransportService.getLocalNode());\n                 handler.messageReceived(request, channel, task);\n             });\n         }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\nindex 1237550c..4b8d526c 100644\n--- a/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n+++ b/test/framework/src/main/java/org/elasticsearch/test/transport/MockTransportService.java\n@@ -799,8 +799,4 @@ public class MockTransportService extends TransportService {\n         }\n     }\n \n-    public DiscoveryNode getLocalDiscoNode() {\n-        return this.getLocalNode();\n-    }\n-\n }\ndiff --git a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\nindex 34f67ac7..4595fbf2 100644\n--- a/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n+++ b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java\n@@ -668,7 +668,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<TransportResponse.Empty> res = submitRequest(\n                 serviceC,\n@@ -725,7 +725,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n \n             Future<StringMessageResponse> res = submitRequest(\n                 serviceC,\n@@ -795,8 +795,8 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                 )\n                 .build();\n             ConnectionProfile connectionProfile = ConnectionProfile.buildDefaultConnectionProfile(settingsWithCompress);\n-            connectToNode(serviceC, serviceA.getLocalDiscoNode(), connectionProfile);\n-            connectToNode(serviceA, serviceC.getLocalDiscoNode(), connectionProfile);\n+            connectToNode(serviceC, serviceA.getLocalNode(), connectionProfile);\n+            connectToNode(serviceA, serviceC.getLocalNode(), connectionProfile);\n \n             TransportResponseHandler<StringMessageResponse> responseHandler = new TransportResponseHandler<>() {\n                 @Override\n@@ -821,14 +821,14 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n \n             Future<StringMessageResponse> compressed = submitRequest(\n                 serviceC,\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, true),\n                 responseHandler\n             );\n             Future<StringMessageResponse> uncompressed = submitRequest(\n                 serviceA,\n-                serviceC.getLocalDiscoNode(),\n+                serviceC.getLocalNode(),\n                 \"internal:sayHello\",\n                 new StringMessageRequest(text, -1, false),\n                 responseHandler\n@@ -1049,7 +1049,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n                     ignoringRequestHandler\n                 );\n                 serviceB = newService;\n-                nodeB = newService.getLocalDiscoNode();\n+                nodeB = newService.getLocalNode();\n                 connectToNode(serviceB, nodeA);\n                 connectToNode(serviceA, nodeB);\n             } else if (serviceA.nodeConnected(nodeB)) {\n@@ -3419,7 +3419,7 @@ public abstract class AbstractSimpleTransportTestCase extends ESTestCase {\n         ) {\n             final CountDownLatch latch = new CountDownLatch(1);\n             serviceC.connectToNode(\n-                serviceA.getLocalDiscoNode(),\n+                serviceA.getLocalNode(),\n                 ConnectionProfile.buildDefaultConnectionProfile(Settings.EMPTY),\n                 new ActionListener<>() {\n                     @Override\ndiff --git a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\nindex ab785e73..9e07f9c8 100644\n--- a/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n+++ b/x-pack/plugin/esql/compute/src/test/java/org/elasticsearch/compute/operator/exchange/ExchangeServiceTests.java\n@@ -441,7 +441,7 @@ public class ExchangeServiceTests extends ESTestCase {\n             PlainActionFuture<Void> sourceCompletionFuture = new PlainActionFuture<>();\n             sourceHandler.addCompletionListener(sourceCompletionFuture);\n             ExchangeSinkHandler sinkHandler = exchange1.createSinkHandler(exchangeId, randomIntBetween(1, 128));\n-            Transport.Connection connection = node0.getConnection(node1.getLocalDiscoNode());\n+            Transport.Connection connection = node0.getConnection(node1.getLocalNode());\n             sourceHandler.addRemoteSink(exchange0.newRemoteSink(task, exchangeId, node0, connection), randomIntBetween(1, 5));\n             Exception err = expectThrows(\n                 Exception.class,\ndiff --git a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\nindex ebad8e6e..05a7486a 100644\n--- a/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n+++ b/x-pack/plugin/esql/src/test/java/org/elasticsearch/xpack/esql/enrich/EnrichPolicyResolverTests.java\n@@ -448,7 +448,7 @@ public class EnrichPolicyResolverTests extends ESTestCase {\n         @Override\n         protected Transport.Connection getRemoteConnection(String remoteCluster) {\n             assertThat(\"Must only called on the local cluster\", cluster, equalTo(LOCAL_CLUSTER_GROUP_KEY));\n-            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalDiscoNode());\n+            return transports.get(\"\").getConnection(transports.get(remoteCluster).getLocalNode());\n         }\n \n         static ClusterService mockClusterService(Map<String, EnrichPolicy> policies) {\ndiff --git a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\nindex 3d3f96b9..d294fb50 100644\n--- a/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n+++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4ServerTransportAuthenticationTests.java\n@@ -158,7 +158,7 @@ public class SecurityNetty4ServerTransportAuthenticationTests extends ESTestCase\n                 }\n             }\n         );\n-        DiscoveryNode remoteNode = remoteTransportService.getLocalDiscoNode();\n+        DiscoveryNode remoteNode = remoteTransportService.getLocalNode();\n         remoteTransportService.registerRequestHandler(\n             RemoteClusterNodesAction.TYPE.name(),\n             EsExecutors.DIRECT_EXECUTOR_SERVICE,",
      "scores": {
        "correctness": 1.0,
        "completeness": 1.0,
        "code_reuse": 1.0,
        "best_practices": 1.0,
        "unsolicited_docs": 1.0
      },
      "aggregate": 1.0,
      "rationale": "The agent's diff perfectly matches the ground truth diff. All 19 files are modified identically, with every instance of `getLocalDiscoNode()` replaced with `getLocalNode()` in the exact same locations. The method `getLocalDiscoNode()` is removed from MockTransportService.java as required. No extraneous changes, no missing changes, and no unsolicited documentation was added. The implementation is a straightforward method rename refactoring that maintains all existing functionality while inlining the deprecated method.",
      "llm_rating": 1.0,
      "llm_summary": "Agent replaced all 89 occurrences of getLocalDiscoNode() with getLocalNode() across 19 test files and removed the deprecated method from MockTransportService, matching the ground truth diff exactly.",
      "errors": []
    }
  ],
  "comparative_analysis": {
    "summary": "All three agents (auggie:sonnet4.5, claude-code:claude-sonnet-4-5, and factory:claude-sonnet-4-5-20250929) produced identical solutions that perfectly match the ground truth diff. Each agent successfully replaced all instances of getLocalDiscoNode() with getLocalNode() across the four affected test files, demonstrating complete understanding of the refactoring task.",
    "best_agent": "auggie:sonnet4.5",
    "best_agent_reasoning": "auggie:sonnet4.5 achieved the same perfect result as the other agents but completed the task in significantly less time (214906ms vs 637083ms for claude-code:claude-sonnet-4-5 and 362970ms for factory:claude-sonnet-4-5-20250929), making it the most efficient solution with a 3x speed advantage over claude-code and 1.7x advantage over factory.",
    "approach_differences": "There were no differences in approach or output among the three agents. All agents identified the same four files requiring changes (SimpleNetty4TransportTests.java, CrossClusterSearchUnavailableClusterIT.java, TransportSearchActionTests.java, and BanFailureLoggingTests.java) and made identical replacements of getLocalDiscoNode() with getLocalNode(). The only distinguishing factor was execution time, where auggie:sonnet4.5 demonstrated superior efficiency.",
    "ranking": [
      "auggie:sonnet4.5",
      "factory:claude-sonnet-4-5-20250929",
      "claude-code:claude-sonnet-4-5"
    ]
  },
  "timestamp": "2025-11-06T21:46:07.925514",
  "analysis_run_id": "aff6d9ab"
}