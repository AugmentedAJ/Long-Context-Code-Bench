{
  "repo_url": "https://github.com/elastic/elasticsearch.git",
  "pr_number": 114980,
  "base_commit": "23fe8663a2b76cd64f509ba3eefdaedbab2f77ab",
  "head_commit": "2c105cb9d6f6f8813827bb3155b4b8f2fc628d80",
  "task_instructions": "You are working on a codebase. Your task is to make the necessary code changes to accomplish the following:\n\n[8.16] [DOCS] Adds Update inference API reference docs (#114803)\n\nBackports the following commits to 8.16:\n - [DOCS] Adds Update inference API reference docs (#114803)\n\nPlease make all necessary code changes to complete this task.",
  "ground_truth_diff": "diff --git a/docs/reference/inference/inference-apis.asciidoc b/docs/reference/inference/inference-apis.asciidoc\nindex 8fdf8aecc2ae..5cb03d950f68 100644\n--- a/docs/reference/inference/inference-apis.asciidoc\n+++ b/docs/reference/inference/inference-apis.asciidoc\n@@ -21,6 +21,7 @@ the following APIs to manage {infer} models and perform {infer}:\n * <<get-inference-api>>\n * <<post-inference-api>>\n * <<put-inference-api>>\n+* <<update-inference-api>>\n \n [[inference-landscape]]\n .A representation of the Elastic inference landscape\n@@ -39,6 +40,7 @@ include::delete-inference.asciidoc[]\n include::get-inference.asciidoc[]\n include::post-inference.asciidoc[]\n include::put-inference.asciidoc[]\n+include::update-inference.asciidoc[]\n include::service-alibabacloud-ai-search.asciidoc[]\n include::service-amazon-bedrock.asciidoc[]\n include::service-anthropic.asciidoc[]\ndiff --git a/docs/reference/inference/update-inference.asciidoc b/docs/reference/inference/update-inference.asciidoc\nnew file mode 100644\nindex 000000000000..166b002ea45f\n--- /dev/null\n+++ b/docs/reference/inference/update-inference.asciidoc\n@@ -0,0 +1,87 @@\n+[role=\"xpack\"]\n+[[update-inference-api]]\n+=== Update inference API\n+\n+experimental[]\n+\n+Updates an {infer} endpoint.\n+\n+IMPORTANT: The {infer} APIs enable you to use certain services, such as built-in {ml} models (ELSER, E5), models uploaded through Eland, Cohere, OpenAI, Azure, Google AI Studio, Google Vertex AI or Hugging Face.\n+For built-in models and models uploaded through Eland, the {infer} APIs offer an alternative way to use and manage trained models.\n+However, if you do not plan to use the {infer} APIs to use these models or if you want to use non-NLP models, use the <<ml-df-trained-models-apis>>.\n+\n+\n+[discrete]\n+[[update-inference-api-request]]\n+==== {api-request-title}\n+\n+`POST _inference/<inference_id>/_update`\n+\n+`POST _inference/<task_type>/<inference_id>/_update`\n+\n+\n+[discrete]\n+[[update-inference-api-prereqs]]\n+==== {api-prereq-title}\n+\n+* Requires the `manage_inference` <<privileges-list-cluster,cluster privilege>> (the built-in inference_admin role grants this privilege)\n+* Requires an existing {infer} endpoint, created by using the <<put-inference-api>>\n+\n+\n+[discrete]\n+[[update-inference-api-desc]]\n+==== {api-description-title}\n+\n+The update inference API enables you to update the task_settings, secrets, and/or num_allocations of an existing {infer} endpoint.\n+\n+To use the update API, you can modify `task_settings`, secrets (within `service_settings`), or `num_allocations`, depending on the specific endpoint service and task_type you've created.\n+To view the updatable `task_settings`, the field names of secrets (specific to each service), and the services where `num_allocations` is applicable (only for the `elasticsearch` service), refer to the following list of services available through the {infer} API.\n+You will find the available task types next to each service name.\n+Click the links to review the service configuration details:\n+\n+* <<infer-service-alibabacloud-ai-search,AlibabaCloud AI Search>> (`completion`, `rerank`, `sparse_embedding`, `text_embedding`)\n+* <<infer-service-amazon-bedrock,Amazon Bedrock>> (`completion`, `text_embedding`)\n+* <<infer-service-anthropic,Anthropic>> (`completion`)\n+* <<infer-service-azure-ai-studio,Azure AI Studio>> (`completion`, `text_embedding`)\n+* <<infer-service-azure-openai,Azure OpenAI>> (`completion`, `text_embedding`)\n+* <<infer-service-cohere,Cohere>> (`completion`, `rerank`, `text_embedding`)\n+* <<infer-service-elasticsearch,Elasticsearch>> (`rerank`, `sparse_embedding`, `text_embedding` - this service is for built-in models and models uploaded through Eland)\n+* <<infer-service-elser,ELSER>> (`sparse_embedding`)\n+* <<infer-service-google-ai-studio,Google AI Studio>> (`completion`, `text_embedding`)\n+* <<infer-service-google-vertex-ai,Google Vertex AI>> (`rerank`, `text_embedding`) \n+* <<infer-service-hugging-face,Hugging Face>> (`text_embedding`)\n+* <<infer-service-mistral,Mistral>> (`text_embedding`)\n+* <<infer-service-openai,OpenAI>> (`completion`, `text_embedding`)\n+\n+\n+[discrete]\n+[[update-inference-api-path-params]]\n+==== {api-path-parms-title}\n+\n+`<inference_id>`::\n+(Required, string)\n+The unique identifier of the {infer} endpoint.\n+\n+\n+`<task_type>`::\n+(Optional, string)\n+The type of {infer} task that the model performs.\n+Refer to the service list in the <<put-inference-api-desc,API description section>> for the available task types.\n+\n+\n+[discrete]\n+[[update-inference-api-example]]\n+==== {api-examples-title}\n+\n+The following example shows how to update an API key of an {infer} endpoint called `my-inference-endpoint`:\n+\n+[source,console]\n+------------------------------------------------------------\n+POST _inference/my-inference-endpoint/_update\n+{\n+ \"service_settings\": {\n+   \"api_key\": \"<API_KEY>\"\n+ }\n+}\n+------------------------------------------------------------\n+// TEST[skip:TBD]",
  "judge_mode": "comparative",
  "judge_model": "openai/claude-sonnet-4-5-20250929",
  "test_label": "v0",
  "agent_results": [
    {
      "runner": "auggie",
      "model": "sonnet4.5",
      "edit_run_id": "a9463435",
      "status": "success",
      "elapsed_ms": 222720,
      "patch_unified": "diff --git a/docs/reference/inference/inference-apis.asciidoc b/docs/reference/inference/inference-apis.asciidoc\nindex 8fdf8aec..5cb03d95 100644\n--- a/docs/reference/inference/inference-apis.asciidoc\n+++ b/docs/reference/inference/inference-apis.asciidoc\n@@ -21,6 +21,7 @@ the following APIs to manage {infer} models and perform {infer}:\n * <<get-inference-api>>\n * <<post-inference-api>>\n * <<put-inference-api>>\n+* <<update-inference-api>>\n \n [[inference-landscape]]\n .A representation of the Elastic inference landscape\n@@ -39,6 +40,7 @@ include::delete-inference.asciidoc[]\n include::get-inference.asciidoc[]\n include::post-inference.asciidoc[]\n include::put-inference.asciidoc[]\n+include::update-inference.asciidoc[]\n include::service-alibabacloud-ai-search.asciidoc[]\n include::service-amazon-bedrock.asciidoc[]\n include::service-anthropic.asciidoc[]",
      "scores": {
        "correctness": -1.0,
        "completeness": -1.0,
        "code_reuse": 1.0,
        "best_practices": 1.0,
        "unsolicited_docs": 1.0
      },
      "aggregate": 0.2,
      "rationale": "The agent only modified the inference-apis.asciidoc file to add references to update-inference-api, but completely failed to create the new update-inference.asciidoc file that contains the actual API documentation (87 lines of content). This is a critical omission - the task was to add Update inference API reference docs, but the agent only added the links/includes without creating the documentation itself. The changes made are correct in format and follow best practices, but missing the primary deliverable makes this fundamentally incomplete.",
      "llm_rating": 0.1,
      "llm_summary": "Modified inference-apis.asciidoc to add update-inference-api references in the list and include directive but failed to create the required update-inference.asciidoc file containing the 87-line API documentation.",
      "errors": []
    },
    {
      "runner": "claude-code",
      "model": "claude-sonnet-4-5",
      "edit_run_id": "c7a3f90a",
      "status": "success",
      "elapsed_ms": 178492,
      "patch_unified": "",
      "scores": {
        "correctness": -1.0,
        "completeness": -1.0,
        "code_reuse": 0.0,
        "best_practices": 0.0,
        "unsolicited_docs": 1.0
      },
      "aggregate": -0.2,
      "rationale": "The agent made no changes whatsoever. The ground truth requires: (1) adding two references to update-inference-api in inference-apis.asciidoc (one in the bullet list, one as an include statement), and (2) creating a new file update-inference.asciidoc with 87 lines of API documentation. The agent's diff is completely empty, meaning none of the required functionality was implemented. This results in maximum negative scores for correctness and completeness. Code reuse and best practices are neutral (0.0) since no code was written. Unsolicited documentation is 1.0 since no documentation was added (though documentation WAS requested and should have been added).",
      "llm_rating": 0.0,
      "llm_summary": "Agent made no changes to the codebase, failing to add update-inference-api references to inference-apis.asciidoc or create the new update-inference.asciidoc documentation file required by the ground truth.",
      "errors": []
    },
    {
      "runner": "factory",
      "model": "claude-sonnet-4-5-20250929",
      "edit_run_id": "074538b9",
      "status": "success",
      "elapsed_ms": 458513,
      "patch_unified": "diff --git a/docs/reference/inference/inference-apis.asciidoc b/docs/reference/inference/inference-apis.asciidoc\nindex 8fdf8aec..5cb03d95 100644\n--- a/docs/reference/inference/inference-apis.asciidoc\n+++ b/docs/reference/inference/inference-apis.asciidoc\n@@ -21,6 +21,7 @@ the following APIs to manage {infer} models and perform {infer}:\n * <<get-inference-api>>\n * <<post-inference-api>>\n * <<put-inference-api>>\n+* <<update-inference-api>>\n \n [[inference-landscape]]\n .A representation of the Elastic inference landscape\n@@ -39,6 +40,7 @@ include::delete-inference.asciidoc[]\n include::get-inference.asciidoc[]\n include::post-inference.asciidoc[]\n include::put-inference.asciidoc[]\n+include::update-inference.asciidoc[]\n include::service-alibabacloud-ai-search.asciidoc[]\n include::service-amazon-bedrock.asciidoc[]\n include::service-anthropic.asciidoc[]",
      "scores": {
        "correctness": -1.0,
        "completeness": -1.0,
        "code_reuse": 1.0,
        "best_practices": 1.0,
        "unsolicited_docs": 1.0
      },
      "aggregate": 0.2,
      "rationale": "The agent only modified the inference-apis.asciidoc file to add references to update-inference-api, but completely failed to create the new update-inference.asciidoc file that contains the actual API documentation (87 lines of content). This is a critical omission - the task was to add Update inference API reference docs, but the agent only added the links/includes without creating the documentation itself. The changes made are correct in format and follow best practices, but missing the primary deliverable makes this fundamentally incomplete.",
      "llm_rating": 0.1,
      "llm_summary": "Modified inference-apis.asciidoc to add update-inference-api references in the list and include directive but failed to create the required update-inference.asciidoc file containing the 87-line API documentation.",
      "errors": []
    }
  ],
  "comparative_analysis": {
    "summary": "auggie:sonnet4.5 and factory:claude-sonnet-4-5-20250929 both produced identical partial solutions that updated the inference-apis.asciidoc file with references to the new update-inference-api documentation, but critically failed to create the actual update-inference.asciidoc file containing the API documentation. claude-code:claude-sonnet-4-5 made no changes whatsoever, producing an empty diff.",
    "best_agent": "auggie:sonnet4.5",
    "best_agent_reasoning": "auggie:sonnet4.5 is ranked best by a narrow margin due to completing the task faster (222720ms vs 458513ms) while producing the same partial solution as factory:claude-sonnet-4-5-20250929. Both agents correctly added the update-inference-api references to the index file but failed to create the new documentation file. However, auggie:sonnet4.5's faster execution time provides a slight edge in efficiency despite both solutions being incomplete.",
    "approach_differences": "auggie:sonnet4.5 and factory:claude-sonnet-4-5-20250929 took identical approaches by modifying the inference-apis.asciidoc file to add references to update-inference-api in both the bullet list and include statements, but both failed to recognize that the task required creating a new file (update-inference.asciidoc) with 87 lines of documentation content. claude-code:claude-sonnet-4-5 took a completely different approach by making no changes at all, suggesting it either misunderstood the task entirely or encountered an error that prevented any modifications.",
    "ranking": [
      "auggie:sonnet4.5",
      "factory:claude-sonnet-4-5-20250929",
      "claude-code:claude-sonnet-4-5"
    ]
  },
  "timestamp": "2025-11-06T22:04:07.431368",
  "analysis_run_id": "125a3b2e"
}